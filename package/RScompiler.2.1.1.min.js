/*This is a combined, compressed file.  Look at https://github.com/BruceSherwood/glowscript for source code and copyright information.*/!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.opentype=e()}}(function(){return function e(t,r,a){function n(i,o){if(!r[i]){if(!t[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(s)return s(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var f=r[i]={exports:{}};t[i][0].call(f.exports,function(e){var r=t[i][1][e];return n(r?r:e)},f,f.exports,e,t,r,a)}return r[i].exports}for(var s="function"==typeof require&&require,i=0;i<a.length;i++)n(a[i]);return n}({1:[function(e,t,r){function a(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function n(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new a,this.dtree=new a}function s(e,t,r,a){var n,s;for(n=0;r>n;++n)e[n]=0;for(n=0;30-r>n;++n)e[n+r]=n/r|0;for(s=a,n=0;30>n;++n)t[n]=s,s+=1<<e[n]}function i(e,t){var r;for(r=0;7>r;++r)e.table[r]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,r=0;24>r;++r)e.trans[r]=256+r;for(r=0;144>r;++r)e.trans[24+r]=r;for(r=0;8>r;++r)e.trans[168+r]=280+r;for(r=0;112>r;++r)e.trans[176+r]=144+r;for(r=0;5>r;++r)t.table[r]=0;for(t.table[5]=32,r=0;32>r;++r)t.trans[r]=r}function o(e,t,r,a){var n,s;for(n=0;16>n;++n)e.table[n]=0;for(n=0;a>n;++n)e.table[t[r+n]]++;for(e.table[0]=0,s=0,n=0;16>n;++n)w[n]=s,s+=e.table[n];for(n=0;a>n;++n)t[r+n]&&(e.trans[w[t[r+n]]++]=n)}function l(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function u(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var a=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,a+r}function f(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=0,a=0,n=0,s=e.tag;do a=2*a+(1&s),s>>>=1,++n,r+=t.table[n],a-=t.table[n];while(a>=0);return e.tag=s,e.bitcount-=n,t.trans[r+a]}function h(e,t,r){var a,n,s,i,l,h;for(a=u(e,5,257),n=u(e,5,1),s=u(e,4,4),i=0;19>i;++i)R[i]=0;for(i=0;s>i;++i){var p=u(e,3,0);R[U[i]]=p}for(o(O,R,0,19),l=0;a+n>l;){var c=f(e,O);switch(c){case 16:var d=R[l-1];for(h=u(e,2,3);h;--h)R[l++]=d;break;case 17:for(h=u(e,3,3);h;--h)R[l++]=0;break;case 18:for(h=u(e,7,11);h;--h)R[l++]=0;break;default:R[l++]=c}}o(t,R,0,a),o(r,R,a,n)}function p(e,t,r){for(;;){var a=f(e,t);if(256===a)return m;if(256>a)e.dest[e.destLen++]=a;else{var n,s,i,o;for(a-=257,n=u(e,b[a],S[a]),s=f(e,r),i=e.destLen-u(e,x[s],T[s]),o=i;i+n>o;++o)e.dest[e.destLen++]=e.dest[o]}}}function c(e){for(var t,r,a;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if(t=e.source[e.sourceIndex+1],t=256*t+e.source[e.sourceIndex],r=e.source[e.sourceIndex+3],r=256*r+e.source[e.sourceIndex+2],t!==(65535&~r))return g;for(e.sourceIndex+=4,a=t;a;--a)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,m}function d(e,t){var r,a,s,i=new n(e,t);do{switch(r=l(i),a=u(i,2,0)){case 0:s=c(i);break;case 1:s=p(i,v,y);break;case 2:h(i,i.ltree,i.dtree),s=p(i,i.ltree,i.dtree);break;default:s=g}if(s!==m)throw new Error("Data error")}while(!r);return i.destLen<i.dest.length?"function"==typeof i.dest.slice?i.dest.slice(0,i.destLen):i.dest.subarray(0,i.destLen):i.dest}var m=0,g=-3,v=new a,y=new a,b=new Uint8Array(30),S=new Uint16Array(30),x=new Uint8Array(30),T=new Uint16Array(30),U=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),O=new a,R=new Uint8Array(320),w=new Uint16Array(16);i(v,y),s(b,S,4,3),s(x,T,2,1),b[28]=0,S[28]=258,t.exports=d},{}],2:[function(e,t,r){"use strict";r.argument=function(e,t){if(!e)throw new Error(t)},r.assert=r.argument},{}],3:[function(e,t,r){"use strict";function a(e,t,r,a,n){e.beginPath(),e.moveTo(t,r),e.lineTo(a,n),e.stroke()}r.line=a},{}],4:[function(e,t,r){"use strict";function a(e){this.font=e}function n(e){this.cmap=e}function s(e,t){this.encoding=e,this.charset=t}function i(e){var t;switch(e.version){case 1:this.names=r.standardNames.slice();break;case 2:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<r.standardNames.length?this.names[t]=r.standardNames[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-r.standardNames.length];break;case 2.5:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)this.names[t]=r.standardNames[t+e.glyphNameIndex[t]];break;case 3:this.names=[]}}function o(e){for(var t,r=e.tables.cmap.glyphIndexMap,a=Object.keys(r),n=0;n<a.length;n+=1){var s=a[n],i=r[s];t=e.glyphs.get(i),t.addUnicode(parseInt(s))}for(n=0;n<e.glyphs.length;n+=1)t=e.glyphs.get(n),e.cffEncoding?t.name=e.cffEncoding.charset[n]:t.name=e.glyphNames.glyphIndexToName(n)}var l=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],u=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],f=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],h=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];a.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),r=this.font.glyphs;if(!r)return null;for(var a=0;a<r.length;a+=1)for(var n=r.get(a),s=0;s<n.unicodes.length;s+=1)if(n.unicodes[s]===t)return a},n.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},s.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),r=this.encoding[t];return this.charset.indexOf(r)},i.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},i.prototype.glyphIndexToName=function(e){return this.names[e]},r.cffStandardStrings=l,r.cffStandardEncoding=u,r.cffExpertEncoding=f,r.standardNames=h,r.DefaultEncoding=a,r.CmapEncoding=n,r.CffEncoding=s,r.GlyphNames=i,r.addGlyphNames=o},{}],5:[function(e,t,r){"use strict";function a(e){e=e||{},e.empty||(l.checkArgument(e.familyName,"When creating a new Font object, familyName is required."),l.checkArgument(e.styleName,"When creating a new Font object, styleName is required."),l.checkArgument(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),l.checkArgument(e.ascender,"When creating a new Font object, ascender is required."),l.checkArgument(e.descender,"When creating a new Font object, descender is required."),l.checkArgument(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||e.familyName+e.styleName},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender),this.supported=!0,this.glyphs=new o.GlyphSet(this,e.glyphs||[]),this.encoding=new i.DefaultEncoding(this),this.tables={}}var n=e("./path"),s=e("./tables/sfnt"),i=e("./encoding"),o=e("./glyphset"),l=e("./util");a.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},a.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},a.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r},a.prototype.stringToGlyphs=function(e){for(var t=[],r=0;r<e.length;r+=1){var a=e[r];t.push(this.charToGlyph(a))}return t},a.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},a.prototype.nameToGlyph=function(e){var t=this.nametoGlyphIndex(e),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r},a.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},a.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var r=this.getGposKerningValue;return r?r(e,t):this.kerningPairs[e+","+t]||0},a.prototype.forEachGlyph=function(e,t,r,a,n,s){t=void 0!==t?t:0,r=void 0!==r?r:0,a=void 0!==a?a:72,n=n||{};for(var i=void 0===n.kerning?!0:n.kerning,o=1/this.unitsPerEm*a,l=this.stringToGlyphs(e),u=0;u<l.length;u+=1){var f=l[u];if(s(f,t,r,a,n),f.advanceWidth&&(t+=f.advanceWidth*o),i&&u<l.length-1){var h=this.getKerningValue(f,l[u+1]);t+=h*o}}},a.prototype.getPath=function(e,t,r,a,s){var i=new n.Path;return this.forEachGlyph(e,t,r,a,s,function(e,t,r,a){var n=e.getPath(t,r,a);i.extend(n)}),i},a.prototype.getPaths=function(e,t,r,a,n){var s=[];return this.forEachGlyph(e,t,r,a,n,function(e,t,r,a){var n=e.getPath(t,r,a);s.push(n)}),s},a.prototype.draw=function(e,t,r,a,n,s){this.getPath(t,r,a,n,s).draw(e)},a.prototype.drawPoints=function(e,t,r,a,n,s){this.forEachGlyph(t,r,a,n,s,function(t,r,a,n){t.drawPoints(e,r,a,n)})},a.prototype.drawMetrics=function(e,t,r,a,n,s){this.forEachGlyph(t,r,a,n,s,function(t,r,a,n){t.drawMetrics(e,r,a,n)})},a.prototype.getEnglishName=function(e){var t=this.names[e];return t?t.en:void 0},a.prototype.validate=function(){function e(e,t){e||r.push(t)}function t(t){var r=a.getEnglishName(t);e(r&&r.trim().length>0,"No English "+t+" specified.")}var r=[],a=this;t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),e(this.unitsPerEm>0,"No unitsPerEm specified.")},a.prototype.toTables=function(){return s.fontToTable(this)},a.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},a.prototype.toArrayBuffer=function(){for(var e=this.toTables(),t=e.encode(),r=new ArrayBuffer(t.length),a=new Uint8Array(r),n=0;n<t.length;n++)a[n]=t[n];return r},a.prototype.download=function(){var t=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily"),a=t.replace(/\s/g,"")+"-"+r+".otf",n=this.toArrayBuffer();if(l.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,n.byteLength,function(e){e.root.getFile(a,{create:!0},function(e){e.createWriter(function(t){var r=new DataView(n),a=new Blob([r],{type:"font/opentype"});t.write(a),t.addEventListener("writeend",function(){location.href=e.toURL()},!1)})})},function(e){throw e});else{var s=e("fs"),i=l.arrayBufferToNodeBuffer(n);s.writeFileSync(a,i)}},r.Font=a},{"./encoding":4,"./glyphset":7,"./path":10,"./tables/sfnt":27,"./util":29,fs:void 0}],6:[function(e,t,r){"use strict";function a(e,t){var r=t||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof r&&(r=r()),r},set:function(e){r=e}}}function n(e){this.bindConstructorValues(e)}var s=e("./check"),i=e("./draw"),o=e("./path");n.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",a(this,e.path))},n.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},n.prototype.getPath=function(e,t,r,a){e=void 0!==e?e:0,t=void 0!==t?t:0,a=void 0!==a?a:{xScale:1,yScale:1},r=void 0!==r?r:72;for(var n=1/this.path.unitsPerEm*r,s=a.xScale*n,i=a.yScale*n,l=new o.Path,u=this.path.commands,f=0;f<u.length;f+=1){var h=u[f];"M"===h.type?l.moveTo(e+h.x*s,t+-h.y*i):"L"===h.type?l.lineTo(e+h.x*s,t+-h.y*i):"Q"===h.type?l.quadraticCurveTo(e+h.x1*s,t+-h.y1*i,e+h.x*s,t+-h.y*i):"C"===h.type?l.curveTo(e+h.x1*s,t+-h.y1*i,e+h.x2*s,t+-h.y2*i,e+h.x*s,t+-h.y*i):"Z"===h.type&&l.closePath()}return l},n.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],r=0;r<this.points.length;r+=1){var a=this.points[r];t.push(a),a.lastPointOfContour&&(e.push(t),t=[])}return s.argument(0===t.length,"There are still points left in the current contour."),e},n.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],r=[],a=0;a<e.length;a+=1){var n=e[a];"Z"!==n.type&&(t.push(n.x),r.push(n.y)),"Q"!==n.type&&"C"!==n.type||(t.push(n.x1),r.push(n.y1)),"C"===n.type&&(t.push(n.x2),r.push(n.y2))}var s={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(s.xMin)||(s.xMin=0),isFinite(s.xMax)||(s.xMax=this.advanceWidth),isFinite(s.yMin)||(s.yMin=0),isFinite(s.yMax)||(s.yMax=0),s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},n.prototype.draw=function(e,t,r,a,n){this.getPath(t,r,a,n).draw(e)},n.prototype.drawPoints=function(e,t,r,a){function n(t,r,a,n){var s=2*Math.PI;e.beginPath();for(var i=0;i<t.length;i+=1)e.moveTo(r+t[i].x*n,a+t[i].y*n),e.arc(r+t[i].x*n,a+t[i].y*n,2,0,s,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,r=void 0!==r?r:0,a=void 0!==a?a:24;for(var s=1/this.path.unitsPerEm*a,i=[],o=[],l=this.path,u=0;u<l.commands.length;u+=1){var f=l.commands[u];void 0!==f.x&&i.push({x:f.x,y:-f.y}),void 0!==f.x1&&o.push({x:f.x1,y:-f.y1}),void 0!==f.x2&&o.push({x:f.x2,y:-f.y2})}e.fillStyle="blue",n(i,t,r,s),e.fillStyle="red",n(o,t,r,s)},n.prototype.drawMetrics=function(e,t,r,a){var n;t=void 0!==t?t:0,r=void 0!==r?r:0,a=void 0!==a?a:24,n=1/this.path.unitsPerEm*a,e.lineWidth=1,e.strokeStyle="black",i.line(e,t,-1e4,t,1e4),i.line(e,-1e4,r,1e4,r);var s=this.xMin||0,o=this.yMin||0,l=this.xMax||0,u=this.yMax||0,f=this.advanceWidth||0;e.strokeStyle="blue",i.line(e,t+s*n,-1e4,t+s*n,1e4),i.line(e,t+l*n,-1e4,t+l*n,1e4),i.line(e,-1e4,r+-o*n,1e4,r+-o*n),i.line(e,-1e4,r+-u*n,1e4,r+-u*n),e.strokeStyle="green",i.line(e,t+f*n,-1e4,t+f*n,1e4)},r.Glyph=n},{"./check":2,"./draw":3,"./path":10}],7:[function(e,t,r){"use strict";function a(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var r=0;r<t.length;r++)this.glyphs[r]=t[r];this.length=t&&t.length||0}function n(e,t){return new o.Glyph({index:t,font:e})}function s(e,t,r,a,n,s){return function(){var i=new o.Glyph({index:t,font:e});return i.path=function(){r(i,a,n);var t=s(e.glyphs,i);return t.unitsPerEm=e.unitsPerEm,t},i}}function i(e,t,r,a){return function(){var n=new o.Glyph({index:t,font:e});return n.path=function(){var t=r(e,n,a);return t.unitsPerEm=e.unitsPerEm,t},n}}var o=e("./glyph");a.prototype.get=function(e){return"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},a.prototype.push=function(e,t){this.glyphs[e]=t,this.length++},r.GlyphSet=a,r.glyphLoader=n,r.ttfGlyphLoader=s,r.cffGlyphLoader=i},{"./glyph":6}],8:[function(e,t,r){"use strict";function a(t,r){var a=e("fs");a.readFile(t,function(e,t){return e?r(e.message):void r(null,v.nodeBufferToArrayBuffer(t))})}function n(e,t){var r=new XMLHttpRequest;r.open("get",e,!0),r.responseType="arraybuffer",r.onload=function(){return 200!==r.status?t("Font could not be loaded: "+r.statusText):t(null,r.response)},r.send()}function s(e,t){for(var r=[],a=12,n=0;t>n;n+=1){var s=m.getTag(e,a),i=m.getULong(e,a+4),o=m.getULong(e,a+8),l=m.getULong(e,a+12);r.push({tag:s,checksum:i,offset:o,length:l,compression:!1}),a+=16}return r}function i(e,t){for(var r=[],a=44,n=0;t>n;n+=1){var s,i=m.getTag(e,a),o=m.getULong(e,a+4),l=m.getULong(e,a+8),u=m.getULong(e,a+12);s=u>l?"WOFF":!1,r.push({tag:i,offset:o,compression:s,compressedLength:l,originalLength:u}),a+=20}return r}function o(e,t){if("WOFF"===t.compression){var r=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),a=new Uint8Array(t.originalLength);if(h(r,a),a.byteLength!==t.originalLength)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");var n=new DataView(a.buffer,0);return{data:n,offset:0}}return{data:e,offset:t.offset}}function l(e){var t,r,a,n=new c.Font({empty:!0}),l=new DataView(e,0),u=[],f=m.getTag(l,0);if(f===String.fromCharCode(0,1,0,0))n.outlinesFormat="truetype",a=m.getUShort(l,4),u=s(l,a);else if("OTTO"===f)n.outlinesFormat="cff",a=m.getUShort(l,4),u=s(l,a);else{if("wOFF"!==f)throw new Error("Unsupported OpenType signature "+f);var h=m.getTag(l,4);if(h===String.fromCharCode(0,1,0,0))n.outlinesFormat="truetype";else{if("OTTO"!==h)throw new Error("Unsupported OpenType flavor "+f);n.outlinesFormat="cff"}a=m.getUShort(l,12),u=i(l,a)}for(var d,g,v,A,L,D,B,H,P=0;a>P;P+=1){var G,F=u[P];switch(F.tag){case"cmap":G=o(l,F),n.tables.cmap=y.parse(G.data,G.offset),n.encoding=new p.CmapEncoding(n.tables.cmap);break;case"fvar":g=F;break;case"head":G=o(l,F),n.tables.head=U.parse(G.data,G.offset),n.unitsPerEm=n.tables.head.unitsPerEm,t=n.tables.head.indexToLocFormat;break;case"hhea":G=o(l,F),n.tables.hhea=O.parse(G.data,G.offset),n.ascender=n.tables.hhea.ascender,n.descender=n.tables.hhea.descender,n.numberOfHMetrics=n.tables.hhea.numberOfHMetrics;break;case"hmtx":L=F;break;case"ltag":G=o(l,F),r=E.parse(G.data,G.offset);break;case"maxp":G=o(l,F),n.tables.maxp=k.parse(G.data,G.offset),n.numGlyphs=n.tables.maxp.numGlyphs;break;case"name":H=F;break;case"OS/2":G=o(l,F),n.tables.os2=I.parse(G.data,G.offset);break;case"post":G=o(l,F),n.tables.post=N.parse(G.data,G.offset),n.glyphNames=new p.GlyphNames(n.tables.post);break;case"glyf":v=F;break;case"loca":B=F;break;case"CFF ":d=F;break;case"kern":D=F;break;case"GPOS":A=F}}var W=o(l,H);if(n.tables.name=M.parse(W.data,W.offset,r),n.names=n.tables.name,v&&B){var q=0===t,z=o(l,B),X=C.parse(z.data,z.offset,n.numGlyphs,q),Y=o(l,v);n.glyphs=x.parse(Y.data,Y.offset,X,n)}else{if(!d)throw new Error("Font doesn't contain TrueType or CFF outlines.");var V=o(l,d);b.parse(V.data,V.offset,n)}var j=o(l,L);if(R.parse(j.data,j.offset,n.numberOfHMetrics,n.numGlyphs,n.glyphs),p.addGlyphNames(n),D){var _=o(l,D);n.kerningPairs=w.parse(_.data,_.offset)}else n.kerningPairs={};if(A){var Z=o(l,A);T.parse(Z.data,Z.offset,n)}if(g){var K=o(l,g);n.tables.fvar=S.parse(K.data,K.offset,n.names)}return n}function u(e,t){var r="undefined"==typeof window,s=r?a:n;s(e,function(e,r){if(e)return t(e);var a;try{a=l(r)}catch(n){return t(n,null)}return t(null,a)})}function f(t){var r=e("fs"),a=r.readFileSync(t);return l(v.nodeBufferToArrayBuffer(a))}var h=e("tiny-inflate"),p=e("./encoding"),c=e("./font"),d=e("./glyph"),m=e("./parse"),g=e("./path"),v=e("./util"),y=e("./tables/cmap"),b=e("./tables/cff"),S=e("./tables/fvar"),x=e("./tables/glyf"),T=e("./tables/gpos"),U=e("./tables/head"),O=e("./tables/hhea"),R=e("./tables/hmtx"),w=e("./tables/kern"),E=e("./tables/ltag"),C=e("./tables/loca"),k=e("./tables/maxp"),M=e("./tables/name"),I=e("./tables/os2"),N=e("./tables/post");r._parse=m,r.Font=c.Font,r.Glyph=d.Glyph,r.Path=g.Path,r.parse=l,r.load=u,r.loadSync=f},{"./encoding":4,"./font":5,"./glyph":6,"./parse":9,"./path":10,"./tables/cff":12,"./tables/cmap":13,"./tables/fvar":14,"./tables/glyf":15,"./tables/gpos":16,"./tables/head":17,"./tables/hhea":18,"./tables/hmtx":19,"./tables/kern":20,"./tables/loca":21,"./tables/ltag":22,"./tables/maxp":23,"./tables/name":24,"./tables/os2":25,"./tables/post":26,"./util":29,fs:void 0,"tiny-inflate":1}],9:[function(e,t,r){"use strict";function a(e,t){this.data=e,this.offset=t,this.relativeOffset=0}r.getByte=function(e,t){return e.getUint8(t)},r.getCard8=r.getByte,r.getUShort=function(e,t){return e.getUint16(t,!1)},r.getCard16=r.getUShort,r.getShort=function(e,t){return e.getInt16(t,!1)},r.getULong=function(e,t){return e.getUint32(t,!1)},r.getFixed=function(e,t){var r=e.getInt16(t,!1),a=e.getUint16(t+2,!1);return r+a/65535},r.getTag=function(e,t){for(var r="",a=t;t+4>a;a+=1)r+=String.fromCharCode(e.getInt8(a));return r},r.getOffset=function(e,t,r){for(var a=0,n=0;r>n;n+=1)a<<=8,a+=e.getUint8(t+n);return a},r.getBytes=function(e,t,r){for(var a=[],n=t;r>n;n+=1)a.push(e.getUint8(n));return a},r.bytesToString=function(e){for(var t="",r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return t};var n={"byte":1,uShort:2,"short":2,uLong:4,fixed:4,longDateTime:8,tag:4};a.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},a.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},a.prototype.parseCard8=a.prototype.parseByte,a.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},a.prototype.parseCard16=a.prototype.parseUShort,a.prototype.parseSID=a.prototype.parseUShort,a.prototype.parseOffset16=a.prototype.parseUShort,a.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},a.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},a.prototype.parseULong=function(){var e=r.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},a.prototype.parseFixed=function(){var e=r.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},a.prototype.parseOffset16List=a.prototype.parseUShortList=function(e){for(var t=new Array(e),a=this.data,n=this.offset+this.relativeOffset,s=0;e>s;s++)t[s]=r.getUShort(a,n),n+=2;return this.relativeOffset+=2*e,t},a.prototype.parseString=function(e){var t=this.data,r=this.offset+this.relativeOffset,a="";this.relativeOffset+=e;for(var n=0;e>n;n++)a+=String.fromCharCode(t.getUint8(r+n));return a},a.prototype.parseTag=function(){return this.parseString(4)},a.prototype.parseLongDateTime=function(){var e=r.getULong(this.data,this.offset+this.relativeOffset+4);return this.relativeOffset+=8,
e},a.prototype.parseFixed=function(){var e=r.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e/65536},a.prototype.parseVersion=function(){var e=r.getUShort(this.data,this.offset+this.relativeOffset),t=r.getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e+t/4096/10},a.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=n[e]*t},r.Parser=a},{}],10:[function(e,t,r){"use strict";function a(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}a.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},a.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},a.prototype.curveTo=a.prototype.bezierCurveTo=function(e,t,r,a,n,s){this.commands.push({type:"C",x1:e,y1:t,x2:r,y2:a,x:n,y:s})},a.prototype.quadTo=a.prototype.quadraticCurveTo=function(e,t,r,a){this.commands.push({type:"Q",x1:e,y1:t,x:r,y:a})},a.prototype.close=a.prototype.closePath=function(){this.commands.push({type:"Z"})},a.prototype.extend=function(e){e.commands&&(e=e.commands),Array.prototype.push.apply(this.commands,e)},a.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var r=this.commands[t];"M"===r.type?e.moveTo(r.x,r.y):"L"===r.type?e.lineTo(r.x,r.y):"C"===r.type?e.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?e.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},a.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function r(){for(var e="",r=0;r<arguments.length;r+=1){var a=arguments[r];a>=0&&r>0&&(e+=" "),e+=t(a)}return e}e=void 0!==e?e:2;for(var a="",n=0;n<this.commands.length;n+=1){var s=this.commands[n];"M"===s.type?a+="M"+r(s.x,s.y):"L"===s.type?a+="L"+r(s.x,s.y):"C"===s.type?a+="C"+r(s.x1,s.y1,s.x2,s.y2,s.x,s.y):"Q"===s.type?a+="Q"+r(s.x1,s.y1,s.x,s.y):"Z"===s.type&&(a+="Z")}return a},a.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&"black"!==this.fill&&(t+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},r.Path=a},{}],11:[function(e,t,r){"use strict";function a(e,t,r){var a;for(a=0;a<t.length;a+=1){var n=t[a];this[n.name]=n.value}if(this.tableName=e,this.fields=t,r){var s=Object.keys(r);for(a=0;a<s.length;a+=1){var i=s[a],o=r[i];void 0!==this[i]&&(this[i]=o)}}}var n=e("./types").encode,s=e("./types").sizeOf;a.prototype.encode=function(){return n.TABLE(this)},a.prototype.sizeOf=function(){return s.TABLE(this)},r.Record=r.Table=a},{"./types":28}],12:[function(e,t,r){"use strict";function a(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1)if(!a(e[r],t[r]))return!1;return!0}return!1}function n(e,t,r){var a,n,s,i=[],o=[],l=L.getCard16(e,t);if(0!==l){var u=L.getByte(e,t+2);n=t+(l+1)*u+2;var f=t+3;for(a=0;l+1>a;a+=1)i.push(L.getOffset(e,f,u)),f+=u;s=n+i[l]}else s=t+2;for(a=0;a<i.length-1;a+=1){var h=L.getBytes(e,n+i[a],n+i[a+1]);r&&(h=r(h)),o.push(h)}return{objects:o,startOffset:t,endOffset:s}}function s(e){for(var t="",r=15,a=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var n=e.parseByte(),s=n>>4,i=15&n;if(s===r)break;if(t+=a[s],i===r)break;t+=a[i]}return parseFloat(t)}function i(e,t){var r,a,n,i;if(28===t)return r=e.parseByte(),a=e.parseByte(),r<<8|a;if(29===t)return r=e.parseByte(),a=e.parseByte(),n=e.parseByte(),i=e.parseByte(),r<<24|a<<16|n<<8|i;if(30===t)return s(e);if(t>=32&&246>=t)return t-139;if(t>=247&&250>=t)return r=e.parseByte(),256*(t-247)+r+108;if(t>=251&&254>=t)return r=e.parseByte(),256*-(t-251)-r-108;throw new Error("Invalid b0 "+t)}function o(e){for(var t={},r=0;r<e.length;r+=1){var a,n=e[r][0],s=e[r][1];if(a=1===s.length?s[0]:s,t.hasOwnProperty(n))throw new Error("Object "+t+" already has key "+n);t[n]=a}return t}function l(e,t,r){t=void 0!==t?t:0;var a=new L.Parser(e,t),n=[],s=[];for(r=void 0!==r?r:e.length;a.relativeOffset<r;){var l=a.parseByte();21>=l?(12===l&&(l=1200+a.parseByte()),n.push([l,s]),s=[]):s.push(i(a,l))}return o(n)}function u(e,t){return t=390>=t?N.cffStandardStrings[t]:e[t-391]}function f(e,t,r){for(var a={},n=0;n<t.length;n+=1){var s=t[n],i=e[s.op];void 0===i&&(i=void 0!==s.value?s.value:null),"SID"===s.type&&(i=u(r,i)),a[s.name]=i}return a}function h(e,t){var r={};return r.formatMajor=L.getCard8(e,t),r.formatMinor=L.getCard8(e,t+1),r.size=L.getCard8(e,t+2),r.offsetSize=L.getCard8(e,t+3),r.startOffset=t,r.endOffset=t+4,r}function p(e,t){var r=l(e,0,e.byteLength);return f(r,H,t)}function c(e,t,r,a){var n=l(e,t,r);return f(n,P,a)}function d(e,t,r,a){var n,s,i,o=new L.Parser(e,t);r-=1;var l=[".notdef"],f=o.parseCard8();if(0===f)for(n=0;r>n;n+=1)s=o.parseSID(),l.push(u(a,s));else if(1===f)for(;l.length<=r;)for(s=o.parseSID(),i=o.parseCard8(),n=0;i>=n;n+=1)l.push(u(a,s)),s+=1;else{if(2!==f)throw new Error("Unknown charset format "+f);for(;l.length<=r;)for(s=o.parseSID(),i=o.parseCard16(),n=0;i>=n;n+=1)l.push(u(a,s)),s+=1}return l}function m(e,t,r){var a,n,s={},i=new L.Parser(e,t),o=i.parseCard8();if(0===o){var l=i.parseCard8();for(a=0;l>a;a+=1)n=i.parseCard8(),s[n]=a}else{if(1!==o)throw new Error("Unknown encoding format "+o);var u=i.parseCard8();for(n=1,a=0;u>a;a+=1)for(var f=i.parseCard8(),h=i.parseCard8(),p=f;f+h>=p;p+=1)s[p]=n,n+=1}return new N.CffEncoding(s,r)}function g(e,t,r){function a(e,t){m&&f.closePath(),f.moveTo(e,t),m=!0}function n(){var t;t=h.length%2!==0,t&&!c&&(d=h.shift()+e.nominalWidthX),p+=h.length>>1,h.length=0,c=!0}function s(r){for(var y,b,S,x,T,U,O,R,w,E,C,k,M=0;M<r.length;){var I=r[M];switch(M+=1,I){case 1:n();break;case 3:n();break;case 4:h.length>1&&!c&&(d=h.shift()+e.nominalWidthX,c=!0),v+=h.pop(),a(g,v);break;case 5:for(;h.length>0;)g+=h.shift(),v+=h.shift(),f.lineTo(g,v);break;case 6:for(;h.length>0&&(g+=h.shift(),f.lineTo(g,v),0!==h.length);)v+=h.shift(),f.lineTo(g,v);break;case 7:for(;h.length>0&&(v+=h.shift(),f.lineTo(g,v),0!==h.length);)g+=h.shift(),f.lineTo(g,v);break;case 8:for(;h.length>0;)i=g+h.shift(),o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),g=l+h.shift(),v=u+h.shift(),f.curveTo(i,o,l,u,g,v);break;case 10:T=h.pop()+e.subrsBias,U=e.subrs[T],U&&s(U);break;case 11:return;case 12:switch(I=r[M],M+=1,I){case 35:i=g+h.shift(),o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),O=l+h.shift(),R=u+h.shift(),w=O+h.shift(),E=R+h.shift(),C=w+h.shift(),k=E+h.shift(),g=C+h.shift(),v=k+h.shift(),h.shift(),f.curveTo(i,o,l,u,O,R),f.curveTo(w,E,C,k,g,v);break;case 34:i=g+h.shift(),o=v,l=i+h.shift(),u=o+h.shift(),O=l+h.shift(),R=u,w=O+h.shift(),E=u,C=w+h.shift(),k=v,g=C+h.shift(),f.curveTo(i,o,l,u,O,R),f.curveTo(w,E,C,k,g,v);break;case 36:i=g+h.shift(),o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),O=l+h.shift(),R=u,w=O+h.shift(),E=u,C=w+h.shift(),k=E+h.shift(),g=C+h.shift(),f.curveTo(i,o,l,u,O,R),f.curveTo(w,E,C,k,g,v);break;case 37:i=g+h.shift(),o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),O=l+h.shift(),R=u+h.shift(),w=O+h.shift(),E=R+h.shift(),C=w+h.shift(),k=E+h.shift(),Math.abs(C-g)>Math.abs(k-v)?g=C+h.shift():v=k+h.shift(),f.curveTo(i,o,l,u,O,R),f.curveTo(w,E,C,k,g,v);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+I),h.length=0}break;case 14:h.length>0&&!c&&(d=h.shift()+e.nominalWidthX,c=!0),m&&(f.closePath(),m=!1);break;case 18:n();break;case 19:case 20:n(),M+=p+7>>3;break;case 21:h.length>2&&!c&&(d=h.shift()+e.nominalWidthX,c=!0),v+=h.pop(),g+=h.pop(),a(g,v);break;case 22:h.length>1&&!c&&(d=h.shift()+e.nominalWidthX,c=!0),g+=h.pop(),a(g,v);break;case 23:n();break;case 24:for(;h.length>2;)i=g+h.shift(),o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),g=l+h.shift(),v=u+h.shift(),f.curveTo(i,o,l,u,g,v);g+=h.shift(),v+=h.shift(),f.lineTo(g,v);break;case 25:for(;h.length>6;)g+=h.shift(),v+=h.shift(),f.lineTo(g,v);i=g+h.shift(),o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),g=l+h.shift(),v=u+h.shift(),f.curveTo(i,o,l,u,g,v);break;case 26:for(h.length%2&&(g+=h.shift());h.length>0;)i=g,o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),g=l,v=u+h.shift(),f.curveTo(i,o,l,u,g,v);break;case 27:for(h.length%2&&(v+=h.shift());h.length>0;)i=g+h.shift(),o=v,l=i+h.shift(),u=o+h.shift(),g=l+h.shift(),v=u,f.curveTo(i,o,l,u,g,v);break;case 28:y=r[M],b=r[M+1],h.push((y<<24|b<<16)>>16),M+=2;break;case 29:T=h.pop()+e.gsubrsBias,U=e.gsubrs[T],U&&s(U);break;case 30:for(;h.length>0&&(i=g,o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),g=l+h.shift(),v=u+(1===h.length?h.shift():0),f.curveTo(i,o,l,u,g,v),0!==h.length);)i=g+h.shift(),o=v,l=i+h.shift(),u=o+h.shift(),v=u+h.shift(),g=l+(1===h.length?h.shift():0),f.curveTo(i,o,l,u,g,v);break;case 31:for(;h.length>0&&(i=g+h.shift(),o=v,l=i+h.shift(),u=o+h.shift(),v=u+h.shift(),g=l+(1===h.length?h.shift():0),f.curveTo(i,o,l,u,g,v),0!==h.length);)i=g,o=v+h.shift(),l=i+h.shift(),u=o+h.shift(),g=l+h.shift(),v=u+(1===h.length?h.shift():0),f.curveTo(i,o,l,u,g,v);break;default:32>I?console.log("Glyph "+t.index+": unknown operator "+I):247>I?h.push(I-139):251>I?(y=r[M],M+=1,h.push(256*(I-247)+y+108)):255>I?(y=r[M],M+=1,h.push(256*-(I-251)-y-108)):(y=r[M],b=r[M+1],S=r[M+2],x=r[M+3],M+=4,h.push((y<<24|b<<16|S<<8|x)/65536))}}}var i,o,l,u,f=new D.Path,h=[],p=0,c=!1,d=e.defaultWidthX,m=!1,g=0,v=0;return s(r),t.advanceWidth=d,f}function v(e){var t;return t=e.length<1240?107:e.length<33900?1131:32768}function y(e,t,r){r.tables.cff={};var a=h(e,t),s=n(e,a.endOffset,L.bytesToString),i=n(e,s.endOffset),o=n(e,i.endOffset,L.bytesToString),l=n(e,o.endOffset);r.gsubrs=l.objects,r.gsubrsBias=v(r.gsubrs);var u=new DataView(new Uint8Array(i.objects[0]).buffer),f=p(u,o.objects);r.tables.cff.topDict=f;var y=t+f["private"][1],b=c(e,y,f["private"][0],o.objects);if(r.defaultWidthX=b.defaultWidthX,r.nominalWidthX=b.nominalWidthX,0!==b.subrs){var S=y+b.subrs,x=n(e,S);r.subrs=x.objects,r.subrsBias=v(r.subrs)}else r.subrs=[],r.subrsBias=0;var T=n(e,t+f.charStrings);r.nGlyphs=T.objects.length;var U=d(e,t+f.charset,r.nGlyphs,o.objects);0===f.encoding?r.cffEncoding=new N.CffEncoding(N.cffStandardEncoding,U):1===f.encoding?r.cffEncoding=new N.CffEncoding(N.cffExpertEncoding,U):r.cffEncoding=m(e,t+f.encoding,U),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new A.GlyphSet(r);for(var O=0;O<r.nGlyphs;O+=1){var R=T.objects[O];r.glyphs.push(O,A.cffGlyphLoader(r,O,g,R))}}function b(e,t){var r,a=N.cffStandardStrings.indexOf(e);return a>=0&&(r=a),a=t.indexOf(e),a>=0?r=a+N.cffStandardStrings.length:(r=N.cffStandardStrings.length+t.length,t.push(e)),r}function S(){return new B.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function x(e){var t=new B.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var r=0;r<e.length;r+=1)t.names.push({name:"name_"+r,type:"NAME",value:e[r]});return t}function T(e,t,r){for(var n={},s=0;s<e.length;s+=1){var i=e[s],o=t[i.name];void 0===o||a(o,i.value)||("SID"===i.type&&(o=b(o,r)),n[i.op]={name:i.name,type:i.type,value:o})}return n}function U(e,t){var r=new B.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=T(H,e,t),r}function O(e){var t=new B.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function R(e){var t=new B.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var r=0;r<e.length;r+=1)t.strings.push({name:"string_"+r,type:"STRING",value:e[r]});return t}function w(){return new B.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function E(e,t){for(var r=new B.Record("Charsets",[{name:"format",type:"Card8",value:0}]),a=0;a<e.length;a+=1){var n=e[a],s=b(n,t);r.fields.push({name:"glyph_"+a,type:"SID",value:s})}return r}function C(e){var t=[],r=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var a=0,n=0,s=0;s<r.commands.length;s+=1){var i,o,l=r.commands[s];if("Q"===l.type){var u=1/3,f=2/3;l={type:"C",x:l.x,y:l.y,x1:u*a+f*l.x1,y1:u*n+f*l.y1,x2:u*l.x+f*l.x1,y2:u*l.y+f*l.y1}}if("M"===l.type)i=Math.round(l.x-a),o=Math.round(l.y-n),t.push({name:"dx",type:"NUMBER",value:i}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rmoveto",type:"OP",value:21}),a=Math.round(l.x),n=Math.round(l.y);else if("L"===l.type)i=Math.round(l.x-a),o=Math.round(l.y-n),t.push({name:"dx",type:"NUMBER",value:i}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rlineto",type:"OP",value:5}),a=Math.round(l.x),n=Math.round(l.y);else if("C"===l.type){var h=Math.round(l.x1-a),p=Math.round(l.y1-n),c=Math.round(l.x2-l.x1),d=Math.round(l.y2-l.y1);i=Math.round(l.x-l.x2),o=Math.round(l.y-l.y2),t.push({name:"dx1",type:"NUMBER",value:h}),t.push({name:"dy1",type:"NUMBER",value:p}),t.push({name:"dx2",type:"NUMBER",value:c}),t.push({name:"dy2",type:"NUMBER",value:d}),t.push({name:"dx",type:"NUMBER",value:i}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rrcurveto",type:"OP",value:8}),a=Math.round(l.x),n=Math.round(l.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function k(e){for(var t=new B.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<e.length;r+=1){var a=e.get(r),n=C(a);t.charStrings.push({name:a.name,type:"CHARSTRING",value:n})}return t}function M(e,t){var r=new B.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=T(P,e,t),r}function I(e,t){for(var r,a=new B.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),n=1/t.unitsPerEm,s={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[n,0,0,n,0,0],charset:999,encoding:0,charStrings:999,"private":[0,999]},i={},o=[],l=1;l<e.length;l+=1)r=e.get(l),o.push(r.name);var u=[];a.header=S(),a.nameIndex=x([t.postScriptName]);var f=U(s,u);a.topDictIndex=O(f),a.globalSubrIndex=w(),a.charsets=E(o,u),a.charStringsIndex=k(e),a.privateDict=M(i,u),a.stringIndex=R(u);var h=a.header.sizeOf()+a.nameIndex.sizeOf()+a.topDictIndex.sizeOf()+a.stringIndex.sizeOf()+a.globalSubrIndex.sizeOf();return s.charset=h,s.encoding=0,s.charStrings=s.charset+a.charsets.sizeOf(),s["private"][1]=s.charStrings+a.charStringsIndex.sizeOf(),f=U(s,u),a.topDictIndex=O(f),a}var N=e("../encoding"),A=e("../glyphset"),L=e("../parse"),D=e("../path"),B=e("../table"),H=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],P=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];r.parse=y,r.make=I},{"../encoding":4,"../glyphset":7,"../parse":9,"../path":10,"../table":11}],13:[function(e,t,r){"use strict";function a(e,t){var r,a={};a.version=l.getUShort(e,t),o.argument(0===a.version,"cmap table version should be 0."),a.numTables=l.getUShort(e,t+2);var n=-1;for(r=0;r<a.numTables;r+=1){var s=l.getUShort(e,t+4+8*r),i=l.getUShort(e,t+4+8*r+2);if(3===s&&(1===i||0===i)){n=l.getULong(e,t+4+8*r+4);break}}if(-1===n)return null;var u=new l.Parser(e,t+n);a.format=u.parseUShort(),o.argument(4===a.format,"Only format 4 cmap tables are supported."),a.length=u.parseUShort(),a.language=u.parseUShort();var f;a.segCount=f=u.parseUShort()>>1,u.skip("uShort",3),a.glyphIndexMap={};var h=new l.Parser(e,t+n+14),p=new l.Parser(e,t+n+16+2*f),c=new l.Parser(e,t+n+16+4*f),d=new l.Parser(e,t+n+16+6*f),m=t+n+16+8*f;for(r=0;f-1>r;r+=1)for(var g,v=h.parseUShort(),y=p.parseUShort(),b=c.parseShort(),S=d.parseUShort(),x=y;v>=x;x+=1)0!==S?(m=d.offset+d.relativeOffset-2,m+=S,m+=2*(x-y),g=l.getUShort(e,m),0!==g&&(g=g+b&65535)):g=x+b&65535,a.glyphIndexMap[x]=g;return a}function n(e,t,r){e.segments.push({end:t,start:t,delta:-(t-r),offset:0})}function s(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}function i(e){var t,r=new u.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(r.segments=[],t=0;t<e.length;t+=1){for(var a=e.get(t),i=0;i<a.unicodes.length;i+=1)n(r,a.unicodes[i],t);r.segments=r.segments.sort(function(e,t){return e.start-t.start})}s(r);var o;o=r.segments.length,r.segCountX2=2*o,r.searchRange=2*Math.pow(2,Math.floor(Math.log(o)/Math.log(2))),r.entrySelector=Math.log(r.searchRange/2)/Math.log(2),r.rangeShift=r.segCountX2-r.searchRange;var l=[],f=[],h=[],p=[],c=[];for(t=0;o>t;t+=1){var d=r.segments[t];l=l.concat({name:"end_"+t,type:"USHORT",value:d.end}),f=f.concat({name:"start_"+t,type:"USHORT",value:d.start}),h=h.concat({name:"idDelta_"+t,type:"SHORT",value:d.delta}),p=p.concat({name:"idRangeOffset_"+t,type:"USHORT",value:d.offset}),void 0!==d.glyphId&&(c=c.concat({name:"glyph_"+t,type:"USHORT",value:d.glyphId}))}return r.fields=r.fields.concat(l),r.fields.push({name:"reservedPad",type:"USHORT",value:0}),r.fields=r.fields.concat(f),r.fields=r.fields.concat(h),r.fields=r.fields.concat(p),r.fields=r.fields.concat(c),r.length=14+2*l.length+2+2*f.length+2*h.length+2*p.length+2*c.length,r}var o=e("../check"),l=e("../parse"),u=e("../table");r.parse=a,r.make=i},{"../check":2,"../parse":9,"../table":11}],14:[function(e,t,r){"use strict";function a(e,t){var r=JSON.stringify(e),a=256;for(var n in t){var s=parseInt(n);if(s&&!(256>s)){if(JSON.stringify(t[n])===r)return s;s>=a&&(a=s+1)}}return t[a]=e,a}function n(e,t,r){var n=a(t.name,r);return[{name:"tag_"+e,type:"TAG",value:t.tag},{name:"minValue_"+e,type:"FIXED",value:t.minValue<<16},{name:"defaultValue_"+e,type:"FIXED",value:t.defaultValue<<16},{name:"maxValue_"+e,type:"FIXED",value:t.maxValue<<16},{name:"flags_"+e,type:"USHORT",value:0},{name:"nameID_"+e,type:"USHORT",value:n}]}function s(e,t,r){var a={},n=new h.Parser(e,t);return a.tag=n.parseTag(),a.minValue=n.parseFixed(),a.defaultValue=n.parseFixed(),a.maxValue=n.parseFixed(),n.skip("uShort",1),a.name=r[n.parseUShort()]||{},a}function i(e,t,r,n){for(var s=a(t.name,n),i=[{name:"nameID_"+e,type:"USHORT",value:s},{name:"flags_"+e,type:"USHORT",value:0}],o=0;o<r.length;++o){var l=r[o].tag;i.push({name:"axis_"+e+" "+l,type:"FIXED",value:t.coordinates[l]<<16})}return i}function o(e,t,r,a){var n={},s=new h.Parser(e,t);n.name=a[s.parseUShort()]||{},s.skip("uShort",1),n.coordinates={};for(var i=0;i<r.length;++i)n.coordinates[r[i].tag]=s.parseFixed();return n}function l(e,t){var r=new p.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:e.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:e.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*e.axes.length}]);r.offsetToData=r.sizeOf();for(var a=0;a<e.axes.length;a++)r.fields=r.fields.concat(n(a,e.axes[a],t));for(var s=0;s<e.instances.length;s++)r.fields=r.fields.concat(i(s,e.instances[s],e.axes,t));return r}function u(e,t,r){var a=new h.Parser(e,t),n=a.parseULong();f.argument(65536===n,"Unsupported fvar table version.");var i=a.parseOffset16();a.skip("uShort",1);for(var l=a.parseUShort(),u=a.parseUShort(),p=a.parseUShort(),c=a.parseUShort(),d=[],m=0;l>m;m++)d.push(s(e,t+i+m*u,r));for(var g=[],v=t+i+l*u,y=0;p>y;y++)g.push(o(e,v+y*c,d,r));return{axes:d,instances:g}}var f=e("../check"),h=e("../parse"),p=e("../table");r.make=l,r.parse=u},{"../check":2,"../parse":9,"../table":11}],15:[function(e,t,r){"use strict";function a(e,t,r,a,n){var s;return(t&a)>0?(s=e.parseByte(),0===(t&n)&&(s=-s),s=r+s):s=(t&n)>0?r:r+e.parseShort(),s}function n(e,t,r){var n=new p.Parser(t,r);e.numberOfContours=n.parseShort(),e.xMin=n.parseShort(),e.yMin=n.parseShort(),e.xMax=n.parseShort(),e.yMax=n.parseShort();var s,i;if(e.numberOfContours>0){var o,l=e.endPointIndices=[];for(o=0;o<e.numberOfContours;o+=1)l.push(n.parseUShort());for(e.instructionLength=n.parseUShort(),e.instructions=[],o=0;o<e.instructionLength;o+=1)e.instructions.push(n.parseByte());var u=l[l.length-1]+1;for(s=[],o=0;u>o;o+=1)if(i=n.parseByte(),s.push(i),(8&i)>0)for(var h=n.parseByte(),c=0;h>c;c+=1)s.push(i),o+=1;if(f.argument(s.length===u,"Bad flags."),l.length>0){var d,m=[];if(u>0){for(o=0;u>o;o+=1)i=s[o],d={},d.onCurve=!!(1&i),d.lastPointOfContour=l.indexOf(o)>=0,m.push(d);var g=0;for(o=0;u>o;o+=1)i=s[o],d=m[o],d.x=a(n,i,g,2,16),g=d.x;var v=0;for(o=0;u>o;o+=1)i=s[o],d=m[o],d.y=a(n,i,v,4,32),v=d.y}e.points=m}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var y=!0;y;){s=n.parseUShort();var b={glyphIndex:n.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&s)>0?(b.dx=n.parseShort(),b.dy=n.parseShort()):(b.dx=n.parseChar(),b.dy=n.parseChar()),(8&s)>0?b.xScale=b.yScale=n.parseF2Dot14():(64&s)>0?(b.xScale=n.parseF2Dot14(),b.yScale=n.parseF2Dot14()):(128&s)>0&&(b.xScale=n.parseF2Dot14(),b.scale01=n.parseF2Dot14(),b.scale10=n.parseF2Dot14(),b.yScale=n.parseF2Dot14()),e.components.push(b),y=!!(32&s)}}}function s(e,t){for(var r=[],a=0;a<e.length;a+=1){var n=e[a],s={x:t.xScale*n.x+t.scale01*n.y+t.dx,y:t.scale10*n.x+t.yScale*n.y+t.dy,onCurve:n.onCurve,lastPointOfContour:n.lastPointOfContour};r.push(s)}return r}function i(e){for(var t=[],r=[],a=0;a<e.length;a+=1){var n=e[a];r.push(n),n.lastPointOfContour&&(t.push(r),r=[])}return f.argument(0===r.length,"There are still points left in the current contour."),t}function o(e){var t=new c.Path;if(!e)return t;for(var r=i(e),a=0;a<r.length;a+=1){var n,s,o=r[a],l=o[0],u=o[o.length-1];l.onCurve?(n=null,s=!0):(l=u.onCurve?u:{x:(l.x+u.x)/2,y:(l.y+u.y)/2},n=l,s=!1),t.moveTo(l.x,l.y);for(var f=s?1:0;f<o.length;f+=1){var h=o[f],p=0===f?l:o[f-1];if(p.onCurve&&h.onCurve)t.lineTo(h.x,h.y);else if(p.onCurve&&!h.onCurve)n=h;else if(p.onCurve||h.onCurve){if(p.onCurve||!h.onCurve)throw new Error("Invalid state.");t.quadraticCurveTo(n.x,n.y,h.x,h.y),n=null}else{var d={x:(p.x+h.x)/2,y:(p.y+h.y)/2};t.quadraticCurveTo(p.x,p.y,d.x,d.y),n=h}}l!==u&&(n?t.quadraticCurveTo(n.x,n.y,l.x,l.y):t.lineTo(l.x,l.y))}return t.closePath(),t}function l(e,t){if(t.isComposite)for(var r=0;r<t.components.length;r+=1){var a=t.components[r],n=e.get(a.glyphIndex);if(n.getPath(),n.points){var i=s(n.points,a);t.points=t.points.concat(i)}}return o(t.points)}function u(e,t,r,a){var s,i=new h.GlyphSet(a);for(s=0;s<r.length-1;s+=1){var o=r[s],u=r[s+1];o!==u?i.push(s,h.ttfGlyphLoader(a,s,n,e,t+o,l)):i.push(s,h.glyphLoader(a,s))}return i}var f=e("../check"),h=e("../glyphset"),p=e("../parse"),c=e("../path");r.parse=u},{"../check":2,"../glyphset":7,"../parse":9,"../path":10}],16:[function(e,t,r){"use strict";function a(e,t){for(var r=new f.Parser(e,t),a=r.parseUShort(),n=[],s=0;a>s;s++)n[r.parseTag()]={offset:r.parseUShort()};return n}function n(e,t){var r=new f.Parser(e,t),a=r.parseUShort(),n=r.parseUShort();if(1===a)return r.parseUShortList(n);if(2===a){for(var s=[];n--;)for(var i=r.parseUShort(),o=r.parseUShort(),l=r.parseUShort(),u=i;o>=u;u++)s[l++]=u;return s}}function s(e,t){var r=new f.Parser(e,t),a=r.parseUShort();if(1===a){var n=r.parseUShort(),s=r.parseUShort(),i=r.parseUShortList(s);return function(e){return i[e-n]||0}}if(2===a){for(var o=r.parseUShort(),l=[],u=[],h=[],p=0;o>p;p++)l[p]=r.parseUShort(),u[p]=r.parseUShort(),h[p]=r.parseUShort();return function(e){for(var t=0,r=l.length-1;r>t;){var a=t+r+1>>1;e<l[a]?r=a-1:t=a}return l[t]<=e&&e<=u[t]?h[t]||0:0}}}function i(e,t){var r,a,i=new f.Parser(e,t),o=i.parseUShort(),l=i.parseUShort(),u=n(e,t+l),h=i.parseUShort(),p=i.parseUShort();if(4===h&&0===p){var c={};if(1===o){for(var d=i.parseUShort(),m=[],g=i.parseOffset16List(d),v=0;d>v;v++){var y=g[v],b=c[y];if(!b){b={},i.relativeOffset=y;for(var S=i.parseUShort();S--;){var x=i.parseUShort();h&&(r=i.parseShort()),p&&(a=i.parseShort()),b[x]=r}}m[u[v]]=b}return function(e,t){var r=m[e];return r?r[t]:void 0}}if(2===o){for(var T=i.parseUShort(),U=i.parseUShort(),O=i.parseUShort(),R=i.parseUShort(),w=s(e,t+T),E=s(e,t+U),C=[],k=0;O>k;k++)for(var M=C[k]=[],I=0;R>I;I++)h&&(r=i.parseShort()),p&&(a=i.parseShort()),M[I]=r;var N={};for(k=0;k<u.length;k++)N[u[k]]=1;return function(e,t){if(N[e]){var r=w(e),a=E(t),n=C[r];return n?n[a]:void 0}}}}}function o(e,t){var r=new f.Parser(e,t),a=r.parseUShort(),n=r.parseUShort(),s=16&n,o=r.parseUShort(),l=r.parseOffset16List(o),u={lookupType:a,lookupFlag:n,markFilteringSet:s?r.parseUShort():-1};if(2===a){for(var h=[],p=0;o>p;p++)h.push(i(e,t+l[p]));u.getKerningValue=function(e,t){for(var r=h.length;r--;){var a=h[r](e,t);if(void 0!==a)return a}return 0}}return u}function l(e,t,r){var n=new f.Parser(e,t),s=n.parseFixed();u.argument(1===s,"Unsupported GPOS table version."),a(e,t+n.parseUShort()),a(e,t+n.parseUShort());var i=n.parseUShort();n.relativeOffset=i;for(var l=n.parseUShort(),h=n.parseOffset16List(l),p=t+i,c=0;l>c;c++){var d=o(e,p+h[c]);2!==d.lookupType||r.getGposKerningValue||(r.getGposKerningValue=d.getKerningValue)}}var u=e("../check"),f=e("../parse");r.parse=l},{"../check":2,"../parse":9}],17:[function(e,t,r){"use strict";function a(e,t){var r={},a=new i.Parser(e,t);return r.version=a.parseVersion(),r.fontRevision=Math.round(1e3*a.parseFixed())/1e3,r.checkSumAdjustment=a.parseULong(),r.magicNumber=a.parseULong(),s.argument(1594834165===r.magicNumber,"Font header has wrong magic number."),r.flags=a.parseUShort(),r.unitsPerEm=a.parseUShort(),r.created=a.parseLongDateTime(),r.modified=a.parseLongDateTime(),r.xMin=a.parseShort(),r.yMin=a.parseShort(),r.xMax=a.parseShort(),r.yMax=a.parseShort(),r.macStyle=a.parseUShort(),r.lowestRecPPEM=a.parseUShort(),r.fontDirectionHint=a.parseShort(),r.indexToLocFormat=a.parseShort(),r.glyphDataFormat=a.parseShort(),r}function n(e){return new o.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:0},{name:"modified",type:"LONGDATETIME",value:0},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}var s=e("../check"),i=e("../parse"),o=e("../table");r.parse=a,r.make=n},{"../check":2,"../parse":9,"../table":11}],18:[function(e,t,r){"use strict";function a(e,t){var r={},a=new s.Parser(e,t);return r.version=a.parseVersion(),r.ascender=a.parseShort(),r.descender=a.parseShort(),r.lineGap=a.parseShort(),r.advanceWidthMax=a.parseUShort(),r.minLeftSideBearing=a.parseShort(),r.minRightSideBearing=a.parseShort(),r.xMaxExtent=a.parseShort(),r.caretSlopeRise=a.parseShort(),r.caretSlopeRun=a.parseShort(),r.caretOffset=a.parseShort(),a.relativeOffset+=8,r.metricDataFormat=a.parseShort(),r.numberOfHMetrics=a.parseUShort(),r}function n(e){return new i.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}var s=e("../parse"),i=e("../table");r.parse=a,r.make=n},{"../parse":9,"../table":11}],19:[function(e,t,r){"use strict";function a(e,t,r,a,n){for(var i,o,l=new s.Parser(e,t),u=0;a>u;u+=1){r>u&&(i=l.parseUShort(),o=l.parseShort());var f=n.get(u);f.advanceWidth=i,f.leftSideBearing=o}}function n(e){for(var t=new i.Table("hmtx",[]),r=0;r<e.length;r+=1){var a=e.get(r),n=a.advanceWidth||0,s=a.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:n}),t.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:s})}return t}var s=e("../parse"),i=e("../table");r.parse=a,r.make=n},{"../parse":9,"../table":11}],20:[function(e,t,r){"use strict";function a(e,t){var r={},a=new s.Parser(e,t),i=a.parseUShort();n.argument(0===i,"Unsupported kern table version."),a.skip("uShort",1);var o=a.parseUShort();n.argument(0===o,"Unsupported kern sub-table version."),a.skip("uShort",2);var l=a.parseUShort();a.skip("uShort",3);for(var u=0;l>u;u+=1){var f=a.parseUShort(),h=a.parseUShort(),p=a.parseShort();r[f+","+h]=p}return r}var n=e("../check"),s=e("../parse");r.parse=a},{"../check":2,"../parse":9}],21:[function(e,t,r){"use strict";function a(e,t,r,a){for(var s=new n.Parser(e,t),i=a?s.parseUShort:s.parseULong,o=[],l=0;r+1>l;l+=1){var u=i.call(s);a&&(u*=2),o.push(u)}return o}var n=e("../parse");r.parse=a},{"../parse":9}],22:[function(e,t,r){"use strict";function a(e){for(var t=new o.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),r="",a=12+4*e.length,n=0;n<e.length;++n){var s=r.indexOf(e[n]);0>s&&(s=r.length,r+=e[n]),t.fields.push({name:"offset "+n,type:"USHORT",value:a+s}),t.fields.push({name:"length "+n,type:"USHORT",value:e[n].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),t}function n(e,t){var r=new i.Parser(e,t),a=r.parseULong();s.argument(1===a,"Unsupported ltag table version."),r.skip("uLong",1);for(var n=r.parseULong(),o=[],l=0;n>l;l++){for(var u="",f=t+r.parseUShort(),h=r.parseUShort(),p=f;f+h>p;++p)u+=String.fromCharCode(e.getInt8(p));o.push(u)}return o}var s=e("../check"),i=e("../parse"),o=e("../table");r.make=a,r.parse=n},{"../check":2,"../parse":9,"../table":11}],23:[function(e,t,r){"use strict";function a(e,t){var r={},a=new s.Parser(e,t);return r.version=a.parseVersion(),r.numGlyphs=a.parseUShort(),1===r.version&&(r.maxPoints=a.parseUShort(),r.maxContours=a.parseUShort(),r.maxCompositePoints=a.parseUShort(),r.maxCompositeContours=a.parseUShort(),r.maxZones=a.parseUShort(),r.maxTwilightPoints=a.parseUShort(),
r.maxStorage=a.parseUShort(),r.maxFunctionDefs=a.parseUShort(),r.maxInstructionDefs=a.parseUShort(),r.maxStackElements=a.parseUShort(),r.maxSizeOfInstructions=a.parseUShort(),r.maxComponentElements=a.parseUShort(),r.maxComponentDepth=a.parseUShort()),r}function n(e){return new i.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}var s=e("../parse"),i=e("../table");r.parse=a,r.make=n},{"../parse":9,"../table":11}],24:[function(e,t,r){"use strict";function a(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return v[t];case 3:return b[t]}}function n(e,t,r){switch(e){case 0:return S;case 1:return T[r]||x[t];case 3:if(1===t||10===t)return S}}function s(e,t,r){for(var s={},i=new d.Parser(e,t),o=i.parseUShort(),l=i.parseUShort(),u=i.offset+i.parseUShort(),f=0;l>f;f++){var h=i.parseUShort(),c=i.parseUShort(),m=i.parseUShort(),v=i.parseUShort(),y=g[v]||v,b=i.parseUShort(),x=i.parseUShort(),T=a(h,m,r),U=n(h,c,m);if(void 0!==U&&void 0!==T){var O;if(O=U===S?p.UTF16(e,u+x,b):p.MACSTRING(e,u+x,b,U)){var R=s[y];void 0===R&&(R=s[y]={}),R[T]=O}}}var w=0;return 1===o&&(w=i.parseUShort()),s}function i(e){var t={};for(var r in e)t[e[r]]=parseInt(r);return t}function o(e,t,r,a,n,s){return new m.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:a},{name:"length",type:"USHORT",value:n},{name:"offset",type:"USHORT",value:s}])}function l(e,t){var r=e.length,a=t.length-r+1;e:for(var n=0;a>n;n++)for(;a>n;n++){for(var s=0;r>s;s++)if(t[n+s]!==e[s])continue e;return n}return-1}function u(e,t){var r=l(e,t);if(0>r){r=t.length;for(var a=0,n=e.length;n>a;++a)t.push(e[a])}return r}function f(e,t){var r,a=[],s={},l=i(g);for(var f in e){var h=l[f];void 0===h&&(h=f),r=parseInt(h),s[r]=e[f],a.push(r)}for(var p=i(v),d=i(b),S=[],x=[],T=0;T<a.length;T++){r=a[T];var U=s[r];for(var O in U){var R=U[O],w=1,E=p[O],C=y[E],k=n(w,C,E),M=c.MACSTRING(R,k);void 0===M&&(w=0,E=t.indexOf(O),0>E&&(E=t.length,t.push(O)),C=4,M=c.UTF16(R));var I=u(M,x);S.push(o(w,C,E,r,M.length,I));var N=d[O];if(void 0!==N){var A=c.UTF16(R),L=u(A,x);S.push(o(3,1,N,r,A.length,L))}}}S.sort(function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID});for(var D=new m.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:S.length},{name:"stringOffset",type:"USHORT",value:6+12*S.length}]),B=0;B<S.length;B++)D.fields.push({name:"record_"+B,type:"RECORD",value:S[B]});return D.fields.push({name:"strings",type:"LITERAL",value:x}),D}var h=e("../types"),p=h.decode,c=h.encode,d=e("../parse"),m=e("../table"),g=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],v={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},y={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},b={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},S="utf-16",x={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},T={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};r.parse=s,r.make=f},{"../parse":9,"../table":11,"../types":28}],25:[function(e,t,r){"use strict";function a(e){for(var t=0;t<l.length;t+=1){var r=l[t];if(e>=r.begin&&e<r.end)return t}return-1}function n(e,t){var r={},a=new i.Parser(e,t);r.version=a.parseUShort(),r.xAvgCharWidth=a.parseShort(),r.usWeightClass=a.parseUShort(),r.usWidthClass=a.parseUShort(),r.fsType=a.parseUShort(),r.ySubscriptXSize=a.parseShort(),r.ySubscriptYSize=a.parseShort(),r.ySubscriptXOffset=a.parseShort(),r.ySubscriptYOffset=a.parseShort(),r.ySuperscriptXSize=a.parseShort(),r.ySuperscriptYSize=a.parseShort(),r.ySuperscriptXOffset=a.parseShort(),r.ySuperscriptYOffset=a.parseShort(),r.yStrikeoutSize=a.parseShort(),r.yStrikeoutPosition=a.parseShort(),r.sFamilyClass=a.parseShort(),r.panose=[];for(var n=0;10>n;n++)r.panose[n]=a.parseByte();return r.ulUnicodeRange1=a.parseULong(),r.ulUnicodeRange2=a.parseULong(),r.ulUnicodeRange3=a.parseULong(),r.ulUnicodeRange4=a.parseULong(),r.achVendID=String.fromCharCode(a.parseByte(),a.parseByte(),a.parseByte(),a.parseByte()),r.fsSelection=a.parseUShort(),r.usFirstCharIndex=a.parseUShort(),r.usLastCharIndex=a.parseUShort(),r.sTypoAscender=a.parseShort(),r.sTypoDescender=a.parseShort(),r.sTypoLineGap=a.parseShort(),r.usWinAscent=a.parseUShort(),r.usWinDescent=a.parseUShort(),r.version>=1&&(r.ulCodePageRange1=a.parseULong(),r.ulCodePageRange2=a.parseULong()),r.version>=2&&(r.sxHeight=a.parseShort(),r.sCapHeight=a.parseShort(),r.usDefaultChar=a.parseUShort(),r.usBreakChar=a.parseUShort(),r.usMaxContent=a.parseUShort()),r}function s(e){return new o.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}var i=e("../parse"),o=e("../table"),l=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];r.unicodeRanges=l,r.getUnicodeRange=a,r.parse=n,r.make=s},{"../parse":9,"../table":11}],26:[function(e,t,r){"use strict";function a(e,t){var r,a={},n=new i.Parser(e,t);switch(a.version=n.parseVersion(),a.italicAngle=n.parseFixed(),a.underlinePosition=n.parseShort(),a.underlineThickness=n.parseShort(),a.isFixedPitch=n.parseULong(),a.minMemType42=n.parseULong(),a.maxMemType42=n.parseULong(),a.minMemType1=n.parseULong(),a.maxMemType1=n.parseULong(),a.version){case 1:a.names=s.standardNames.slice();break;case 2:for(a.numberOfGlyphs=n.parseUShort(),a.glyphNameIndex=new Array(a.numberOfGlyphs),r=0;r<a.numberOfGlyphs;r++)a.glyphNameIndex[r]=n.parseUShort();for(a.names=[],r=0;r<a.numberOfGlyphs;r++)if(a.glyphNameIndex[r]>=s.standardNames.length){var o=n.parseChar();a.names.push(n.parseString(o))}break;case 2.5:for(a.numberOfGlyphs=n.parseUShort(),a.offset=new Array(a.numberOfGlyphs),r=0;r<a.numberOfGlyphs;r++)a.offset[r]=n.parseChar()}return a}function n(){return new o.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var s=e("../encoding"),i=e("../parse"),o=e("../table");r.parse=a,r.make=n},{"../encoding":4,"../parse":9,"../table":11}],27:[function(e,t,r){"use strict";function a(e){return Math.log(e)/Math.log(2)|0}function n(e){for(;e.length%4!==0;)e.push(0);for(var t=0,r=0;r<e.length;r+=4)t+=(e[r]<<24)+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];return t%=Math.pow(2,32)}function s(e,t,r,a){return new h.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==r?r:0},{name:"length",type:"ULONG",value:void 0!==a?a:0}])}function i(e){var t=new h.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var r=Math.pow(2,a(t.numTables));t.searchRange=16*r,t.entrySelector=a(r),t.rangeShift=16*t.numTables-t.searchRange;for(var i=[],o=[],l=t.sizeOf()+s().sizeOf()*t.numTables;l%4!==0;)l+=1,o.push({name:"padding",type:"BYTE",value:0});for(var u=0;u<e.length;u+=1){var p=e[u];f.argument(4===p.tableName.length,"Table name"+p.tableName+" is invalid.");var c=p.sizeOf(),d=s(p.tableName,n(p.encode()),l,c);for(i.push({name:d.tag+" Table Record",type:"RECORD",value:d}),o.push({name:p.tableName+" table",type:"RECORD",value:p}),l+=c,f.argument(!isNaN(l),"Something went wrong calculating the offset.");l%4!==0;)l+=1,o.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(i),t.fields=t.fields.concat(o),t}function o(e,t,r){for(var a=0;a<t.length;a+=1){var n=e.charToGlyphIndex(t[a]);if(n>0){var s=e.glyphs.get(n);return s.getMetrics()}}return r}function l(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r];return t/e.length}function u(e){for(var t,r=[],a=[],s=[],u=[],f=[],h=[],T=[],U=0,O=0,R=0,w=0,E=0,C=0;C<e.glyphs.length;C+=1){var k=e.glyphs.get(C),M=0|k.unicode;if("undefined"==typeof k.advanceWidth)throw new Error("Glyph "+k.name+" ("+C+"): advanceWidth is required.");(t>M||null===t)&&(t=M),M>U&&(U=M);var I=S.getUnicodeRange(M);if(32>I)O|=1<<I;else if(64>I)R|=1<<I-32;else if(96>I)w|=1<<I-64;else{if(!(123>I))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");E|=1<<I-96}if(".notdef"!==k.name){var N=k.getMetrics();r.push(N.xMin),a.push(N.yMin),s.push(N.xMax),u.push(N.yMax),h.push(N.leftSideBearing),T.push(N.rightSideBearing),f.push(k.advanceWidth)}}var A={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,a),xMax:Math.max.apply(null,s),yMax:Math.max.apply(null,u),advanceWidthMax:Math.max.apply(null,f),advanceWidthAvg:l(f),minLeftSideBearing:Math.min.apply(null,h),maxLeftSideBearing:Math.max.apply(null,h),minRightSideBearing:Math.min.apply(null,T)};A.ascender=e.ascender,A.descender=e.descender;var L=d.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:A.xMin,yMin:A.yMin,xMax:A.xMax,yMax:A.yMax,lowestRecPPEM:3}),D=m.make({ascender:A.ascender,descender:A.descender,advanceWidthMax:A.advanceWidthMax,minLeftSideBearing:A.minLeftSideBearing,minRightSideBearing:A.minRightSideBearing,xMaxExtent:A.maxLeftSideBearing+(A.xMax-A.xMin),numberOfHMetrics:e.glyphs.length}),B=y.make(e.glyphs.length),H=S.make({xAvgCharWidth:Math.round(A.advanceWidthAvg),usWeightClass:500,usWidthClass:5,usFirstCharIndex:t,usLastCharIndex:U,ulUnicodeRange1:O,ulUnicodeRange2:R,ulUnicodeRange3:w,ulUnicodeRange4:E,fsSelection:64,sTypoAscender:A.ascender,sTypoDescender:A.descender,sTypoLineGap:0,usWinAscent:A.yMax,usWinDescent:Math.abs(A.yMin),ulCodePageRange1:1,sxHeight:o(e,"xyvw",{yMax:Math.round(A.ascender/2)}).yMax,sCapHeight:o(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",A).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),P=g.make(e.glyphs),G=p.make(e.glyphs),F=e.getEnglishName("fontFamily"),W=e.getEnglishName("fontSubfamily"),q=F+" "+W,z=e.getEnglishName("postScriptName");z||(z=F.replace(/\s/g,"")+"-"+W);var X={};for(var Y in e.names)X[Y]=e.names[Y];X.uniqueID||(X.uniqueID={en:e.getEnglishName("manufacturer")+":"+q}),X.postScriptName||(X.postScriptName={en:z}),X.preferredFamily||(X.preferredFamily=e.names.fontFamily),X.preferredSubfamily||(X.preferredSubfamily=e.names.fontSubfamily);var V=[],j=b.make(X,V),_=V.length>0?v.make(V):void 0,Z=x.make(),K=c.make(e.glyphs,{version:e.getEnglishName("version"),fullName:q,familyName:F,weightName:W,postScriptName:z,unitsPerEm:e.unitsPerEm,fontBBox:[0,A.yMin,A.ascender,A.advanceWidthMax]}),Q=[L,D,B,H,j,G,Z,K,P];_&&Q.push(_);var J=i(Q),$=J.encode(),ee=n($),te=J.fields,re=!1;for(C=0;C<te.length;C+=1)if("head table"===te[C].name){te[C].value.checkSumAdjustment=2981146554-ee,re=!0;break}if(!re)throw new Error("Could not find head table with checkSum to adjust.");return J}var f=e("../check"),h=e("../table"),p=e("./cmap"),c=e("./cff"),d=e("./head"),m=e("./hhea"),g=e("./hmtx"),v=e("./ltag"),y=e("./maxp"),b=e("./name"),S=e("./os2"),x=e("./post");r.computeCheckSum=n,r.make=i,r.fontToTable=u},{"../check":2,"../table":11,"./cff":12,"./cmap":13,"./head":17,"./hhea":18,"./hmtx":19,"./ltag":22,"./maxp":23,"./name":24,"./os2":25,"./post":26}],28:[function(e,t,r){"use strict";function a(e){return function(){return e}}var n=e("./check"),s=32768,i=2147483648,o={},l={},u={};l.BYTE=function(e){return n.argument(e>=0&&255>=e,"Byte value should be between 0 and 255."),[e]},u.BYTE=a(1),l.CHAR=function(e){return[e.charCodeAt(0)]},u.CHAR=a(1),l.CHARARRAY=function(e){for(var t=[],r=0;r<e.length;r+=1)t.push(e.charCodeAt(r));return t},u.CHARARRAY=function(e){return e.length},l.USHORT=function(e){return[e>>8&255,255&e]},u.USHORT=a(2),l.SHORT=function(e){return e>=s&&(e=-(2*s-e)),[e>>8&255,255&e]},u.SHORT=a(2),l.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},u.UINT24=a(3),l.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},u.ULONG=a(4),l.LONG=function(e){return e>=i&&(e=-(2*i-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},u.LONG=a(4),l.FIXED=l.ULONG,u.FIXED=u.ULONG,l.FWORD=l.SHORT,u.FWORD=u.SHORT,l.UFWORD=l.USHORT,u.UFWORD=u.USHORT,l.LONGDATETIME=function(){return[0,0,0,0,0,0,0,0]},u.LONGDATETIME=a(8),l.TAG=function(e){return n.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},u.TAG=a(4),l.Card8=l.BYTE,u.Card8=u.BYTE,l.Card16=l.USHORT,u.Card16=u.USHORT,l.OffSize=l.BYTE,u.OffSize=u.BYTE,l.SID=l.USHORT,u.SID=u.USHORT,l.NUMBER=function(e){return e>=-107&&107>=e?[e+139]:e>=108&&1131>=e?(e-=108,[(e>>8)+247,255&e]):e>=-1131&&-108>=e?(e=-e-108,[(e>>8)+251,255&e]):e>=-32768&&32767>=e?l.NUMBER16(e):l.NUMBER32(e)},u.NUMBER=function(e){return l.NUMBER(e).length},l.NUMBER16=function(e){return[28,e>>8&255,255&e]},u.NUMBER16=a(3),l.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},u.NUMBER32=a(5),l.REAL=function(e){var t=e.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(r){var a=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));t=(Math.round(e*a)/a).toString()}var n,s,i="";for(n=0,s=t.length;s>n;n+=1){var o=t[n];i+="e"===o?"-"===t[++n]?"c":"b":"."===o?"a":"-"===o?"e":o}i+=1&i.length?"f":"ff";var l=[30];for(n=0,s=i.length;s>n;n+=2)l.push(parseInt(i.substr(n,2),16));return l},u.REAL=function(e){return l.REAL(e).length},l.NAME=l.CHARARRAY,u.NAME=u.CHARARRAY,l.STRING=l.CHARARRAY,u.STRING=u.CHARARRAY,o.UTF16=function(e,t,r){for(var a=[],n=r/2,s=0;n>s;s++,t+=2)a[s]=e.getUint16(t);return String.fromCharCode.apply(null,a)},l.UTF16=function(e){for(var t=[],r=0;r<e.length;r+=1){var a=e.charCodeAt(r);t.push(a>>8&255),t.push(255&a)}return t},u.UTF16=function(e){return 2*e.length};var f={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};o.MACSTRING=function(e,t,r,a){var n=f[a];if(void 0!==n){for(var s="",i=0;r>i;i++){var o=e.getUint8(t+i);s+=127>=o?String.fromCharCode(o):n[127&o]}return s}};var h,p="function"==typeof WeakMap&&new WeakMap,c=function(e){if(!h){h={};for(var t in f)h[t]=new String(t)}var r=h[e];if(void 0!==r){if(p){var a=p.get(r);if(void 0!==a)return a}var n=f[e];if(void 0!==n){for(var s={},i=0;i<n.length;i++)s[n.charCodeAt(i)]=i+128;return p&&p.set(r,s),s}}};l.MACSTRING=function(e,t){var r=c(t);if(void 0!==r){for(var a=[],n=0;n<e.length;n++){var s=e.charCodeAt(n);if(s>=128&&(s=r[s],void 0===s))return;a.push(s)}return a}},u.MACSTRING=function(e,t){var r=l.MACSTRING(e,t);return void 0!==r?r.length:0},l.INDEX=function(e){var t,r=1,a=[r],n=[],s=0;for(t=0;t<e.length;t+=1){var i=l.OBJECT(e[t]);Array.prototype.push.apply(n,i),s+=i.length,r+=i.length,a.push(r)}if(0===n.length)return[0,0];var o=[],u=1+Math.floor(Math.log(s)/Math.log(2))/8|0,f=[void 0,l.BYTE,l.USHORT,l.UINT24,l.ULONG][u];for(t=0;t<a.length;t+=1){var h=f(a[t]);Array.prototype.push.apply(o,h)}return Array.prototype.concat(l.Card16(e.length),l.OffSize(u),o,n)},u.INDEX=function(e){return l.INDEX(e).length},l.DICT=function(e){for(var t=[],r=Object.keys(e),a=r.length,n=0;a>n;n+=1){var s=parseInt(r[n],0),i=e[s];t=t.concat(l.OPERAND(i.value,i.type)),t=t.concat(l.OPERATOR(s))}return t},u.DICT=function(e){return l.DICT(e).length},l.OPERATOR=function(e){return 1200>e?[e]:[12,e-1200]},l.OPERAND=function(e,t){var r=[];if(Array.isArray(t))for(var a=0;a<t.length;a+=1)n.argument(e.length===t.length,"Not enough arguments given for type"+t),r=r.concat(l.OPERAND(e[a],t[a]));else if("SID"===t)r=r.concat(l.NUMBER(e));else if("offset"===t)r=r.concat(l.NUMBER32(e));else if("number"===t)r=r.concat(l.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);r=r.concat(l.REAL(e))}return r},l.OP=l.BYTE,u.OP=u.BYTE;var d="function"==typeof WeakMap&&new WeakMap;l.CHARSTRING=function(e){if(d){var t=d.get(e);if(void 0!==t)return t}for(var r=[],a=e.length,n=0;a>n;n+=1){var s=e[n];r=r.concat(l[s.type](s.value))}return d&&d.set(e,r),r},u.CHARSTRING=function(e){return l.CHARSTRING(e).length},l.OBJECT=function(e){var t=l[e.type];return n.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},u.OBJECT=function(e){var t=u[e.type];return n.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},l.TABLE=function(e){var t,r=[],a=e.fields.length,s=[],i=[];for(t=0;a>t;t+=1){var o=e.fields[t],u=l[o.type];n.argument(void 0!==u,"No encoding function for field type "+o.type+" ("+o.name+")");var f=e[o.name];void 0===f&&(f=o.value);var h=u(f);"TABLE"===o.type?(i.push(r.length),r=r.concat([0,0]),s.push(h)):r=r.concat(h)}for(t=0;t<s.length;t+=1){var p=i[t],c=r.length;n.argument(65536>c,"Table "+e.tableName+" too big."),r[p]=c>>8,r[p+1]=255&c,r=r.concat(s[t])}return r},u.TABLE=function(e){for(var t=0,r=e.fields.length,a=0;r>a;a+=1){var s=e.fields[a],i=u[s.type];n.argument(void 0!==i,"No sizeOf function for field type "+s.type+" ("+s.name+")");var o=e[s.name];void 0===o&&(o=s.value),t+=i(o),"TABLE"===s.type&&(t+=2)}return t},l.RECORD=l.TABLE,u.RECORD=u.TABLE,l.LITERAL=function(e){return e},u.LITERAL=function(e){return e.length},r.decode=o,r.encode=l,r.sizeOf=u},{"./check":2}],29:[function(e,t,r){"use strict";r.isBrowser=function(){return"undefined"!=typeof window},r.isNode=function(){return"undefined"==typeof window},r.nodeBufferToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a<e.length;++a)r[a]=e[a];return t},r.arrayBufferToNodeBuffer=function(e){for(var t=new Buffer(e.byteLength),r=new Uint8Array(e),a=0;a<t.length;++a)t[a]=r[a];return t},r.checkArgument=function(e,t){if(!e)throw t}},{}]},{},[8])(8)});
!function(){"use strict";function e(e){for(var n=0;n<s.length;n++){var i=s[n];if(e.search(i)>=0)for(var r=e.lastIndexOf(")"),a=r,t=1,l="",o="";r>=0&&(r--,!(0>r));)switch(e[r]){case"'":case'"':return e.slice(0,r+1)+",wait"+l+")";case")":t++;break;case"(":if(t--,0===t)return 0===o.length?e.slice(0,r)+"(wait"+l+")":"wait"==o?e.slice(0,a)+l+" )":e.slice(0,a)+","+l+"wait)";break;case",":if(1===t)return"wait"==o?e.slice(0,r)+","+l+" wait)":e;break;case" ":l=" "+l;break;default:o=e[r]+o}}return e}function n(n,i){var r,a,s,o,c,f,p=0,v=0,g=0,u=null,h=null,d=null,w="",b=/(^\s*)(.*)/,m="",_="",y=!1,R=!1,k='"',x=[],E=/(\.pick)\s*(.)/,O=/def[^:]*:/,S=/class[^:]*:/;for(s=n.split("\n"),a=0;a<s.length;a++)if(f="",c=s[a].match(b),w=c[1],o=c[2],"#"!=o[0]){if("@"==o[0]){var G=s[a+1];if(c=G.match(b),"def"!=c[2].slice(0,3)&&"module"!=c[2].slice(0,6))continue;f=o,w=c[1],o=c[2],a++}if(0!==o.length){if("vpython"==i){x.length>0&&w.length<=x[x.length-1][1]&&x.pop(),null===t&&(l=[]);var $=o.split(" ");if("__future__"==$[1])continue;if("visual.factorial"==$[1])continue;if("from"==$[0]&&"import"==$[2]&&$.length>=4){if("visual.graph"==$[1]){if("*"==$[3])continue;return'ERROR: Currently only "from visual.graph import *" is supported, line '+(a+2)+": "+s[a]}if("visual"!=$[1]&&"vis"!=$[1])throw new Error("Line "+(a+2)+": cannot import from "+$[1]);if(null===t){if("*"==$[3])continue;t=$[1];for(var M=3;M<$.length;M++)if($[M].length>0&&","!=$[M]){if(","==$[M].slice(-1)&&($[M]=$[M].slice(0,-1))," "==$[M]||"("==$[M]||")"==$[M]||"("==$[M][0]||")"==$[M][-1])continue;l.push($[M])}}continue}if("import"==$[0]&&2==$.length){if("visual.graph"==$[1])return'ERROR: Currently only "from visual.graph import *" is supported, line '+(a+2)+": "+s[a];if("visual"!=$[1]&&"vis"!=$[1])return"ERROR: Cannot import from "+$[1]+", line "+(a+2)+": "+s[a];null===t&&(t=$[1]);continue}}for(var L=!1,T=!1,A=!1,F=y,I=!1,N=!1,q=0;q<o.length;q++){var C=T||L||I,z=o[q];if("\\"==z&&q<o.length-1&&" "!==o[q+1])q++;else{switch(z){case"#":T||L||I||(o=o.slice(0,q));break;case'"':if(q<=o.length-3&&'"'==o[q+1]&&'"'==o[q+2]){if(I&&q<=o.length-4&&'"'==o[q+3])break;I=!I,N=!0,q+=2}else I||T||(L=!L);break;case"'":if(q<=o.length-3&&"'"==o[q+1]&&"'"==o[q+2]){if(I&&q<=o.length-4&&"'"==o[q+3])break;I=!I,N=!0,q+=2}else I||L||(T=!T)}if(I&&q==o.length-1&&a<s.length-1&&(a++,o+="\n"+s[a]),T||L||I){if(q<o.length-1)continue;if(a===s.length-1){var W="single";return W=L?"double":"triple","ERROR: Unbalanced "+W+" quotes"}}switch(z){case":":1==p&&(R=!0);break;case"(":if(q>0&&"\\"==o[q-1])break;0===p&&(u=a),p++;break;case")":if(q>0&&"\\"==o[q-1])break;p--,R&&0==p&&(R=!1);break;case"[":if(q>0&&"\\"==o[q-1])break;0===v&&(h=a),v++;break;case"]":if(q>0&&"\\"==o[q-1])break;v--;break;case"{":if(q>0&&"\\"==o[q-1])break;0===g&&(d=a),g++;break;case"}":if(q>0&&"\\"==o[q-1])break;g--}if("\\"==z){q!=o.length-1&&" "!=o[q+1]&&"#"!=o[q+1]||(o=o.slice(0,q)),A=!0;break}}}if(y=!R&&(A||p>0||v>0||g>0),"vpython"==i&&!C){var c=E.exec(o+" ");if(c&&"("!=c[2]&&0!=c[2].search(/\w/)){var q=c.index;o=o.slice(0,q)+".pick()"+o.slice(q+5)}if(!N)if(o=o.replace(/global/,"nonlocal"),o=o.replace(/\.mouse\.camera/g,".camera.pos"),o.search(O)>=0||o.search(S)>=0)x.push([m.length,w.length]);else{var U=o.length;if(o=e(o),o.length>U)for(;;){var j=x.pop();if(void 0==j)break;for(var B=m.slice(j[0]).search(/:/)+j[0];")"!==m[B];)B--;for(var q=B-1;" "==m[q];)q--;var D;D="("==m[q]?"wait":",wait",m=m.slice(0,B)+D+m.slice(B)}}}if(r="",r=!(w.length<_.length)||")"!=o.charAt(0)&&"else"!=o.substr(0,4)&&("rapydscript"!=i&&"vpython"!=i||"elif"!=o.substr(0,4)&&"except"!=o.substr(0,6)&&"finally"!=o.substr(0,7))?w+k+(a+2)+k+"\n":_+k+(a+2)+k+"\n","rapydscript"!=i&&"vpython"!=i||(w.length!=_.length||"elif"!=o.substr(0,4)&&"else"!=o.substr(0,4)?'"""'!=o.substr(0,3)&&"'''"!=o.substr(0,3)&&")"!=o[0]||(r=""):r=""),"rapydscript"==i||"vpython"==i?F?(m=m.slice(0,-1)+w+o+"\n",w=_):""==r?m+="  "+w+o+"\n":f.length>0?(m+="  "+r+"  "+w+f+"\n",m+="  "+w+o+"\n"):m+="  "+r+"  "+w+o+"\n":m+=r+s[a]+"\n",_=w,0>p)return"ERROR: Too many right parentheses, line "+(a+2)+": "+s[a];if(0>v)return"ERROR: Too many right brackets, line "+(a+2)+": "+s[a];if(0>g)return"ERROR: Too many right braces, line "+(a+2)+": "+s[a]}}return p>0?"ERROR: Missing right parenthesis, see line "+(u+2)+": "+s[u]:v>0?"ERROR: Missing right bracket, see line "+(h+2)+": "+s[h]:g>0?"ERROR: Missing right brace, see line "+(d+2)+": "+s[d]:m}function i(e){if("ERROR: "==e.slice(0,7))throw new Error(e.slice(7));var n=OutputStream(f);e+="\n";try{var i=parse(e,c);return i.print(n),n.toString()}catch(r){if(void 0===r.line)throw new Error(r.message);var a=e.split("\n"),t=a[r.line],l=t.match(o);throw null!==l?new Error(r.message+"; line "+l[1]+": "+a[r.line+1]):new Error(r.message+": "+a[r.line])}}function r(){var e;e=navigator.onLine?"https://s3.amazonaws.com/glowscript/fonts/Roboto-Medium.ttf":"../lib/FilesInAWS/Roboto-Medium.ttf",opentype.load(e,function(n,i){if(n)throw new Error("Font "+e+" could not be loaded: "+n);window.__font_sans=i});var n;n=navigator.onLine?"https://s3.amazonaws.com/glowscript/fonts/NimbusRomNo9L-Med.otf":"../lib/FilesInAWS/NimbusRomNo9L-Med.otf",opentype.load(n,function(e,i){if(e)throw new Error("Font "+n+" could not be loaded: "+e);window.__font_serif=i})}function a(e,a){a=a||{};var s=a.wait||"wait";window.__original={text:e.split("\n")},window.__GSlang=a.lang;var o='["'+a.version+'", "glowscript"]',c=/[^\.\w]text[\ ]*\(/,f=/^text[\ ]*\(/,g=c.exec(e);if(g||(g=f.exec(e)),g&&r(),e=e.replace(/\.delete/g,".remove"),"rapydscript"==a.lang||"vpython"==a.lang)if(e=n(e,a.lang),"ERROR: "==e.slice(0,7))i(e);else{var u;if("rapydscript"==a.lang)u="def main("+s+"):\n  version = "+o+"\n  window.__GSlang = 'rapydscript'\n  scene = canvas()\n  arange=range\n  _$rapyd$_Temp = 0\n  _$rapyd$_print = GSprint\n"+e+"main";else{if(u="def main("+s+"):\n  version = "+o+"\n",null===t){u+="  window.__GSlang = 'vpython'\n";for(var h=0;h<p.length;h++)u+="  "+p[h]+"=vp_"+p[h]+"\n";u+="  display=canvas\n  vector=vec\n"}else if(("visual"==t||"vis"==t)&&l.length>0){var d="  window.__GSlang = 'vpython'\n";d+="  vector=vec\n";for(var h=0;h<p.length;h++){var w=p[h],b=l.indexOf(w);d+=b>=0?"  "+w+"=vp_"+w+"\n":"  "+w+"=undefined\n"}for(var m=l.indexOf("vector")>=0,h=0;h<v.length;h++){var w=v[h];if("vec"!=w||!m){var b=l.indexOf(w);b>=0?"display"==w&&(d+="  display=canvas\n"):d+="  "+w+"=undefined\n"}}u+=d}else if(("visual"==t||"vis"==t)&&0==l.length){var _;_="visual"==t?/visual\.(\w+)/g:/vis\.(\w+)/g;var y=e.match(_);_="visual"==t?/visual\.(\w+)/:/vis\.(\w+)/;for(var R={},h=0;h<y.length;h++){var k=_.exec(y[h])[1];k in R||(R[k]=k)}var d="  window.__GSlang = 'vpython'\n",x="";d+="  "+t+"={";for(var h=0;h<p.length;h++){var w=p[h];w in R?d+=w+":vp_"+w+", ":x+="  "+w+"=undefined\n"}for(var h=0;h<v.length;h++){var w=v[h];if(w in R)d+="display"==w&&w in R?"display:canvas, ":"vector"==w?"vector:vec, ":w+":"+w+", ";else{if("vec"==w&&"vector"in R)continue;x+="  "+w+"=undefined\n"}}d=d.slice(0,-2)+"}\n",u+=d,u+=x}u+="  _$rapyd$_Temp=0\n  _$rapyd$_print=GSprint\n  arange=range\n",u+="  scene = canvas()\n",u+=e+"main"}if(e=i(u),"rapydscript"==a.lang||"vpython"==a.lang){var E=e.indexOf("window.__GSlang"),O="Array.prototype['+']=function(r) {return this.concat(r)};\n";e=e.slice(0,E)+O+e.slice(E-4)}}else{var u="function main("+s+") {\n";u+="var version = "+o+";\n",u+="var scene = canvas();\n",e=u+e+"\n};\nmain"}if(g){var S="scene = canvas();\n",G=e.indexOf(S)+S.length;S="    waitforfonts(wait)\n",e=e.slice(0,G)+S+e.slice(G,e.length)}var $=papercompile(e),u=Streamline.transform($,{callback:"wait"});e=u.replace(/\n\n\n\n/g,""),g&&(e="fontloading();\n"+e);var S="wait()",G=e.lastIndexOf(S);return G>-1&&(e=e.slice(0,G)+e.slice(G+S.length,e.length)),e}var t=null,l=[],s=[new RegExp("^rate\\s*\\("),new RegExp("sleep\\s*\\("),new RegExp("^get_library\\s*\\("),new RegExp("\\.waitfor\\s*\\("),new RegExp("\\.pause\\s*\\("),new RegExp("=\\s*read_local_file\\s*\\(")],o=/"(\d*)"/,c={filename:"demo",toplevel:null,basedir:null,libdir:null},f={beautify:!0,private_scope:!1},p=["box","sphere","cylinder","pyramid","cone","helix","ellipsoid","ring","arrow","graph"],v=["display","vec","vector","rate","sleep","update","compound","color","vertex","triangle","quad","label","distant_light","local_light","attach_trail","attach_arrow","sqrt","pi","abs","sin","cos","tan","asin","acos","atan","atan2","exp","log","pow","factorial","combin","radians","degrees","gcurve","gdots","gvbars","ghbars","gdisplay","get_library","read_local_file"];window.glowscript_compile=a}();
function isNumeric(e){return e>=0||0>e&&parseInt(e)===e}function papercompile(e){function r(e){for(var r=0,n=o.length;n>r;r++){var t=o[r];if(t[0]>=e)break;e+=t[1]}return e}function n(n){return e.substring(r(n.range[0]),r(n.range[1]))}function t(n,t){for(var a=r(n.range[0]),i=r(n.range[1]),s=0,c=o.length-1;c>=0;c--)if(a>o[c][0]){s=c+1;break}o.splice(s,0,[a,t.length-i+a]),e=e.substring(0,a)+t+e.substring(i)}function a(e,r){if(e){for(var o in e)if("range"!==o){var i=e[o];if(Array.isArray(i))for(var s=0,c=i.length;c>s;s++)a(i[s],e);else i&&"object"==typeof i&&a(i,e)}var u,l,f;switch(e&&e.type){case"BinaryExpression":e.operator in binaryOperators&&(u=n(e.left),l=n(e.right),f=binaryOperators[e.operator],t(e,u+'["'+e.operator+'"]('+l+")"));break;case"UnaryExpression":e.operator in unaryOperators&&(f=n(e.argument),"-"==e.operator?t(e,f+'["-u"]()'):t(e,f))}}}var o=[];return a(local_acorn.parse(e,{ranges:!0})),e}var binaryOperators={"+":"add","-":"sub","*":"multiply","/":"divide","%":"modulo"},unaryOperators={"-":"negate","+":"plus"},local_acorn={parse:function(){return null}};!function(e,r){return"object"==typeof exports&&"object"==typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):void r(e.local_acorn||(e.local_acorn={}))}(this,function(e){"use strict";function r(e){fe=e||{};for(var r in he)Object.prototype.hasOwnProperty.call(fe,r)||(fe[r]=he[r]);me=fe.sourceFile||null}function n(e,r){var n=ve(pe,e);r+=" ("+n.line+":"+n.column+")";var t=new SyntaxError(r);throw t.pos=e,t.loc=n,t.raisedAt=be,t}function t(e){function r(e){if(1==e.length)return n+="return str === "+JSON.stringify(e[0])+";";n+="switch(str){";for(var r=0;r<e.length;++r)n+="case "+JSON.stringify(e[r])+":";n+="return true}return false;"}e=e.split(" ");var n="",t=[];e:for(var a=0;a<e.length;++a){for(var o=0;o<t.length;++o)if(t[o][0].length==e[a].length){t[o].push(e[a]);continue e}t.push([e[a]])}if(t.length>3){t.sort(function(e,r){return r.length-e.length}),n+="switch(str.length){";for(var a=0;a<t.length;++a){var i=t[a];n+="case "+i[0].length+":",r(i)}n+="}"}else r(e);return new Function("str",n)}function a(){this.line=Ae,this.column=be-Se}function o(){Ae=1,be=Se=0,Ee=!0,u()}function i(e,r){ye=be,fe.locations&&(ke=new a),we=e,u(),Ce=r,Ee=e.beforeExpr}function s(){var e=fe.onComment&&fe.locations&&new a,r=be,t=pe.indexOf("*/",be+=2);if(-1===t&&n(be-2,"Unterminated comment"),be=t+2,fe.locations){Kr.lastIndex=r;for(var o;(o=Kr.exec(pe))&&o.index<be;)++Ae,Se=o.index+o[0].length}fe.onComment&&fe.onComment(!0,pe.slice(r+2,t),r,be,e,fe.locations&&new a)}function c(){for(var e=be,r=fe.onComment&&fe.locations&&new a,n=pe.charCodeAt(be+=2);de>be&&10!==n&&13!==n&&8232!==n&&8329!==n;)++be,n=pe.charCodeAt(be);fe.onComment&&fe.onComment(!1,pe.slice(e+2,be),e,be,r,fe.locations&&new a)}function u(){for(;de>be;){var e=pe.charCodeAt(be);if(32===e)++be;else if(13===e){++be;var r=pe.charCodeAt(be);10===r&&++be,fe.locations&&(++Ae,Se=be)}else if(10===e)++be,++Ae,Se=be;else if(14>e&&e>8)++be;else if(47===e){var r=pe.charCodeAt(be+1);if(42===r)s();else{if(47!==r)break;c()}}else if(160===e)++be;else{if(!(e>=5760&&Wr.test(String.fromCharCode(e))))break;++be}}}function l(){var e=pe.charCodeAt(be+1);return e>=48&&57>=e?E(!0):(++be,i(xr))}function f(){var e=pe.charCodeAt(be+1);return Ee?(++be,k()):61===e?x(Er,2):x(wr,1)}function p(){var e=pe.charCodeAt(be+1);return 61===e?x(Er,2):x(Br,1)}function d(e){var r=pe.charCodeAt(be+1);return r===e?x(124===e?Ur:Lr,2):61===r?x(Er,2):x(124===e?Or:Tr,1)}function m(){var e=pe.charCodeAt(be+1);return 61===e?x(Er,2):x(Rr,1)}function h(e){var r=pe.charCodeAt(be+1);return r===e?x(Sr,2):61===r?x(Er,2):x(Ar,1)}function v(e){var r=pe.charCodeAt(be+1),n=1;return r===e?(n=62===e&&62===pe.charCodeAt(be+2)?3:2,61===pe.charCodeAt(be+n)?x(Er,n+1):x(qr,n)):(61===r&&(n=61===pe.charCodeAt(be+2)?3:2),x(jr,n))}function b(e){var r=pe.charCodeAt(be+1);return 61===r?x(Vr,61===pe.charCodeAt(be+2)?3:2):x(61===e?Cr:Ir,1)}function g(e){switch(e){case 46:return l();case 40:return++be,i(hr);case 41:return++be,i(vr);case 59:return++be,i(gr);case 44:return++be,i(br);case 91:return++be,i(fr);case 93:return++be,i(pr);case 123:return++be,i(dr);case 125:return++be,i(mr);case 58:return++be,i(yr);case 63:return++be,i(kr);case 48:var r=pe.charCodeAt(be+1);if(120===r||88===r)return C();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return E(!1);case 34:case 39:return A(e);case 47:return f(e);case 37:case 42:return p();case 124:case 38:return d(e);case 94:return m();case 43:case 45:return h(e);case 60:case 62:return v(e);case 61:case 33:return b(e);case 126:return x(Ir,1)}return!1}function y(e){if(e?be=ge+1:ge=be,fe.locations&&(xe=new a),e)return k();if(be>=de)return i(De);var r=pe.charCodeAt(be);if(Qr(r)||92===r)return U();var t=g(r);if(t===!1){var o=String.fromCharCode(r);if("\\"===o||Hr.test(o))return U();n(be,"Unexpected character '"+o+"'")}return t}function x(e,r){var n=pe.slice(be,be+r);be+=r,i(e,n)}function k(){for(var e,r,t="",a=be;;){be>=de&&n(a,"Unterminated regular expression");var o=pe.charAt(be);if(Gr.test(o)&&n(a,"Unterminated regular expression"),e)e=!1;else{if("["===o)r=!0;else if("]"===o&&r)r=!1;else if("/"===o&&!r)break;e="\\"===o}++be}var t=pe.slice(a,be);++be;var s=I();return s&&!/^[gmsiy]*$/.test(s)&&n(a,"Invalid regexp flag"),i(qe,new RegExp(t,s))}function w(e,r){for(var n=be,t=0,a=0,o=null==r?1/0:r;o>a;++a){var i,s=pe.charCodeAt(be);if(i=s>=97?s-97+10:s>=65?s-65+10:s>=48&&57>=s?s-48:1/0,i>=e)break;++be,t=t*e+i}return be===n||null!=r&&be-n!==r?null:t}function C(){be+=2;var e=w(16);return null==e&&n(ge+2,"Expected hexadecimal number"),Qr(pe.charCodeAt(be))&&n(be,"Identifier directly after number"),i(je,e)}function E(e){var r=be,t=!1,a=48===pe.charCodeAt(be);e||null!==w(10)||n(r,"Invalid number"),46===pe.charCodeAt(be)&&(++be,w(10),t=!0);var o=pe.charCodeAt(be);(69===o||101===o)&&(o=pe.charCodeAt(++be),(43===o||45===o)&&++be,null===w(10)&&n(r,"Invalid number"),t=!0),Qr(pe.charCodeAt(be))&&n(be,"Identifier directly after number");var s,c=pe.slice(r,be);return t?s=parseFloat(c):a&&1!==c.length?/[89]/.test(c)||Te?n(r,"Invalid number"):s=parseInt(c,8):s=parseInt(c,10),i(je,s)}function A(e){be++;for(var r="";;){be>=de&&n(ge,"Unterminated string constant");var t=pe.charCodeAt(be);if(t===e)return++be,i(Be,r);if(92===t){t=pe.charCodeAt(++be);var a=/^[0-7]+/.exec(pe.slice(be,be+3));for(a&&(a=a[0]);a&&parseInt(a,8)>255;)a=a.slice(0,a.length-1);if("0"===a&&(a=null),++be,a)Te&&n(be-2,"Octal literal in strict mode"),r+=String.fromCharCode(parseInt(a,8)),be+=a.length-1;else switch(t){case 110:r+="\n";break;case 114:r+="\r";break;case 120:r+=String.fromCharCode(S(2));break;case 117:r+=String.fromCharCode(S(4));break;case 85:r+=String.fromCharCode(S(8));break;case 116:r+="	";break;case 98:r+="\b";break;case 118:r+="\x0B";break;case 102:r+="\f";break;case 48:r+="\x00";break;case 13:10===pe.charCodeAt(be)&&++be;case 10:fe.locations&&(Se=be,++Ae);break;default:r+=String.fromCharCode(t)}}else(13===t||10===t||8232===t||8329===t)&&n(ge,"Unterminated string constant"),r+=String.fromCharCode(t),++be}}function S(e){var r=w(16,e);return null===r&&n(ge,"Bad character escape sequence"),r}function I(){Dr=!1;for(var e,r=!0,t=be;;){var a=pe.charCodeAt(be);if(Yr(a))Dr&&(e+=pe.charAt(be)),++be;else{if(92!==a)break;Dr||(e=pe.slice(t,be)),Dr=!0,117!=pe.charCodeAt(++be)&&n(be,"Expecting Unicode escape sequence \\uXXXX"),++be;var o=S(4),i=String.fromCharCode(o);i||n(be-1,"Invalid Unicode escape"),(r?Qr(o):Yr(o))||n(be-4,"Invalid Unicode escape"),e+=i}r=!1}return Dr?e:pe.slice(t,be)}function U(){var e=I(),r=Fe;return Dr||(Xr(e)?r=lr[e]:(fe.forbidReserved&&(3===fe.ecmaVersion?Mr:_r)(e)||Te&&zr(e))&&n(ge,"The keyword '"+e+"' is reserved")),i(r,e)}function L(){Ie=ge,Ue=ye,Le=ke,y()}function O(e){for(Te=e,be=Ue;Se>be;)Se=pe.lastIndexOf("\n",Se-2)+1,--Ae;u(),y()}function R(){this.type=null,this.start=ge,this.end=null}function T(){this.start=xe,this.end=null,null!==me&&(this.source=me)}function V(){var e=new R;return fe.locations&&(e.loc=new T),fe.ranges&&(e.range=[ge,0]),e}function j(e){var r=new R;return r.start=e.start,fe.locations&&(r.loc=new T,r.loc.start=e.loc.start),fe.ranges&&(r.range=[e.range[0],0]),r}function q(e,r){return e.type=r,e.end=Ue,fe.locations&&(e.loc.end=Le),fe.ranges&&(e.range[1]=Ue),e}function B(e){return fe.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function F(e){return we===e?(L(),!0):void 0}function D(){return!fe.strictSemicolons&&(we===De||we===mr||Gr.test(pe.slice(Ue,ge)))}function M(){F(gr)||D()||z()}function _(e){we===e?L():z()}function z(){n(ge,"Unexpected token")}function N(e){"Identifier"!==e.type&&"MemberExpression"!==e.type&&n(e.start,"Assigning to rvalue"),Te&&"Identifier"===e.type&&Nr(e.name)&&n(e.start,"Assigning to "+e.name+" in strict mode")}function X(e){Ie=Ue=be,fe.locations&&(Le=new a),Oe=Te=null,Re=[],y();var r=e||V(),n=!0;for(e||(r.body=[]);we!==De;){var t=W();r.body.push(t),n&&B(t)&&O(!0),n=!1}return q(r,"Program")}function W(){we===wr&&y(!0);var e=we,r=V();switch(e){case Me:case Ne:L();var t=e===Me;F(gr)||D()?r.label=null:we!==Fe?z():(r.label=le(),M());for(var a=0;a<Re.length;++a){var o=Re[a];if(null==r.label||o.name===r.label.name){if(null!=o.kind&&(t||"loop"===o.kind))break;if(r.label&&t)break}}return a===Re.length&&n(r.start,"Unsyntactic "+e.keyword),q(r,t?"BreakStatement":"ContinueStatement");case Xe:return L(),M(),q(r,"DebuggerStatement");case Je:return L(),Re.push(Zr),r.body=W(),Re.pop(),_(nr),r.test=J(),M(),q(r,"DoWhileStatement");case $e:if(L(),Re.push(Zr),_(hr),we===gr)return H(r,null);if(we===rr){var i=V();return L(),G(i,!0),1===i.declarations.length&&F(ur)?$(r,i):H(r,i)}var i=K(!1,!0);return F(ur)?(N(i),$(r,i)):H(r,i);case Ge:return L(),ce(r,!0);case Ke:return L(),r.test=J(),r.consequent=W(),r.alternate=F(Pe)?W():null,q(r,"IfStatement");case Qe:return Oe||n(ge,"'return' outside of function"),L(),F(gr)||D()?r.argument=null:(r.argument=K(),M()),q(r,"ReturnStatement");case Ye:L(),r.discriminant=J(),r.cases=[],_(dr),Re.push(en);for(var s,c;we!=mr;)if(we===_e||we===We){var u=we===_e;s&&q(s,"SwitchCase"),r.cases.push(s=V()),s.consequent=[],L(),u?s.test=K():(c&&n(Ie,"Multiple default clauses"),c=!0,s.test=null),_(yr)}else s||z(),s.consequent.push(W());return s&&q(s,"SwitchCase"),L(),Re.pop(),q(r,"SwitchStatement");case Ze:return L(),Gr.test(pe.slice(Ue,ge))&&n(Ue,"Illegal newline after throw"),r.argument=K(),M(),q(r,"ThrowStatement");case er:if(L(),r.block=P(),r.handler=null,we===ze){var l=V();L(),_(hr),l.param=le(),Te&&Nr(l.param.name)&&n(l.param.start,"Binding "+l.param.name+" in strict mode"),_(vr),l.guard=null,l.body=P(),r.handler=q(l,"CatchClause")}return r.guardedHandlers=Ve,r.finalizer=F(He)?P():null,r.handler||r.finalizer||n(r.start,"Missing catch or finally clause"),q(r,"TryStatement");case rr:return L(),r=G(r),M(),r;case nr:return L(),r.test=J(),Re.push(Zr),r.body=W(),Re.pop(),q(r,"WhileStatement");case tr:return Te&&n(ge,"'with' in strict mode"),L(),r.object=J(),r.body=W(),q(r,"WithStatement");case dr:return P();case gr:return L(),q(r,"EmptyStatement");default:var f=Ce,p=K();if(e===Fe&&"Identifier"===p.type&&F(yr)){for(var a=0;a<Re.length;++a)Re[a].name===f&&n(p.start,"Label '"+f+"' is already declared");var d=we.isLoop?"loop":we===Ye?"switch":null;return Re.push({name:f,kind:d}),r.body=W(),Re.pop(),r.label=p,q(r,"LabeledStatement")}return r.expression=p,M(),q(r,"ExpressionStatement")}}function J(){_(hr);var e=K();return _(vr),e}function P(e){var r,n=V(),t=!0,a=!1;for(n.body=[],_(dr);!F(mr);){var o=W();n.body.push(o),t&&e&&B(o)&&(r=a,O(a=!0)),t=!1}return a&&!r&&O(!1),q(n,"BlockStatement")}function H(e,r){return e.init=r,_(gr),e.test=we===gr?null:K(),_(gr),e.update=we===vr?null:K(),_(vr),e.body=W(),Re.pop(),q(e,"ForStatement")}function $(e,r){return e.left=r,e.right=K(),_(vr),e.body=W(),Re.pop(),q(e,"ForInStatement")}function G(e,r){for(e.declarations=[],e.kind="var";;){var t=V();if(t.id=le(),Te&&Nr(t.id.name)&&n(t.id.start,"Binding "+t.id.name+" in strict mode"),t.init=F(Cr)?K(!0,r):null,e.declarations.push(q(t,"VariableDeclarator")),!F(br))break}return q(e,"VariableDeclaration")}function K(e,r){var n=Q(r);if(!e&&we===br){var t=j(n);for(t.expressions=[n];F(br);)t.expressions.push(Q(r));return q(t,"SequenceExpression")}return n}function Q(e){var r=Y(e);if(we.isAssign){var n=j(r);return n.operator=Ce,n.left=r,L(),n.right=Q(e),N(r),q(n,"AssignmentExpression")}return r}function Y(e){var r=Z(e);if(F(kr)){var n=j(r);return n.test=r,n.consequent=K(!0),_(yr),n.alternate=K(!0,e),q(n,"ConditionalExpression")}return r}function Z(e){return ee(re(),-1,e)}function ee(e,r,n){var t=we.binop;if(null!=t&&(!n||we!==ur)&&t>r){var a=j(e);a.left=e,a.operator=Ce,L(),a.right=ee(re(),t,n);var a=q(a,/&&|\|\|/.test(a.operator)?"LogicalExpression":"BinaryExpression");return ee(a,r,n)}return e}function re(){if(we.prefix){var e=V(),r=we.isUpdate;return e.operator=Ce,e.prefix=!0,L(),e.argument=re(),r?N(e.argument):Te&&"delete"===e.operator&&"Identifier"===e.argument.type&&n(e.start,"Deleting local variable in strict mode"),q(e,r?"UpdateExpression":"UnaryExpression")}for(var t=ne();we.postfix&&!D();){var e=j(t);e.operator=Ce,e.prefix=!1,e.argument=t,N(t),L(),t=q(e,"UpdateExpression")}return t}function ne(){return te(ae())}function te(e,r){if(F(xr)){var n=j(e);return n.object=e,n.property=le(!0),n.computed=!1,te(q(n,"MemberExpression"),r)}if(F(fr)){var n=j(e);return n.object=e,n.property=K(),n.computed=!0,_(pr),te(q(n,"MemberExpression"),r)}if(!r&&F(hr)){var n=j(e);return n.callee=e,n.arguments=ue(vr,!1),te(q(n,"CallExpression"),r)}return e}function ae(){switch(we){case or:var e=V();return L(),q(e,"ThisExpression");case Fe:return le();case je:case Be:case qe:var e=V();return e.value=Ce,e.raw=pe.slice(ge,ye),L(),q(e,"Literal");case ir:case sr:case cr:var e=V();return e.value=we.atomValue,e.raw=we.keyword,L(),q(e,"Literal");case hr:var r=xe,n=ge;L();var t=K();return t.start=n,t.end=ye,fe.locations&&(t.loc.start=r,t.loc.end=ke),fe.ranges&&(t.range=[n,ye]),_(vr),t;case fr:var e=V();return L(),e.elements=ue(pr,!0,!0),q(e,"ArrayExpression");case dr:return ie();case Ge:var e=V();return L(),ce(e,!1);case ar:return oe();default:z()}}function oe(){var e=V();return L(),e.callee=te(ae(),!0),e.arguments=F(hr)?ue(vr,!1):Ve,q(e,"NewExpression")}function ie(){var e=V(),r=!0,t=!1;for(e.properties=[],L();!F(mr);){if(r)r=!1;else if(_(br),fe.allowTrailingCommas&&F(mr))break;var a,o={key:se()},i=!1;if(F(yr)?(o.value=K(!0),a=o.kind="init"):fe.ecmaVersion>=5&&"Identifier"===o.key.type&&("get"===o.key.name||"set"===o.key.name)?(i=t=!0,a=o.kind=o.key.name,o.key=se(),we!==hr&&z(),o.value=ce(V(),!1)):z(),"Identifier"===o.key.type&&(Te||t))for(var s=0;s<e.properties.length;++s){var c=e.properties[s];if(c.key.name===o.key.name){var u=a==c.kind||i&&"init"===c.kind||"init"===a&&("get"===c.kind||"set"===c.kind);u&&!Te&&"init"===a&&"init"===c.kind&&(u=!1),u&&n(o.key.start,"Redefinition of property")}}e.properties.push(o)}return q(e,"ObjectExpression")}function se(){return we===je||we===Be?ae():le(!0)}function ce(e,r){we===Fe?e.id=le():r?z():e.id=null,e.params=[];var t=!0;for(_(hr);!F(vr);)t?t=!1:_(br),e.params.push(le());var a=Oe,o=Re;if(Oe=!0,Re=[],e.body=P(!0),Oe=a,Re=o,Te||e.body.body.length&&B(e.body.body[0]))for(var i=e.id?-1:0;i<e.params.length;++i){var s=0>i?e.id:e.params[i];if((zr(s.name)||Nr(s.name))&&n(s.start,"Defining '"+s.name+"' in strict mode"),i>=0)for(var c=0;i>c;++c)s.name===e.params[c].name&&n(s.start,"Argument name clash in strict mode")}return q(e,r?"FunctionDeclaration":"FunctionExpression")}function ue(e,r,n){for(var t=[],a=!0;!F(e);){if(a)a=!1;else if(_(br),r&&fe.allowTrailingCommas&&F(e))break;n&&we===br?t.push(null):t.push(K(!0))}return t}function le(e){var r=V();return r.name=we===Fe?Ce:e&&!fe.forbidReserved&&we.keyword||z(),L(),q(r,"Identifier")}e.version="0.3.2";var fe,pe,de,me;e.parse=function(e,n){return pe=String(e),de=pe.length,r(n),o(),X(fe.program)};var he=e.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},ve=e.getLineInfo=function(e,r){for(var n=1,t=0;;){Kr.lastIndex=t;var a=Kr.exec(e);if(!(a&&a.index<r))break;++n,t=a.index+a[0].length}return{line:n,column:r-t}};e.tokenize=function(e,n){function t(e){return y(e),a.start=ge,a.end=ye,a.startLoc=xe,a.endLoc=ke,a.type=we,a.value=Ce,a}pe=String(e),de=pe.length,r(n),o();var a={};return t.jumpTo=function(e,r){if(be=e,fe.locations){Ae=1,Se=Kr.lastIndex=0;for(var n;(n=Kr.exec(pe))&&n.index<e;)++Ae,Se=n.index+n[0].length}Ee=r,u()},t};var be,ge,ye,xe,ke,we,Ce,Ee,Ae,Se,Ie,Ue,Le,Oe,Re,Te,Ve=[],je={type:"num"},qe={type:"regexp"},Be={type:"string"},Fe={type:"name"},De={type:"eof"},Me={keyword:"break"},_e={keyword:"case",beforeExpr:!0},ze={keyword:"catch"},Ne={keyword:"continue"},Xe={keyword:"debugger"},We={keyword:"default"},Je={keyword:"do",isLoop:!0},Pe={keyword:"else",beforeExpr:!0},He={keyword:"finally"},$e={keyword:"for",isLoop:!0},Ge={keyword:"function"},Ke={keyword:"if"},Qe={keyword:"return",beforeExpr:!0},Ye={keyword:"switch"},Ze={keyword:"throw",beforeExpr:!0},er={keyword:"try"},rr={keyword:"var"},nr={keyword:"while",isLoop:!0},tr={keyword:"with"},ar={keyword:"new",beforeExpr:!0},or={keyword:"this"},ir={keyword:"null",atomValue:null},sr={keyword:"true",atomValue:!0},cr={keyword:"false",atomValue:!1},ur={keyword:"in",binop:7,beforeExpr:!0},lr={"break":Me,"case":_e,"catch":ze,"continue":Ne,"debugger":Xe,"default":We,"do":Je,"else":Pe,"finally":He,"for":$e,"function":Ge,"if":Ke,"return":Qe,"switch":Ye,"throw":Ze,"try":er,"var":rr,"while":nr,"with":tr,"null":ir,"true":sr,"false":cr,"new":ar,"in":ur,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":or,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},fr={type:"[",beforeExpr:!0},pr={type:"]"},dr={type:"{",beforeExpr:!0},mr={type:"}"},hr={type:"(",beforeExpr:!0},vr={type:")"},br={type:",",beforeExpr:!0},gr={type:";",beforeExpr:!0},yr={type:":",beforeExpr:!0},xr={type:"."},kr={type:"?",beforeExpr:!0},wr={binop:10,beforeExpr:!0},Cr={isAssign:!0,beforeExpr:!0},Er={isAssign:!0,beforeExpr:!0},Ar={binop:9,prefix:!0,beforeExpr:!0},Sr={postfix:!0,prefix:!0,isUpdate:!0},Ir={prefix:!0,beforeExpr:!0},Ur={binop:1,beforeExpr:!0},Lr={binop:2,beforeExpr:!0},Or={binop:3,beforeExpr:!0},Rr={binop:4,beforeExpr:!0},Tr={binop:5,beforeExpr:!0},Vr={binop:6,beforeExpr:!0},jr={binop:7,beforeExpr:!0},qr={binop:8,beforeExpr:!0},Br={binop:10,beforeExpr:!0};e.tokTypes={bracketL:fr,bracketR:pr,braceL:dr,braceR:mr,parenL:hr,parenR:vr,comma:br,semi:gr,colon:yr,dot:xr,question:kr,slash:wr,eq:Cr,name:Fe,eof:De,num:je,regexp:qe,string:Be};for(var Fr in lr)e.tokTypes["_"+Fr]=lr[Fr];var Dr,Mr=t("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),_r=t("class enum extends super const export import"),zr=t("implements interface let package private protected public static yield"),Nr=t("eval arguments"),Xr=t("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Wr=/[\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]/,Jr="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Pr="------------------------------------------------------------------------------------------------------------------------------------------",Hr=new RegExp("["+Jr+"]"),$r=new RegExp("["+Jr+Pr+"]"),Gr=/[\n\r\u2028\u2029]/,Kr=/\r\n|[\n\r\u2028\u2029]/g,Qr=e.isIdentifierStart=function(e){return 65>e?36===e:91>e?!0:97>e?95===e:123>e?!0:e>=170&&Hr.test(String.fromCharCode(e))},Yr=e.isIdentifierChar=function(e){return 48>e?36===e:58>e?!0:65>e?!1:91>e?!0:97>e?95===e:123>e?!0:e>=170&&$r.test(String.fromCharCode(e))},Zr={kind:"loop"},en={kind:"switch"}});
function srequire(e){if("streamline/lib/util/flows"==e)return Streamline.flows;if("streamline/lib/globals"==e)return Streamline.globals;if("streamline/lib/version"==e)return Streamline.version;if("streamline/lib/callbacks/runtime"==e)return Streamline.runtime;if("streamline/lib/callbacks/transform"==e)return Streamline;if("streamline/lib/callbacks/builtins"==e)return Streamline.builtins;if("streamline/lib/util/future"==e)return Streamline.future;if("streamline/lib/util/source-map"==e)return Streamline.sourceMap.exports;throw new Error("Cannot require "+e)}Object.create&&Object.defineProperty&&Object.defineProperties||alert("Example will fail because your browser does not support ECMAScript 5. Try with another browser!");var __filename=""+window.location;if(window.Streamline={globals:{}},function(){var e={options:{version:185},hostGlobal:this};Narcissus=e}(),Narcissus.definitions=function(){function e(e,n,t,r,i){Object.defineProperty(e,n,{get:t,configurable:!r,enumerable:!i})}function n(e,n,t,r,i,a){Object.defineProperty(e,n,{value:t,writable:!i,configurable:!r,enumerable:!a})}function t(e){return"function"==typeof e&&e.toString().match(/\[native code\]/)}function r(e,n){for(;e;){if({}.hasOwnProperty.call(e,n))return Object.getOwnPropertyDescriptor(e,n);e=Object.getPrototypeOf(e)}}function i(e){var n={};for(var t in Object.getOwnPropertyNames(e))n[t]=Object.getOwnPropertyDescriptor(e,t);return n}function a(e){return{getOwnPropertyDescriptor:function(n){var t=Object.getOwnPropertyDescriptor(e,n);return t.configurable=!0,t},getPropertyDescriptor:function(n){var t=r(e,n);return t.configurable=!0,t},getOwnPropertyNames:function(){return Object.getOwnPropertyNames(e)},defineProperty:function(n,t){Object.defineProperty(e,n,t)},"delete":function(n){return delete e[n]},fix:function(){return Object.isFrozen(e)?i(e):void 0},has:function(n){return n in e},hasOwn:function(n){return{}.hasOwnProperty.call(e,n)},get:function(n,t){return e[t]},set:function(n,t,r){return e[t]=r,!0},enumerate:function(){var n=[];for(E in e)n.push(E);return n},keys:function(){return Object.keys(e)}}}function s(){}function o(){this.table=Object.create(null,{}),this.size=0}function c(e){this.elts=e||null}for(var u=["END","\n",";",",","=","?",":","CONDITIONAL","||","&&","|","^","&","==","!=","===","!==","<","<=",">=",">","<<",">>",">>>","+","-","*","/","%","!","~","UNARY_PLUS","UNARY_MINUS","++","--",".","[","]","{","}","(",")","SCRIPT","BLOCK","LABEL","FOR_IN","CALL","NEW_WITH_ARGS","INDEX","ARRAY_INIT","OBJECT_INIT","PROPERTY_INIT","GETTER","SETTER","GROUP","LIST","LET_BLOCK","ARRAY_COMP","GENERATOR","COMP_TAIL","IDENTIFIER","NUMBER","STRING","REGEXP","break","case","catch","const","continue","debugger","default","delete","do","else","false","finally","for","function","if","in","instanceof","let","new","null","return","switch","this","throw","true","try","typeof","var","void","yield","while","with"],l=["break","const","continue","debugger","do","for","if","return","switch","throw","try","var","yield","while","with"],p={"\n":"NEWLINE",";":"SEMICOLON",",":"COMMA","?":"HOOK",":":"COLON","||":"OR","&&":"AND","|":"BITWISE_OR","^":"BITWISE_XOR","&":"BITWISE_AND","===":"STRICT_EQ","==":"EQ","=":"ASSIGN","!==":"STRICT_NE","!=":"NE","<<":"LSH","<=":"LE","<":"LT",">>>":"URSH",">>":"RSH",">=":"GE",">":"GT","++":"INCREMENT","--":"DECREMENT","+":"PLUS","-":"MINUS","*":"MUL","/":"DIV","%":"MOD","!":"NOT","~":"BITWISE_NOT",".":"DOT","[":"LEFT_BRACKET","]":"RIGHT_BRACKET","{":"LEFT_CURLY","}":"RIGHT_CURLY","(":"LEFT_PAREN",")":"RIGHT_PAREN"},f={__proto__:null},d={},_="var ",h=0,m=u.length;m>h;h++){h>0&&(_+=", ");var E,y=u[h];/^[a-z]/.test(y)?(E=y.toUpperCase(),f[y]=h):E=/^\W/.test(y)?p[y]:y,_+=E+" = "+h,d[E]=h,u[y]=h}_+=";";var b={__proto__:null};for(h=0,m=l.length;m>h;h++)b[f[l[h]]]=!0;var v=["|","^","&","<<",">>",">>>","+","-","*","/","%"];for(h=0,m=v.length;m>h;h++)y=v[h],v[y]=u[y];var T={}.hasOwnProperty;return o.prototype={has:function(e){return T.call(this.table,e)},set:function(e,n){T.call(this.table,e)||this.size++,this.table[e]=n},get:function(e){return this.table[e]},getDef:function(e,n){return T.call(this.table,e)||(this.size++,this.table[e]=n()),this.table[e]},forEach:function(e){var n=this.table;for(var t in n)e.call(this,t,n[t])},toString:function(){return"[object StringMap]"}},c.prototype={push:function(e){return new c({top:e,rest:this.elts})},top:function(){if(!this.elts)throw new Error("empty stack");return this.elts.top},isEmpty:function(){return null===this.top},find:function(e){for(var n=this.elts;n;n=n.rest)if(e(n.top))return n.top;return null},has:function(e){return Boolean(this.find(function(n){return n===e}))},forEach:function(e){for(var n=this.elts;n;n=n.rest)e(n.top)}},{tokens:u,opTypeNames:p,keywords:f,isStatementStartCode:b,tokenIds:d,consts:_,assignOps:v,defineGetter:e,defineProperty:n,isNativeCode:t,makePassthruHandler:a,noPropFound:s,StringMap:o,Stack:c}}(),Narcissus.lexer=function(){function Tokenizer(e,n,t){this.cursor=0,this.source=String(e),this.tokens=[],this.tokenIndex=0,this.lookahead=0,this.scanNewlines=!1,this.unexpectedEOF=!1,this.filename=n||"",this.lineno=t||1}var definitions=Narcissus.definitions;eval(definitions.consts);var opTokens={};for(var op in definitions.opTypeNames)if("\n"!==op&&"."!==op)for(var node=opTokens,i=0;i<op.length;i++){var ch=op[i];ch in node||(node[ch]={}),node=node[ch],node.op=op}return Tokenizer.prototype={get done(){return this.peek(!0)===END},get token(){return this.tokens[this.tokenIndex]},match:function(e,n){return this.get(n)===e||this.unget()},mustMatch:function(e){if(!this.match(e))throw this.newSyntaxError("Missing "+definitions.tokens[e].toLowerCase());return this.token},forceIdentifier:function(){if(!this.match(IDENTIFIER)){if(!(this.get()>=definitions.keywords[0]||this.unget))throw this.newSyntaxError("Missing identifier");this.token.type=IDENTIFIER}return this.token},peek:function(e){var n,t;return this.lookahead?(t=this.tokens[this.tokenIndex+this.lookahead&3],n=this.scanNewlines&&t.lineno!==this.lineno?NEWLINE:t.type):(n=this.get(e),this.unget()),n},peekOnSameLine:function(e){this.scanNewlines=!0;var n=this.peek(e);return this.scanNewlines=!1,n},skip:function(){for(var e=this.source;;){var n=e[this.cursor++],t=e[this.cursor];if("\n"!==n||this.scanNewlines){if("/"===n&&"*"===t)for(this.cursor++;;){if(n=e[this.cursor++],void 0===n)throw this.newSyntaxError("Unterminated comment");if("*"===n){if(t=e[this.cursor],"/"===t){this.cursor++;break}}else"\n"===n&&this.lineno++}else if("/"===n&&"/"===t)for(this.cursor++;;){if(n=e[this.cursor++],void 0===n)return;if("\n"===n){this.lineno++;break}}else if(" "!==n&&"	"!==n)return void this.cursor--}else this.lineno++}},lexExponent:function(){var e=this.source,n=e[this.cursor];if("e"===n||"E"===n){if(this.cursor++,ch=e[this.cursor++],"+"!==ch&&"-"!==ch||(ch=e[this.cursor++]),"0">ch||ch>"9")throw this.newSyntaxError("Missing exponent");do ch=e[this.cursor++];while(ch>="0"&&"9">=ch);return this.cursor--,!0}return!1},lexZeroNumber:function(e){var n=this.token,t=this.source;if(n.type=NUMBER,e=t[this.cursor++],"."===e){do e=t[this.cursor++];while(e>="0"&&"9">=e);this.cursor--,this.lexExponent(),n.value=parseFloat(t.substring(n.start,this.cursor))}else if("x"===e||"X"===e){do e=t[this.cursor++];while(e>="0"&&"9">=e||e>="a"&&"f">=e||e>="A"&&"F">=e);this.cursor--,n.value=parseInt(t.substring(n.start,this.cursor))}else if(e>="0"&&"7">=e){do e=t[this.cursor++];while(e>="0"&&"7">=e);this.cursor--,n.value=parseInt(t.substring(n.start,this.cursor),8),n.value.isOctal=!0}else this.cursor--,this.lexExponent(),n.value=0},lexNumber:function(e){var n=this.token,t=this.source;n.type=NUMBER;var r=!1;do e=t[this.cursor++],"."!==e||r||(r=!0,e=t[this.cursor++]);while(e>="0"&&"9">=e);this.cursor--;var i=this.lexExponent();r=r||i;var a=t.substring(n.start,this.cursor);n.value=r?parseFloat(a):parseInt(a)},lexDot:function(e){var n=this.token,t=this.source,r=t[this.cursor];if(r>="0"&&"9">=r){do e=t[this.cursor++];while(e>="0"&&"9">=e);this.cursor--,this.lexExponent(),n.type=NUMBER,n.value=parseFloat(t.substring(n.start,this.cursor))}else n.type=DOT,n.assignOp=null,n.value="."},lexString:function(ch){var token=this.token,input=this.source;token.type=STRING;for(var hasEscapes=!1,delim=ch;(ch=input[this.cursor++])!==delim;){if(this.cursor==input.length)throw this.newSyntaxError("Unterminated string literal");if("\\"===ch&&(hasEscapes=!0,"\n"===input[this.cursor]&&this.lineno++,++this.cursor==input.length))throw this.newSyntaxError("Unterminated string literal")}token.value=hasEscapes?eval(input.substring(token.start,this.cursor)):input.substring(token.start+1,this.cursor-1)},lexRegExp:function(ch){var token=this.token,input=this.source;token.type=REGEXP;do if(ch=input[this.cursor++],"\\"===ch)this.cursor++;else if("["===ch){do{if(void 0===ch)throw this.newSyntaxError("Unterminated character class");"\\"===ch&&this.cursor++,ch=input[this.cursor++]}while("]"!==ch)}else if(void 0===ch)throw this.newSyntaxError("Unterminated regex");while("/"!==ch);do ch=input[this.cursor++];while(ch>="a"&&"z">=ch);this.cursor--,token.value=eval(input.substring(token.start,this.cursor))},lexOp:function(e){var n=this.token,t=this.source,r=opTokens[e],i=t[this.cursor];i in r&&(r=r[i],this.cursor++,i=t[this.cursor],i in r&&(r=r[i],this.cursor++,i=t[this.cursor]));var a=r.op;definitions.assignOps[a]&&"="===t[this.cursor]?(this.cursor++,n.type=ASSIGN,n.assignOp=definitions.tokenIds[definitions.opTypeNames[a]],a+="="):(n.type=definitions.tokenIds[definitions.opTypeNames[a]],n.assignOp=null),n.value=a},lexIdent:function(e){var n=this.token,t=this.source;do e=t[this.cursor++];while(e>="a"&&"z">=e||e>="A"&&"Z">=e||e>="0"&&"9">=e||"$"===e||"_"===e);this.cursor--;var r=t.substring(n.start,this.cursor);n.type=definitions.keywords[r]||IDENTIFIER,n.value=r},get:function(e){for(var n;this.lookahead;)if(--this.lookahead,this.tokenIndex=this.tokenIndex+1&3,n=this.tokens[this.tokenIndex],n.type!==NEWLINE||this.scanNewlines)return n.type;this.skip(),this.tokenIndex=this.tokenIndex+1&3,n=this.tokens[this.tokenIndex],n||(this.tokens[this.tokenIndex]=n={});var t=this.source;if(this.cursor===t.length)return n.type=END;n.start=this.cursor,n.lineno=this.lineno;var r=t[this.cursor++];if(r>="a"&&"z">=r||r>="A"&&"Z">=r||"$"===r||"_"===r)this.lexIdent(r);else if(e&&"/"===r)this.lexRegExp(r);else if(r in opTokens)this.lexOp(r);else if("."===r)this.lexDot(r);else if(r>="1"&&"9">=r)this.lexNumber(r);else if("0"===r)this.lexZeroNumber(r);else if('"'===r||"'"===r)this.lexString(r);else{if(!this.scanNewlines||"\n"!==r)throw this.newSyntaxError("Illegal token");n.type=NEWLINE,n.value="\n",this.lineno++}return n.end=this.cursor,n.type},unget:function(){if(4===++this.lookahead)throw"PANIC: too much lookahead!";this.tokenIndex=this.tokenIndex-1&3},newSyntaxError:function(e){var n=new SyntaxError(this.filename+":"+this.lineno+":"+e);return n.source=this.source,n.cursor=this.lookahead?this.tokens[this.tokenIndex+this.lookahead&3].start:this.cursor,n}},{Tokenizer:Tokenizer}}(),Narcissus.parser=function(){function pushDestructuringVarDecls(e,n){for(var t in e){var r=e[t];r.type===IDENTIFIER?n.varDecls.push(r):pushDestructuringVarDecls(r,n)}}function StaticContext(e,n,t,r,i){this.parentScript=e,this.parentBlock=n,this.inFunction=t,this.inForLoopInit=r,this.nesting=i,this.allLabels=new Stack,this.currentLabels=new Stack,this.labeledTargets=new Stack,this.defaultTarget=null,Narcissus.options.ecma3OnlyMode&&(this.ecma3OnlyMode=!0),Narcissus.options.parenFreeMode&&(this.parenFreeMode=!0)}function Script(e,n){var t=new Node(e,scriptInit()),r=new StaticContext(t,t,n,!1,NESTING_TOP);return Statements(e,r,t),t}function Node(e,n){var t=e.token;t?(this.type=t.type,this.value=t.value,this.lineno=t.lineno,this.start=t.start,this.end=t.end):this.lineno=e.lineno,this.tokenizer=e,this.children=[];for(var r in n)this[r]=n[r]}function tokenString(e){var n=definitions.tokens[e];return/^\W/.test(n)?definitions.opTypeNames[n]:n.toUpperCase()}function blockInit(){return{type:BLOCK,varDecls:[]}}function scriptInit(){return{type:SCRIPT,funDecls:[],varDecls:[],modDecls:[],impDecls:[],expDecls:[],loadDeps:[],hasEmptyReturn:!1,hasReturnWithValue:!1,isGenerator:!1}}function MaybeLeftParen(e,n){return n.parenFreeMode?e.match(LEFT_PAREN)?LEFT_PAREN:END:e.mustMatch(LEFT_PAREN).type}function MaybeRightParen(e,n){n===LEFT_PAREN&&e.mustMatch(RIGHT_PAREN)}function Statements(e,n,t){try{for(;!e.done&&e.peek(!0)!==RIGHT_CURLY;)t.push(Statement(e,n))}catch(r){throw e.done&&(e.unexpectedEOF=!0),r}}function Block(e,n){e.mustMatch(LEFT_CURLY);var t=new Node(e,blockInit());return Statements(e,n.update({parentBlock:t}).pushTarget(t),t),e.mustMatch(RIGHT_CURLY),t.end=e.token.end,t}function Statement(e,n){var t,r,i,a,s,o,c,u,l=e.get(!0);switch(l){case FUNCTION:return FunctionDefinition(e,n,!0,n.nesting!==NESTING_TOP?STATEMENT_FORM:DECLARED_FORM);case LEFT_CURLY:return r=new Node(e,blockInit()),Statements(e,n.update({parentBlock:r}).pushTarget(r).nest(NESTING_SHALLOW),r),e.mustMatch(RIGHT_CURLY),r.end=e.token.end,r;case IF:return r=new Node(e),r.condition=HeadExpression(e,n),c=n.pushTarget(r).nest(NESTING_DEEP),r.thenPart=Statement(e,c),r.elsePart=e.match(ELSE)?Statement(e,c):null,r;case SWITCH:for(r=new Node(e,{cases:[],defaultIndex:-1}),r.discriminant=HeadExpression(e,n),c=n.pushTarget(r).nest(NESTING_DEEP),e.mustMatch(LEFT_CURLY);(l=e.get())!==RIGHT_CURLY;){switch(l){case DEFAULT:if(r.defaultIndex>=0)throw e.newSyntaxError("More than one switch default");case CASE:i=new Node(e),l===DEFAULT?r.defaultIndex=r.cases.length:i.caseLabel=Expression(e,c,COLON);break;default:throw e.newSyntaxError("Invalid switch case")}for(e.mustMatch(COLON),i.statements=new Node(e,blockInit());(l=e.peek(!0))!==CASE&&l!==DEFAULT&&l!==RIGHT_CURLY;)i.statements.push(Statement(e,c));r.cases.push(i)}return r.end=e.token.end,r;case FOR:if(r=new Node(e,LOOP_INIT),e.match(IDENTIFIER)&&("each"===e.token.value?r.isEach=!0:e.unget()),n.parenFreeMode||e.mustMatch(LEFT_PAREN),c=n.pushTarget(r).nest(NESTING_DEEP),u=n.update({inForLoopInit:!0}),(l=e.peek())!==SEMICOLON&&(l===VAR||l===CONST?(e.get(),i=Variables(e,u)):l===LET?(e.get(),e.peek()===LEFT_PAREN?i=LetBlock(e,u,!1):(u.parentBlock=r,r.varDecls=[],i=Variables(e,u))):i=Expression(e,u)),i&&e.match(IN))if(r.type=FOR_IN,r.object=Expression(e,u),i.type===VAR||i.type===LET){if(s=i.children,1!==s.length&&1!==i.destructurings.length)throw new SyntaxError("Invalid for..in left-hand side",e.filename,i.lineno);i.destructurings.length>0?r.iterator=i.destructurings[0]:r.iterator=s[0],r.varDecl=i}else i.type!==ARRAY_INIT&&i.type!==OBJECT_INIT||(i.destructuredNames=checkDestructuring(e,u,i)),r.iterator=i;else{if(r.setup=i,e.mustMatch(SEMICOLON),r.isEach)throw e.newSyntaxError("Invalid for each..in loop");r.condition=e.peek()===SEMICOLON?null:Expression(e,u),e.mustMatch(SEMICOLON),o=e.peek(),r.update=(n.parenFreeMode?o===LEFT_CURLY||definitions.isStatementStartCode[o]:o===RIGHT_PAREN)?null:Expression(e,u)}return n.parenFreeMode||e.mustMatch(RIGHT_PAREN),r.body=Statement(e,c),r.end=e.token.end,r;case WHILE:return r=new Node(e,{isLoop:!0}),r.condition=HeadExpression(e,n),r.body=Statement(e,n.pushTarget(r).nest(NESTING_DEEP)),r.end=e.token.end,r;case DO:if(r=new Node(e,{isLoop:!0}),r.body=Statement(e,n.pushTarget(r).nest(NESTING_DEEP)),e.mustMatch(WHILE),r.condition=HeadExpression(e,n),!n.ecmaStrictMode)return e.match(SEMICOLON),r.end=e.token.end,r;break;case BREAK:case CONTINUE:if(r=new Node(e),c=n.pushTarget(r),e.peekOnSameLine()===IDENTIFIER&&(e.get(),r.label=e.token.value),r.target=r.label?c.labeledTargets.find(function(e){return e.labels.has(r.label)}):c.defaultTarget,!r.target)throw e.newSyntaxError("Invalid "+(l===BREAK?"break":"continue"));if(l===CONTINUE){for(var p=r.target;p&&!p.isLoop;p=p.target);if(!p)throw e.newSyntaxError("Invalid continue")}break;case TRY:for(r=new Node(e,{catchClauses:[]}),r.tryBlock=Block(e,n);e.match(CATCH);){switch(i=new Node(e),a=MaybeLeftParen(e,n),e.get()){case LEFT_BRACKET:case LEFT_CURLY:e.unget(),i.varName=DestructuringExpression(e,n,!0);break;case IDENTIFIER:i.varName=e.token.value;break;default:throw e.newSyntaxError("missing identifier in catch")}if(e.match(IF)){if(n.ecma3OnlyMode)throw e.newSyntaxError("Illegal catch guard");if(r.catchClauses.length&&!r.catchClauses.top().guard)throw e.newSyntaxError("Guarded catch after unguarded");i.guard=Expression(e,n)}MaybeRightParen(e,a),i.block=Block(e,n),r.catchClauses.push(i)}if(e.match(FINALLY)&&(r.finallyBlock=Block(e,n)),!r.catchClauses.length&&!r.finallyBlock)throw e.newSyntaxError("Invalid try statement");return r.end=e.token.end,r;case CATCH:case FINALLY:throw e.newSyntaxError(definitions.tokens[l]+" without preceding try");case THROW:r=new Node(e),r.exception=Expression(e,n);break;case RETURN:r=ReturnOrYield(e,n);break;case WITH:return r=new Node(e),r.object=HeadExpression(e,n),r.body=Statement(e,n.pushTarget(r).nest(NESTING_DEEP)),r.end=e.token.end,r;case VAR:case CONST:r=Variables(e,n),r.eligibleForASI=!0;break;case LET:r=e.peek()===LEFT_PAREN?LetBlock(e,n,!0):Variables(e,n),r.eligibleForASI=!0;break;case DEBUGGER:r=new Node(e);break;case NEWLINE:case SEMICOLON:return r=new Node(e,{type:SEMICOLON}),r.expression=null,r;default:if(l===IDENTIFIER&&(l=e.peek(),l===COLON)){if(t=e.token.value,n.allLabels.has(t))throw e.newSyntaxError("Duplicate label");return e.get(),r=new Node(e,{type:LABEL,label:t}),r.statement=Statement(e,n.pushLabel(t).nest(NESTING_SHALLOW)),r.target=r.statement.type===LABEL?r.statement.target:r.statement,r.end=e.token.end,r}r=new Node(e,{type:SEMICOLON}),e.unget(),r.expression=Expression(e,n),r.end=r.expression.end}return MagicalSemicolon(e),r.end=e.token.end,r}function MagicalSemicolon(e){var n;if(e.lineno===e.token.lineno&&(n=e.peekOnSameLine(),n!==END&&n!==NEWLINE&&n!==SEMICOLON&&n!==RIGHT_CURLY))throw e.newSyntaxError("missing ; before statement");e.match(SEMICOLON)}function ReturnOrYield(e,n){var t,r,i=e.token.type,a=n.parentScript;if(i===RETURN);else{if(!n.inFunction)throw e.newSyntaxError("Yield not in function");a.isGenerator=!0}if(t=new Node(e,{value:void 0}),r=e.peek(!0),r!==END&&r!==NEWLINE&&r!==SEMICOLON&&r!==RIGHT_CURLY&&(i!==YIELD||r!==i&&r!==RIGHT_BRACKET&&r!==RIGHT_PAREN&&r!==COLON&&r!==COMMA)?i===RETURN?(t.value=Expression(e,n),a.hasReturnWithValue=!0):t.value=AssignExpression(e,n):i===RETURN&&(a.hasEmptyReturn=!0),a.hasReturnWithValue&&a.isGenerator)throw e.newSyntaxError("Generator returns a value");return t}function FunctionDefinition(e,n,t,r){var i,a=new Node(e,{params:[]});if(a.type!==FUNCTION&&(a.type="get"===a.value?GETTER:SETTER),e.match(IDENTIFIER))a.name=e.token.value;else if(t)throw e.newSyntaxError("missing function identifier");var s=new StaticContext(null,null,!0,!1,NESTING_TOP);if(e.mustMatch(LEFT_PAREN),!e.match(RIGHT_PAREN)){do switch(e.get()){case LEFT_BRACKET:case LEFT_CURLY:e.unget(),a.params.push(DestructuringExpression(e,s));break;case IDENTIFIER:a.params.push(e.token.value);break;default:throw e.newSyntaxError("missing formal parameter")}while(e.match(COMMA));e.mustMatch(RIGHT_PAREN)}if(i=e.get(),i!==LEFT_CURLY&&e.unget(),i!==LEFT_CURLY){if(a.body=AssignExpression(e,s),a.body.isGenerator)throw e.newSyntaxError("Generator returns a value")}else a.body=Script(e,!0);return i===LEFT_CURLY&&e.mustMatch(RIGHT_CURLY),a.end=e.token.end,a.functionForm=r,r===DECLARED_FORM&&n.parentScript.funDecls.push(a),a}function Variables(e,n,t){var r,i,a,s;switch(s=e.token.type){case VAR:case CONST:a=n.parentScript;break;case LET:a=n.parentBlock;break;case LEFT_PAREN:s=LET,a=t}r=new Node(e,{type:s,destructurings:[]});do if(s=e.get(),s!==LEFT_BRACKET&&s!==LEFT_CURLY){if(s!==IDENTIFIER)throw e.newSyntaxError("missing variable name");if(i=new Node(e,{type:IDENTIFIER,name:e.token.value,readOnly:r.type===CONST}),r.push(i),a.varDecls.push(i),e.match(ASSIGN)){if(e.token.assignOp)throw e.newSyntaxError("Invalid variable initialization");i.initializer=AssignExpression(e,n)}}else{e.unget();var o=DestructuringExpression(e,n,!0);if(i=new Node(e,{type:IDENTIFIER,name:o,readOnly:r.type===CONST}),r.push(i),pushDestructuringVarDecls(i.name.destructuredNames,a),r.destructurings.push({exp:o,decl:i}),n.inForLoopInit&&e.peek()===IN)continue;if(e.mustMatch(ASSIGN),e.token.assignOp)throw e.newSyntaxError("Invalid variable initialization");i.initializer=AssignExpression(e,n)}while(e.match(COMMA));return r.end=e.token.end,r}function LetBlock(e,n,t){var r,i;return r=new Node(e,{type:LET_BLOCK,varDecls:[]}),e.mustMatch(LEFT_PAREN),r.variables=Variables(e,n,r),e.mustMatch(RIGHT_PAREN),t&&e.peek()!==LEFT_CURLY&&(i=new Node(e,{type:SEMICOLON,expression:r}),t=!1),t?r.block=Block(e,n):r.expression=AssignExpression(e,n),r}function checkDestructuring(e,n,t,r){if(t.type===ARRAY_COMP)throw e.newSyntaxError("Invalid array comprehension left-hand side");if(t.type===ARRAY_INIT||t.type===OBJECT_INIT){for(var i,a,s,o,c={},u=t.children,l=0,p=u.length;p>l;l++)if(i=u[l])if(i.type===PROPERTY_INIT?(o=i.children,s=o[1],a=o[0].value):t.type===OBJECT_INIT?(s=i,a=i.value):(s=i,a=l),s.type===ARRAY_INIT||s.type===OBJECT_INIT)c[a]=checkDestructuring(e,n,s,r);else{if(r&&s.type!==IDENTIFIER)throw e.newSyntaxError("missing name in pattern");c[a]=s}return c}}function DestructuringExpression(e,n,t){var r=PrimaryExpression(e,n);return r.destructuredNames=checkDestructuring(e,n,r,t),r}function GeneratorExpression(e,n,t){return new Node(e,{type:GENERATOR,expression:t,tail:ComprehensionTail(e,n)})}function ComprehensionTail(e,n){var t,r,i,a,s;t=new Node(e,{type:COMP_TAIL});do{switch(r=new Node(e,{type:FOR_IN,isLoop:!0}),e.match(IDENTIFIER)&&("each"===e.token.value?r.isEach=!0:e.unget()),s=MaybeLeftParen(e,n),e.get()){case LEFT_BRACKET:case LEFT_CURLY:e.unget(),r.iterator=DestructuringExpression(e,n);break;case IDENTIFIER:r.iterator=a=new Node(e,{type:IDENTIFIER}),a.name=a.value,r.varDecl=i=new Node(e,{type:VAR}),i.push(a),n.parentScript.varDecls.push(a);break;default:throw e.newSyntaxError("missing identifier")}e.mustMatch(IN),r.object=Expression(e,n),MaybeRightParen(e,s),t.push(r)}while(e.match(FOR));return e.match(IF)&&(t.guard=HeadExpression(e,n)),t}function HeadExpression(e,n){var t=MaybeLeftParen(e,n),r=ParenExpression(e,n);if(MaybeRightParen(e,t),t===END&&!r.parenthesized){var i=e.peek();if(i!==LEFT_CURLY&&!definitions.isStatementStartCode[i])throw e.newSyntaxError("Unparenthesized head followed by unbraced body")}return r}function ParenExpression(e,n){var t=Expression(e,n.update({inForLoopInit:n.inForLoopInit&&e.token.type===LEFT_PAREN}));if(e.match(FOR)){if(t.type===YIELD&&!t.parenthesized)throw e.newSyntaxError("Yield expression must be parenthesized");if(t.type===COMMA&&!t.parenthesized)throw e.newSyntaxError("Generator expression must be parenthesized");t=GeneratorExpression(e,n,t)}return t}function Expression(e,n){var t,r;if(t=AssignExpression(e,n),e.match(COMMA)){r=new Node(e,{type:COMMA}),r.push(t),t=r;do{if(r=t.children[t.children.length-1],r.type===YIELD&&!r.parenthesized)throw e.newSyntaxError("Yield expression must be parenthesized");t.push(AssignExpression(e,n))}while(e.match(COMMA))}return t}function AssignExpression(e,n){var t,r;if(e.match(YIELD,!0))return ReturnOrYield(e,n);if(t=new Node(e,{type:ASSIGN}),r=ConditionalExpression(e,n),!e.match(ASSIGN))return r;switch(r.type){case OBJECT_INIT:case ARRAY_INIT:r.destructuredNames=checkDestructuring(e,n,r);case IDENTIFIER:case DOT:case INDEX:case CALL:break;default:throw e.newSyntaxError("Bad left-hand side of assignment")}return t.assignOp=e.token.assignOp,t.push(r),t.push(AssignExpression(e,n)),t}function ConditionalExpression(e,n){var t,r;if(t=OrExpression(e,n),e.match(HOOK)){if(r=t,t=new Node(e,{type:HOOK}),t.push(r),t.push(AssignExpression(e,n.update({inForLoopInit:!1}))),!e.match(COLON))throw e.newSyntaxError("missing : after ?");t.push(AssignExpression(e,n))}return t}function OrExpression(e,n){var t,r;for(t=AndExpression(e,n);e.match(OR);)r=new Node(e),r.push(t),r.push(AndExpression(e,n)),t=r;return t}function AndExpression(e,n){var t,r;for(t=BitwiseOrExpression(e,n);e.match(AND);)r=new Node(e),r.push(t),r.push(BitwiseOrExpression(e,n)),t=r;return t}function BitwiseOrExpression(e,n){var t,r;for(t=BitwiseXorExpression(e,n);e.match(BITWISE_OR);)r=new Node(e),r.push(t),r.push(BitwiseXorExpression(e,n)),t=r;return t}function BitwiseXorExpression(e,n){var t,r;for(t=BitwiseAndExpression(e,n);e.match(BITWISE_XOR);)r=new Node(e),r.push(t),r.push(BitwiseAndExpression(e,n)),t=r;return t}function BitwiseAndExpression(e,n){var t,r;for(t=EqualityExpression(e,n);e.match(BITWISE_AND);)r=new Node(e),r.push(t),r.push(EqualityExpression(e,n)),t=r;return t}function EqualityExpression(e,n){var t,r;for(t=RelationalExpression(e,n);e.match(EQ)||e.match(NE)||e.match(STRICT_EQ)||e.match(STRICT_NE);)r=new Node(e),r.push(t),r.push(RelationalExpression(e,n)),t=r;return t}function RelationalExpression(e,n){var t,r,i=n.update({inForLoopInit:!1});for(t=ShiftExpression(e,i);e.match(LT)||e.match(LE)||e.match(GE)||e.match(GT)||!n.inForLoopInit&&e.match(IN)||e.match(INSTANCEOF);)r=new Node(e),r.push(t),r.push(ShiftExpression(e,i)),t=r;return t}function ShiftExpression(e,n){var t,r;for(t=AddExpression(e,n);e.match(LSH)||e.match(RSH)||e.match(URSH);)r=new Node(e),r.push(t),r.push(AddExpression(e,n)),t=r;return t}function AddExpression(e,n){var t,r;for(t=MultiplyExpression(e,n);e.match(PLUS)||e.match(MINUS);)r=new Node(e),r.push(t),r.push(MultiplyExpression(e,n)),t=r;return t}function MultiplyExpression(e,n){var t,r;for(t=UnaryExpression(e,n);e.match(MUL)||e.match(DIV)||e.match(MOD);)r=new Node(e),r.push(t),r.push(UnaryExpression(e,n)),t=r;return t}function UnaryExpression(e,n){var t,r,i;switch(i=e.get(!0)){case DELETE:case VOID:case TYPEOF:case NOT:case BITWISE_NOT:case PLUS:case MINUS:t=i===PLUS?new Node(e,{type:UNARY_PLUS}):i===MINUS?new Node(e,{type:UNARY_MINUS}):new Node(e),t.push(UnaryExpression(e,n));break;case INCREMENT:case DECREMENT:t=new Node(e),t.push(MemberExpression(e,n,!0));break;default:e.unget(),t=MemberExpression(e,n,!0),e.tokens[e.tokenIndex+e.lookahead-1&3].lineno===e.lineno&&(e.match(INCREMENT)||e.match(DECREMENT))&&(r=new Node(e,{postfix:!0}),r.push(t),t=r)}return t}function MemberExpression(e,n,t){var r,i,a;for(e.match(NEW)?(r=new Node(e),r.push(MemberExpression(e,n,!1)),e.match(LEFT_PAREN)&&(r.type=NEW_WITH_ARGS,r.push(ArgumentList(e,n)))):r=PrimaryExpression(e,n);(a=e.get())!==END;){switch(a){case DOT:i=new Node(e),i.push(r),e.forceIdentifier(),i.push(new Node(e));break;case LEFT_BRACKET:i=new Node(e,{type:INDEX}),i.push(r),i.push(Expression(e,n)),e.mustMatch(RIGHT_BRACKET),i.end=e.token.end;break;case LEFT_PAREN:if(t){i=new Node(e,{type:CALL}),i.push(r),i.push(ArgumentList(e,n));break}default:return e.unget(),r}r=i}return r}function ArgumentList(e,n){var t,r;if(t=new Node(e,{type:LIST}),e.match(RIGHT_PAREN,!0))return t.end=e.token.end,t;do{if(r=AssignExpression(e,n),r.type===YIELD&&!r.parenthesized&&e.peek()===COMMA)throw e.newSyntaxError("Yield expression must be parenthesized");if(e.match(FOR)&&(r=GeneratorExpression(e,n,r),t.children.length>1||e.peek(!0)===COMMA))throw e.newSyntaxError("Generator expression must be parenthesized");t.push(r)}while(e.match(COMMA));return e.mustMatch(RIGHT_PAREN),t.end=e.token.end,t}function PrimaryExpression(e,n){var t,r,i=e.get(!0);switch(i){case FUNCTION:t=FunctionDefinition(e,n,!1,EXPRESSED_FORM);break;case LEFT_BRACKET:for(t=new Node(e,{type:ARRAY_INIT});(i=e.peek(!0))!==RIGHT_BRACKET;)if(i!==COMMA){if(t.push(AssignExpression(e,n)),i!==COMMA&&!e.match(COMMA))break}else e.get(),t.push(null);1===t.children.length&&e.match(FOR)&&(r=new Node(e,{type:ARRAY_COMP,expression:t.children[0],tail:ComprehensionTail(e,n)}),t=r),e.mustMatch(RIGHT_BRACKET),t.end=e.token.end;break;case LEFT_CURLY:var a;t=new Node(e,{type:OBJECT_INIT});e:if(!e.match(RIGHT_CURLY)){do if(i=e.get(),"get"!==e.token.value&&"set"!==e.token.value||e.peek()!==IDENTIFIER){switch(i){case IDENTIFIER:case NUMBER:case STRING:a=new Node(e,{type:IDENTIFIER});break;case RIGHT_CURLY:if(n.ecma3OnlyMode)throw e.newSyntaxError("Illegal trailing ,");break e;default:if(e.token.value in definitions.keywords){a=new Node(e,{type:IDENTIFIER});break}throw e.newSyntaxError("Invalid property name")}if(e.match(COLON))r=new Node(e,{type:PROPERTY_INIT}),r.push(a),r.push(AssignExpression(e,n)),t.push(r);else{if(e.peek()!==COMMA&&e.peek()!==RIGHT_CURLY)throw e.newSyntaxError("missing : after property");t.push(a)}}else{if(n.ecma3OnlyMode)throw e.newSyntaxError("Illegal property accessor");t.push(FunctionDefinition(e,n,!0,EXPRESSED_FORM))}while(e.match(COMMA));e.mustMatch(RIGHT_CURLY)}t.end=e.token.end;break;case LEFT_PAREN:var s=e.token.start;t=ParenExpression(e,n),e.mustMatch(RIGHT_PAREN),t.start=s,t.end=e.token.end,t.parenthesized=!0;break;case LET:t=LetBlock(e,n,!1);break;case NULL:case THIS:case TRUE:case FALSE:case IDENTIFIER:case NUMBER:case STRING:case REGEXP:t=new Node(e);break;default:throw e.newSyntaxError("missing operand")}return t}function parse(e,n,t){var r=new lexer.Tokenizer(e,n,t),i=Script(r,!1);if(!r.done)throw r.newSyntaxError("Syntax error");return i}function parseStdin(e,n){for(;;)try{var t=new lexer.Tokenizer(e,"stdin",n.value),r=Script(t,!1);return n.value=t.lineno,r}catch(i){if(!t.unexpectedEOF)throw i;var a=readline();if(!a)throw i;e+="\n"+a}}var lexer=Narcissus.lexer,definitions=Narcissus.definitions;const StringMap=definitions.StringMap,Stack=definitions.Stack;eval(definitions.consts);const NESTING_TOP=0,NESTING_SHALLOW=1,NESTING_DEEP=2;StaticContext.prototype={ecma3OnlyMode:!1,parenFreeMode:!1,update:function(e){var n={};for(var t in e)n[t]={value:e[t],writable:!0,enumerable:!0,configurable:!0};return Object.create(this,n)},pushLabel:function(e){return this.update({currentLabels:this.currentLabels.push(e),allLabels:this.allLabels.push(e)})},pushTarget:function(e){var n=e.isLoop||e.type===SWITCH;return n&&(e.target=this.defaultTarget),this.currentLabels.isEmpty()?n?this.update({defaultTarget:e}):this:(e.labels=new StringMap,this.currentLabels.forEach(function(n){e.labels.set(n,!0)}),this.update({currentLabels:new Stack,labeledTargets:this.labeledTargets.push(e),defaultTarget:n?e:this.defaultTarget}))},nest:function(e){var n=Math.max(this.nesting,e);return n!==this.nesting?this.update({nesting:n}):this}},definitions.defineProperty(Array.prototype,"top",function(){return this.length&&this[this.length-1]},!1,!1,!0);var Np=Node.prototype={};Np.constructor=Node,Np.toSource=Object.prototype.toSource,Np.push=function(e){return null!==e&&(e.start<this.start&&(this.start=e.start),this.end<e.end&&(this.end=e.end)),this.children.push(e)},Node.indentLevel=0,Np.toString=function(){var e=[];for(var n in this)this.hasOwnProperty(n)&&"type"!==n&&"target"!==n&&e.push({id:n,value:this[n]});e.sort(function(e,n){return e.id<n.id?-1:1});const t="    ";var r=++Node.indentLevel,i="{\n"+t.repeat(r)+"type: "+tokenString(this.type);for(n=0;n<e.length;n++)i+=", "+e[n].id+": "+e[n].value;return r=--Node.indentLevel,i+="\n"+t.repeat(r)+"}"},Np.getSource=function(){return this.tokenizer.source.slice(this.start,this.end)};const LOOP_INIT={isLoop:!0};definitions.defineGetter(Np,"filename",function(){return this.tokenizer.filename}),definitions.defineGetter(Np,"length",function(){throw new Error("Node.prototype.length is gone; use n.children.length instead")}),definitions.defineProperty(String.prototype,"repeat",function(e){for(var n="",t=this+n;--e>=0;)n+=t;return n},!1,!1,!0);const DECLARED_FORM=0,EXPRESSED_FORM=1,STATEMENT_FORM=2;return{parse:parse,parseStdin:parseStdin,Node:Node,DECLARED_FORM:DECLARED_FORM,EXPRESSED_FORM:EXPRESSED_FORM,STATEMENT_FORM:STATEMENT_FORM,Tokenizer:lexer.Tokenizer,FunctionDefinition:FunctionDefinition}}(),Narcissus.decompiler=function(){function indent(e,n){for(var t="",r=!0,i=0,a=n.length;a>i;i++){if(r)for(var s=0;e>s;s++)t+=" ";t+=n[i],r="\n"===n[i]}return t}function isBlock(e){return e&&e.type===BLOCK}function isNonEmptyBlock(e){
return isBlock(e)&&e.children.length>0}function nodeStr(e){return'"'+e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}function pp(e,n,t){var r=!1;if(!e)return"";if(!(e instanceof Object))return e;n||(r=!0,n=1);var i="";switch(e.parenthesized&&(i+="("),e.type){case FUNCTION:case GETTER:case SETTER:i+=e.type===FUNCTION?"function":e.type===GETTER?"get":"set",i+=(e.name?" "+e.name:"")+"(";for(var a=0,s=e.params.length;s>a;a++)i+=(a>0?", ":"")+pp(e.params[a],n);i+=") "+pp(e.body,n);break;case SCRIPT:case BLOCK:var o=e.children;if(r){for(var a=0,s=o.length;s>a;a++){a>0&&(i+="\n"),i+=pp(o[a],n);var c=i[i.length-1];";"!=c&&(i+=";")}break}i+="{",void 0!==e.id&&(i+=" /* "+e.id+" */"),i+="\n";for(var a=0,s=o.length;s>a;a++){a>0&&(i+="\n"),i+=indent(4,pp(o[a],n));var c=i[i.length-1];";"!=c&&(i+=";")}i+="\n}";break;case LET_BLOCK:i+="let ("+pp(e.variables,n,!0)+") ",i+=e.expression?pp(e.expression,n):pp(e.block,n);break;case IF:i+="if ("+pp(e.condition,n)+") ";var u=e.thenPart,l=e.elsePart,p=isBlock(u)||isBlock(l);p||(i+="{\n"),i+=(p?pp(u,n):indent(4,pp(u,n)))+"\n",l&&(i+=p?" else ":"} else {\n",i+=(p?pp(l,n):indent(4,pp(l,n)))+"\n"),p||(i+="}");break;case SWITCH:i+="switch ("+pp(e.discriminant,n)+") {\n";for(var a=0,s=e.cases.length;s>a;a++){var f=e.cases[a];i+=f.type===CASE?"  case "+pp(f.caseLabel,n)+":\n":"  default:\n",ps=pp(f.statements,n),i+=ps.slice(2,ps.length-2)+"\n"}i+="}";break;case FOR:i+="for ("+pp(e.setup,n)+"; "+pp(e.condition,n)+"; "+pp(e.update,n)+") ";var d=pp(e.body,n);isBlock(e.body)?e.body&&(i+=d):i+="{\n"+indent(4,d)+";\n}";break;case WHILE:i+="while ("+pp(e.condition,n)+") ";var d=pp(e.body,n);i+=isBlock(e.body)?d:"{\n"+indent(4,d)+";\n}";break;case FOR_IN:var _=e.varDecl;i+=e.isEach?"for each (":"for (",i+=(_?pp(_,n):pp(e.iterator,n))+" in "+pp(e.object,n)+") ";var d=pp(e.body,n);isBlock(e.body)?e.body&&(i+=d):i+="{\n"+indent(4,d)+";\n}";break;case DO:i+="do "+pp(e.body,n),i+=" while ("+pp(e.condition,n)+");";break;case BREAK:i+="break"+(e.label?" "+e.label:"")+";";break;case CONTINUE:i+="continue"+(e.label?" "+e.label:"")+";";break;case TRY:i+="try ",i+=pp(e.tryBlock,n);for(var a=0,s=e.catchClauses.length;s>a;a++){var h=e.catchClauses[a];i+=" catch ("+pp(h.varName,n)+(h.guard?" if "+pp(h.guard,n):"")+") ",i+=pp(h.block,n)}e.finallyBlock&&(i+=" finally ",i+=pp(e.finallyBlock,n));break;case THROW:i+="throw "+pp(e.exception,n);break;case RETURN:i+="return",e.value&&(i+=" "+pp(e.value,n));break;case YIELD:i+="yield",e.value.type&&(i+=" "+pp(e.value,n));break;case GENERATOR:i+=pp(e.expression,n)+" "+pp(e.tail,n);break;case WITH:i+="with ("+pp(e.object,n)+") ",i+=pp(e.body,n);break;case LET:case VAR:case CONST:var o=e.children;t||(i+=tokens[e.type]+" ");for(var a=0,s=o.length;s>a;a++){a>0&&(i+=", ");var _=o[a];i+=pp(_.name,n),_.initializer&&(i+=" = "+pp(_.initializer,n))}break;case DEBUGGER:i+="debugger\n";break;case SEMICOLON:e.expression&&(i+=pp(e.expression,n)+";");break;case LABEL:i+=e.label+":\n"+pp(e.statement,n);break;case COMMA:case LIST:for(var o=e.children,a=0,s=o.length;s>a;a++)a>0&&(i+=", "),i+=pp(o[a],n);break;case ASSIGN:var o=e.children,h=e.assignOp;i+=pp(o[0],n)+" "+(h?tokens[h]:"")+"= "+pp(o[1],n);break;case HOOK:var o=e.children;i+="("+pp(o[0],n)+" ? "+pp(o[1],n)+" : "+pp(o[2],n),i+=")";break;case OR:case AND:var o=e.children;i+="("+pp(o[0],n)+" "+tokens[e.type]+" "+pp(o[1],n),i+=")";break;case BITWISE_OR:case BITWISE_XOR:case BITWISE_AND:case EQ:case NE:case STRICT_EQ:case STRICT_NE:case LT:case LE:case GE:case GT:case IN:case INSTANCEOF:case LSH:case RSH:case URSH:case PLUS:case MINUS:case MUL:case DIV:case MOD:var o=e.children;i+="("+pp(o[0],n)+" "+tokens[e.type]+" "+pp(o[1],n)+")";break;case DELETE:case VOID:case TYPEOF:i+=tokens[e.type]+" "+pp(e.children[0],n);break;case NOT:case BITWISE_NOT:i+=tokens[e.type]+pp(e.children[0],n);break;case UNARY_PLUS:i+="+"+pp(e.children[0],n);break;case UNARY_MINUS:i+="-"+pp(e.children[0],n);break;case INCREMENT:case DECREMENT:i+=e.postfix?pp(e.children[0],n)+tokens[e.type]:tokens[e.type]+pp(e.children[0],n);break;case DOT:var o=e.children;i+=pp(o[0],n)+"."+pp(o[1],n);break;case INDEX:var o=e.children;i+=pp(o[0],n)+"["+pp(o[1],n)+"]";break;case CALL:var o=e.children;i+=pp(o[0],n)+"("+pp(o[1],n)+")";break;case NEW:case NEW_WITH_ARGS:var o=e.children;i+="new "+pp(o[0],n),o[1]&&(i+="("+pp(o[1],n)+")");break;case ARRAY_INIT:i+="[";for(var o=e.children,a=0,s=o.length;s>a;a++)o[a]&&(i+=pp(o[a],n)),i+=",";i+="]";break;case ARRAY_COMP:i+="["+pp(e.expression,n)+" ",i+=pp(e.tail,n),i+="]";break;case COMP_TAIL:for(var o=e.children,a=0,s=o.length;s>a;a++)a>0&&(i+=" "),i+=pp(o[a],n);e.guard&&(i+=" if ("+pp(e.guard,n)+")");break;case OBJECT_INIT:var o=e.children;i+=o[0]&&o[0].type===PROPERTY_INIT?"{\n":"{";for(var a=0,s=o.length;s>a;a++){a>0&&(i+=",\n");var h=o[a];if(h.type===PROPERTY_INIT){var m,E=h.children;m="string"!=typeof E[0].value||/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(E[0].value)?pp(E[0],n):nodeStr(E[0]),i+=indent(4,m)+": "+indent(4,pp(E[1],n)).substring(4)}else i+=indent(4,pp(h,n))}i+="\n}";break;case NULL:i+="null";break;case THIS:i+="this";break;case TRUE:i+="true";break;case FALSE:i+="false";break;case IDENTIFIER:case NUMBER:case REGEXP:i+=e.value.isOctal?"0"+e.value.toString(8):e.value;break;case STRING:i+=nodeStr(e);break;case GROUP:i+="("+pp(e.children[0],n)+")";break;default:throw"PANIC: unknown operation "+tokens[e.type]+" "+e.toSource()}return e.parenthesized&&(i+=")"),i}const parser=Narcissus.parser,definitions=Narcissus.definitions,tokens=definitions.tokens;return eval(definitions.consts),{pp:pp}}(),function(e){e.version="0.10.8"}("undefined"!=typeof exports?exports:Streamline.version=Streamline.version||{}),function(){var e;if("undefined"!=typeof exports){var n=srequire;try{e=n("source-map")}catch(t){}}e||(e={SourceNode:function(e,n,t,r){this.children=r?[r]:[]}},e.SourceNode.prototype.add=function(e){return Array.isArray(e)?this.children=this.children.concat(e):this.children.push(e),this},e.SourceNode.prototype.prepend=function(e){return Array.isArray(e)?this.children=e.concat(this.children.concat):this.children.unshift(e),this},e.SourceNode.prototype.toString=function(){var e="";return this.walk(function(n){e+=n}),e},e.SourceNode.prototype.walk=function(n){return this.children.forEach(function(t){t instanceof e.SourceNode?t.walk(n):n(t)}),this}),function(n){function t(){e.SourceNode.apply(this,arguments)}t.prototype=Object.create(e.SourceNode.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0},length:{get:function(){var e=0;return this.walk(function(n){e+=n.length}),e}}}),t.prototype.stripPrefix=function(e){for(var n;this.children.length>0&&e>0&&(n=this.children[0].length)<=e;)this.children.shift(),e-=n;return 0==this.children.length||0==e?this:("string"==typeof this.children[0]?this.children[0]=this.children[0].substring(e):this.children[0].stripPrefix(e),this)},t.prototype.stripSuffix=function(e){for(var n,t;(t=this.children.length)>0&&e>0&&(n=this.children[t-1].length)<=e;)this.children.pop(),e-=n;return 0==t||0==e?this:("string"==typeof this.children[t-1]?this.children[t-1]=this.children[0].slice(0,-e):this.children[t-1].stripSuffix(e),this)},t.prototype.map=function(n){return this.children=this.children.map(function(t){return t instanceof e.SourceNode?t.map(n):n(t)}),this},t.prototype.lastChar=function(){for(var e=this.children.length;e--;){var n;if(n="string"==typeof this.children[e]?this.children[e].slice(-1):this.children[e].lastChar())return n}return""},n.exports=Object.create(e,{SourceNode:{value:t}})}("undefined"!=typeof exports?module:Streamline.sourceMap=Streamline.sourceMap||{})}(),"undefined"!=typeof exports)var Narcissus=srequire("streamline/deps/narcissus");var sourceMap=srequire("streamline/lib/util/source-map");if(function(exports){function _pp(e){function n(e){return o+=1,e}function t(e,n){var t=new Array(e+1).join(" ");return n.map(function(e){return e.replace(/\n/g,"\n"+t)}),n.prepend(new sourceMap.SourceNode(null,null,null,t)),n}function r(e){return e&&e.type===BLOCK}function i(e,n){var t,r,i=e.tokenizer&&e.tokenizer.filename;i=i||void 0;var a=e.start,s=e.end,o=e.tokenizer&&e.tokenizer.source;if(!(i&&a&&s&&o))return new sourceMap.SourceNode(void 0,void 0,void 0,n);if(i&&!l){l=[],l[-1]=0;for(var t=1,c=o.indexOf("\n");c>=0;c=o.indexOf("\n",c+1))l[c]=t,t++}for(;s>a&&" \n	;{}".indexOf(o[a])>=0;)a++;if(s>a){var u=(o.substring(a,s),o.lastIndexOf("\n",a));t=l[u]+1,r=a-(u+1)}else i=void 0;return new sourceMap.SourceNode(t,r,i,n)}function a(e){return i(e,'"'+e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"')}function s(e,u,l){var p=!1;if(!e)return"";if(!(e instanceof Object))return""+e;u||(p=!0,u=1),c[o]||(c[o]=[]),c[o].push(e);var f=i(e);switch(e.parenthesized&&f.add("("),e.type){case FUNCTION:case GETTER:case SETTER:e.type===FUNCTION?f.add("function"):e.type===GETTER?f.add("get"):f.add("set"),e.name&&f.add([" ",i(e,e.name)]),f.add("(");for(var d=0,_=e.params.length;_>d;d++)f.add([d>0?", ":"",s(e.params[d],u)]);f.add([") ",s(e.body,u)]);break;case SCRIPT:case BLOCK:var h=e.children;if(p){for(var d=0,_=h.length;_>d;d++)d>0&&f.add(n("\n")),f.add(s(h[d],u)),";"!=f.lastChar()&&f.add(";");break}f.add("{"),void 0!==e.id&&f.add(" /* "+e.id+" */"),f.add(n("\n"));for(var d=0,_=h.length;_>d;d++)d>0&&f.add(n("\n")),f.add(t(2,s(h[d],u))),";"!=f.lastChar()&&f.add(";");f.add(n("\n}"));break;case LET_BLOCK:f.add(["let (",s(e.variables,u,!0),") "]),e.expression?f.add(s(e.expression,u)):f.add(s(e.block,u));break;case IF:f.add(["if (",s(e.condition,u),") "]);var m=e.thenPart,E=e.elsePart,y=r(m)||r(E);y||f.add(n("{\n")),f.add(y?s(m,u):t(2,s(m,u))),E&&";}".indexOf(f.lastChar())<0&&f.add(";"),f.add(n("\n")),E&&(y?f.add(" else "):f.add(n("} else {\n")),f.add([y?s(E,u):t(2,s(E,u)),n("\n")])),y||f.add("}");break;case SWITCH:f.add(["switch (",s(e.discriminant,u),n(") {\n")]);for(var d=0,_=e.cases.length;_>d;d++){var b=e.cases[d];b.type===CASE?f.add(["case ",s(b.caseLabel,u),n(":\n")]):f.add(n("  default:\n")),f.add([s(b.statements,u).stripPrefix(2).stripSuffix(2),n("\n")]),o-=2}f.add("}");break;case FOR:f.add(["for (",s(e.setup,u),"; ",s(e.condition,u),"; ",s(e.update,u),") "]);var v=s(e.body,u);r(e.body)?e.body&&f.add(v):f.add([n("{\n"),t(2,v),n(";\n}")]);break;case WHILE:f.add(["while (",s(e.condition,u),") "]);var v=s(e.body,u);r(e.body)?f.add(v):f.add([n("{\n"),t(2,v),n(";\n}")]);break;case FOR_IN:var T=e.varDecl;f.add([e.isEach?"for each (":"for (",T?s(T,u):s(e.iterator,u)," in ",s(e.object,u),") "]);var v=s(e.body,u);r(e.body)?e.body&&f.add(v):f.add([n("{\n"),t(2,v),n(";\n}")]);break;case DO:f.add(["do ",s(e.body,u)," while (",s(e.condition,u),");"]);break;case BREAK:f.add(["break",e.label?" "+e.label:"",";"]);break;case CONTINUE:f.add(["continue",e.label?" "+e.label:"",";"]);break;case TRY:f.add(["try ",s(e.tryBlock,u)]);for(var d=0,_=e.catchClauses.length;_>d;d++){var I=e.catchClauses[d];f.add([" catch (",s(I.varName,u),I.guard?" if "+s(I.guard,u):"",") ",s(I.block,u)])}e.finallyBlock&&f.add([" finally ",s(e.finallyBlock,u)]);break;case THROW:f.add(["throw ",s(e.exception,u)]);break;case RETURN:f.add("return"),e.value&&f.add([" ",s(e.value,u)]);break;case YIELD:f.add("yield"),e.value.type&&f.add([" ",s(e.value,u)]);break;case GENERATOR:f.add([s(e.expression,u)," ",s(e.tail,u)]);break;case WITH:f.add(["with (",s(e.object,u),") ",s(e.body,u)]);break;case LET:case VAR:case CONST:var h=e.children;l||f.add([tokens[e.type]," "]);for(var d=0,_=h.length;_>d;d++){d>0&&f.add(", ");var T=h[d];f.add(s(T.name,u)),T.initializer&&f.add([" = ",s(T.initializer,u)])}break;case DEBUGGER:f.add(n("debugger\n"));break;case SEMICOLON:e.expression&&f.add([s(e.expression,u),";"]);break;case LABEL:f.add([e.label,n(":\n"),s(e.statement,u)]);break;case COMMA:case LIST:for(var h=e.children,d=0,_=h.length;_>d;d++)d>0&&f.add(", "),f.add(s(h[d],u));break;case ASSIGN:var h=e.children,I=e.assignOp;f.add([s(h[0],u)," ",I?tokens[I]:"","="," ",s(h[1],u)]);break;case HOOK:var h=e.children;f.add(["(",s(h[0],u)," ? ",s(h[1],u)," : ",s(h[2],u),")"]);break;case OR:case AND:var h=e.children;f.add(["(",s(h[0],u)," ",tokens[e.type]," ",s(h[1],u),")"]);break;case BITWISE_OR:case BITWISE_XOR:case BITWISE_AND:case EQ:case NE:case STRICT_EQ:case STRICT_NE:case LT:case LE:case GE:case GT:case IN:case INSTANCEOF:case LSH:case RSH:case URSH:case PLUS:case MINUS:case MUL:case DIV:case MOD:var h=e.children;f.add(["(",s(h[0],u)," ",tokens[e.type]," ",s(h[1],u),")"]);break;case DELETE:case VOID:case TYPEOF:f.add([tokens[e.type]," ",s(e.children[0],u)]);break;case NOT:case BITWISE_NOT:f.add([tokens[e.type],s(e.children[0],u)]);break;case UNARY_PLUS:f.add(["+",s(e.children[0],u)]);break;case UNARY_MINUS:f.add(["-",s(e.children[0],u)]);break;case INCREMENT:case DECREMENT:e.postfix?f.add([s(e.children[0],u),tokens[e.type]]):f.add([tokens[e.type],s(e.children[0],u)]);break;case DOT:var h=e.children;f.add([s(h[0],u),".",s(h[1],u)]);break;case INDEX:var h=e.children;f.add([s(h[0],u),"[",s(h[1],u),"]"]);break;case CALL:var h=e.children;f.add([s(h[0],u),"(",s(h[1],u),")"]);break;case NEW:case NEW_WITH_ARGS:var h=e.children;f.add("new "),f.add(s(h[0],u)),h[1]&&f.add(["(",s(h[1],u),")"]);break;case ARRAY_INIT:f.add("[");for(var h=e.children,d=0,_=h.length;_>d;d++)h[d]&&f.add(s(h[d],u)),f.add(",");f.add("]");break;case ARRAY_COMP:f.add(["[",s(e.expression,u)," ",s(e.tail,u),"]"]);break;case COMP_TAIL:for(var h=e.children,d=0,_=h.length;_>d;d++)d>0&&f.add(" "),f.add(s(h[d],u));e.guard&&f.add([" if (",s(e.guard,u),")"]);break;case OBJECT_INIT:var h=e.children;h[0]&&h[0].type===PROPERTY_INIT?f.add(n("{\n")):f.add("{");for(var d=0,_=h.length;_>d;d++){d>0&&f.add(n(",\n"));var I=h[d];if(I.type===PROPERTY_INIT){var N,g=I.children;"string"!=typeof g[0].value||/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(g[0].value)?(N=s(g[0],u),f.add(t(2,N))):(N=a(g[0]),f.add(N)),f.add([": ",t(2,s(g[1],u)).stripPrefix(2)])}else f.add(t(2,s(I,u)))}f.add(n("\n}"));break;case NULL:f.add("null");break;case THIS:f.add("this");break;case TRUE:f.add("true");break;case FALSE:f.add("false");break;case IDENTIFIER:case NUMBER:case REGEXP:e.value.isOctal?f.add("0"+e.value.toString(8)):f.add(""+e.value);break;case STRING:f.add(a(e));break;case GROUP:f.add(["(",s(e.children[0],u),")"]);break;default:throw"PANIC: unknown operation "+tokens[e.type]+" "+e.toSource()}return e.parenthesized&&f.add(")"),f}var o=0,c={},u=s(e);return{source:u,lineMap:c};var l}eval(Narcissus.definitions.consts);var tokens=Narcissus.definitions.tokens;exports.format=function(e,n){var t="",r=_pp(e);if("sourcemap"==n)return r.source;if(r.source=r.source.toString(),"ignore"==n)return r.source;var i=r.lineMap,a=r.source.split("\n");if("preserve"==n){for(var s=1,o=!0,c=0;c<a.length;c++){var u=(i[c]||[]).filter(function(e){return e._isSourceNode});if(u.length>0)for(var l=u[0].lineno;l>s;)t+="\n",s+=1,o=!0;t+=o?a[c]:a[c].replace(/^\s+/," "),o=!1}t+="\n"}else{if("mark"!=n)throw new Error("bad --lines option: "+n);for(var c=0;c<a.length;c++){var p=a[c],u=(i[c]||[]).filter(function(e){return e._isSourceNode}),f="            ";if(u.length>0){var l=""+u[0].lineno;f="/* ";for(var d=l.length;5>d;d++)f+=" ";f+=l+" */ "}t+=f+p+"\n"}}return t}}("undefined"!=typeof exports?exports:window.Streamline=window.Streamline||{}),"undefined"!=typeof exports)var Narcissus=srequire("../../deps/narcissus"),format=srequire("./format").format;else var format=Streamline.format;!function(exports){function _assert(e){if(!e)throw new Error("Assertion failed!")}function _tag(e){if(!e||!e.type)return"*NOT_A_NODE*";var n=definitions.tokens[e.type];return/^\W/.test(n)?definitions.opTypeNames[n]:n.toUpperCase()}function originalLine(e,n,t){if(!e.prevMap)return n;null==t&&(t=1e3);var r=e.prevMap.originalPositionFor({line:n,column:t}).line;return null==r?n:r}function originalCol(e,n,t){return e.prevMap?e.prevMap.originalPositionFor({line:n,column:t}).column||0:t}function _node(e,n,t){return{_scope:e&&e._scope,_async:e&&e._async,type:n,children:t}}function _identifier(e,n){return{_scope:n&&n._scope,type:IDENTIFIER,name:e,value:e,initializer:n}}function _number(e){return{type:NUMBER,value:e}}function _string(e){return{type:STRING,value:e}}function _return(e){return{type:RETURN,_scope:e._scope,value:e}}function _semicolon(e){var n=_node(e,SEMICOLON);return n.expression=e,n}function _safeName(e,n){if("__"===n.substring(0,2))for(;e[n];)n+="A";return n}function _flatten(e){if(e.type==BLOCK||e.type==SCRIPT)do{var n=!1,t=[];e.children.forEach(function(r){r._isFunctionReference||r.type==SEMICOLON&&(null==r.expression||r.expression._isFunction)||(e._async|=r._async,r.type==BLOCK||r.type==SCRIPT?(t=t.concat(r.children),n=!0):t.push(r))}),e.children=t}while(n);return e}function _propagate(e,n,t,r){var i=r?r:e;for(var a in e)if(e.hasOwnProperty(a)&&a.indexOf("Decls")<0&&(t||"target"!=a)&&"_"!=a[0]){var s=e[a];if(null!=s)if(Array.isArray(s)){r&&(i[a]=s=[].concat(s));for(var o=!1,c=0;c<s.length;c++)(t||s[c]&&s[c].type)&&(s[c]=n(s[c],e),o|="undefined"==typeof s[c]);o&&(i[a]=s.filter(function(e){return"undefined"!=typeof e}))}else(t||s&&s.type)&&(i[a]=n(s,e))}return i}function _clone(e){function n(e){if(!e||!e.type)return e;var i=e._cloneId;i||(i=e._cloneId=++t);var a=r[i];return a?a:(r[i]=a={_cloneId:i},_propagate(e,n,!0,a))}var t=0,r={};return _propagate(e,n,!0,{})}function Template(e,n,t,r){var i=parse("function _t(){"+n+"}").children[0].body;i=1==i.children.length?i.children[0]:_node(i.children[0],BLOCK,i.children),this.generate=function(n,a){function s(n){if(n.type!=SCRIPT&&n.type!=BLOCK&&(n._pass=e),n.type==FUNCTION&&r&&(_assert(null==u),u=n),!n||!n.type)return"_"==n?c.options.callback:"string"==typeof n?"$"===n[0]?a[n]:_safeName(c.options.precious,n):n;n._scope=c;var t=n.type==SEMICOLON?n.expression:n;if(t&&t.type==IDENTIFIER&&"$"===t.value[0]){var i=a[t.value];return t.initializer&&(i.initializer=s(t.initializer),i.initializer._async&&(i._async=!0)),i}return n=_propagate(n,function(e){return e=s(e),e&&(e._async||e===c.options.callback&&r)&&n.type!==FUNCTION&&(n._async=!0),e},!0),n=_flatten(n)}function o(e,n){return e.type==FUNCTION?e:(e._scope=c,_propagate(e,o))}var c=n._scope;_assert(null!=c),a=a||{};var u=null,l=s(_clone(i));if(u){u.parenthesized=!0;var c=new Scope(u.body,u._scope.options);c.name=u._scope.name,c.line=u._scope.line,c.last=u._scope.last,_assert(u.params[0]===u._scope.options.callback),c.cbIndex=0,_propagate(u,o)}return t?l.value:l},this.root=t?i.value:i}function Scope(e,n){this.script=e,this.line=0,this.last=0,this.vars=[],this.functions=[],this.options=n,this.cbIndex=-1,this.isAsync=function(){return this.cbIndex>=0}}function _genId(e){return _safeName(e._scope.options.precious,"__"+ ++e._scope.last)}function _removeFast(e,n){function t(e){return e.type===IDENTIFIER&&e.value===n.callback}function r(e){return e.type===CALL&&t(e.children[0])&&2===e.children[1].children.length}return e.type===BITWISE_NOT&&t(e.children[0])?(n.needsTransform=!0,e.children[0]):e.type===ARRAY_INIT&&1===e.children.length&&t(e.children[0])?(n.needsTransform=!0,e.children[0]._returnArray=!0,e.children[0]):e.type===RSH&&t(e.children[0])?(n.needsTransform=!0,e.children[1]):e.type===LSH&&t(e.children[0])?(n.needsTransform=!0,e.children[1]):e.type===NOT&&t(e.children[0])?(n.needsTransform=!0,e.type=FALSE,e.children=[],e):r(e)?(e._isStar=!0,n.needsTransform=!0,e.children[0].value=_safeName(n.precious,"__rt")+".streamlinify",e):e}function _markSource(e,n){function t(e){"string"==typeof e.value&&(n.precious[e.value]=!0),e.params&&e.params.forEach(function(e){n.precious[e]=!0}),e._isSourceNode=!0,_propagate(e,function(e){return e=_removeFast(e,n),t(e),e})}t(e)}function _isScriptAsync(e,n){function t(e,i){switch(e.type){case FUNCTION:return e;case IDENTIFIER:return e.value==n.callback?r=!0:_propagate(e,t),e;case CALL:var a,s=e.children[0],o=e.children[1];if(s.type===DOT&&"call"===(a=s.children[1]).value&&(s=s.children[0]).type===FUNCTION&&0===s.params.length&&!s.name&&1===o.children.length&&o.children[0].type===THIS)return _propagate(s.body,t),e;default:return r||_propagate(e,t),e}}var r=!1;return _propagate(e,t),r&&n.verbose&&console.log("WARNING: async calls found at top level in "+e.filename),r}function _canonTopLevelScript(e,n){return e._scope=new Scope(e,n),_isScriptAsync(e,n)?_rootTemplate.generate(e,{$script:e}):e}function _guessName(e,n){function t(e){return e=e.replace(/[^A-Z0-9_$]/gi,"_o_"),e&&!/^\d/.test(e)?e:"_o_"+e}var r,i,a=_genId(e);if(n.type===IDENTIFIER)return t(n.value)+a;if(n.type===ASSIGN){r=n.children[0];for(var s="";r.type===DOT&&(i=r.children[1]).type===IDENTIFIER||r.type===INDEX&&(i=r.children[1]).type===STRING;)s=s?i.value+"_"+s:i.value,r=r.children[0];if(r.type===IDENTIFIER&&(s=s?r.value+"_"+s:r.value),s)return t(s)+a}else if(n.type==PROPERTY_INIT&&(r=n.children[0],r.type===IDENTIFIER||r.type===STRING))return t(r.value)+a;return a}function _canonScopes(e,n){function t(e,r){var i=r._scope;e._scope=i;var a=i.isAsync();if(!a&&e.type!==FUNCTION){if(e.type===IDENTIFIER&&e.value===n.callback&&!r._isStar)throw new Error(e.filename+": Function contains async calls but does not have _ parameter: "+e.name+" at line "+e.lineno);return _propagate(e,t)}switch(e.type===TRY&&(e._async=!0),e.type){case FUNCTION:var s=e,o=e.params.reduce(function(e,t,r){if(t!=n.callback)return e;if(0>e)return r;throw new Error("duplicate _ parameter")},-1);if(o>=0){if(_isFatArrow(e))return e;n.needsTransform=!0,e.name||(e.name=_guessName(e,r))}!a||r.type!==SCRIPT&&r.type!==BLOCK||(i.functions.push(e),s=void 0);var c=new Scope(e.body,n);return e.body._scope=c,c.name=e.name,c.cbIndex=o,c.line=e.lineno,e.body=_propagate(e.body,t),o>=0&&c.functions.push(_string("BEGIN_BODY")),e.body.children=c.functions.concat(e.body.children),c.hasThis&&!e._inhibitThis&&c.vars.push(_identifier(_safeName(n.precious,"__this"),_node(e,THIS))),c.hasArguments&&!e._inhibitArguments&&c.vars.push(_identifier(_safeName(n.precious,"__arguments"),_identifier("arguments"))),c.vars.length>0&&e.body.children.splice(0,0,_node(e,VAR,c.vars)),s;case VAR:var u=e.children.map(function(e){return i.vars.some(function(n){return n.value==e.value})||i.vars.push(_identifier(e.value)),e.initializer?(e=_assignTemplate.generate(r,{$lhs:_identifier(e.value),$rhs:e.initializer}),r.type===FOR&&(e=e.expression),e):null}).filter(function(e){return null!=e});if(0==u.length)return;var l=r.type==BLOCK||r.type===SCRIPT?BLOCK:COMMA,s=_node(r,l,u);return s=_propagate(s,t),r._async|=s._async,s;case THIS:return i.hasThis=!0,_identifier(_safeName(n.precious,"__this"));case IDENTIFIER:if("arguments"===e.value)return i.hasArguments=!0,_identifier(_safeName(n.precious,"__arguments"));if(e=_propagate(e,t),e._async|=e.value===n.callback,e._async&&!r.isArgsList&&(r.type!==PROPERTY_INIT||e!==r.children[0])&&(r.type!==DOT||e!==r.children[1]))throw new Error("invalid usage of '_'");return r._async|=e._async,e;case NEW_WITH_ARGS:var o=e.children[1].children.reduce(function(e,t,r){if(t.type!==IDENTIFIER||t.value!==n.callback)return e;if(0>e)return r;throw new Error("duplicate _ argument")},-1);if(o>=0){var p=_node(e,CALL,[_identifier(_safeName(n.precious,"__construct")),_node(e,LIST,[e.children[0],_number(o)])]);e=_node(e,CALL,[p,e.children[1]])}return e.children[1].isArgsList=!0,e=_propagate(e,t),r._async|=e._async,e;case CALL:e.children[1].isArgsList=!0,_convertCoffeeScriptCalls(e,n),_convertApply(e,n),e.children[1].isArgsList=!0;default:return e=_propagate(e,t),_setBreaks(e),r._async|=e._async,e}}return _propagate(e,t)}function _convertCoffeeScriptCalls(e,n){var t=e.children[0],r=e.children[1];if(t.type!==FUNCTION||0!==t.params.length||t.name||0!=r.children.length){if(t.type===DOT){var i=t.children[1];t=t.children[0],t.type!==FUNCTION||0!==t.params.length||t.name||i.type!==IDENTIFIER||("call"===i.value&&1===r.children.length&&r.children[0].type===THIS?(e.children[0]=t,t._noFuture=!0,t.name="___closure",t.params=[n.callback],r.children=[_identifier(n.callback)],e._scope.hasThis=!0,t._inhibitThis=!0):"apply"===i.value&&2===r.children.length&&r.children[0].type===THIS&&r.children[1].type===IDENTIFIER&&"arguments"===r.children[1].value&&(e.children[0]=t,t._noFuture=!0,t.name="___closure",t.params=[n.callback],r.children=[_identifier(n.callback)],e._scope.hasThis=!0,e._scope.hasArguments=!0,t._inhibitThis=!0,t._inhibitArguments=!0))}}else t._noFuture=!0,t.name="___closure",t.params=[n.callback],r.children=[_identifier(n.callback)]}function _isFatArrow(e){if(1!==e.body.children.length)return!1;var n=e.body.children[0];if(n.type!==RETURN||!n.value)return!1;if(n=n.value,n.type!==CALL)return!1;var t=n.children[1].children,r=n.children[0];return 2!==t.length||"_this"!==t[0].value||"arguments"!==t[1].value?!1:r.type!==DOT||"apply"!==r.children[1].value?!1:(r=r.children[0],r.type!==DOT||r.children[1].type!==IDENTIFIER?!1:(r=r.children[0],r.type!==DOT||"prototype"!==r.children[1].value?!1:(r=r.children[0],r.type!==IDENTIFIER?!1:(e.params=[],!0))))}function _convertApply(e,n){var t=e.children[0],r=e.children[1];if(t.type===DOT){var i=t.children[1];if(i.type===IDENTIFIER&&"apply"===i.value&&2===r.children.length&&r.children[0].type===THIS&&r.children[1].type===IDENTIFIER&&"arguments"===r.children[1].value){var a=t.children[0];e.children[0]=_identifier("__apply"),r.children=[_identifier(n.callback),a,_identifier("__this"),_identifier("__arguments"),_number(e._scope.cbIndex)],e._scope.hasThis=!0,e._scope.hasArguments=!0}}}function _setBreaks(e){switch(e.type){case IF:e._breaks=e.thenPart._breaks&&e.elsePart&&e.elsePart._breaks;break;case SWITCH:for(var n=0;n<e.cases.length;n++){var t=e.cases[n].statements;if(e._async&&t.children.length>0&&!t._breaks)if(n==e.cases.length-2&&e.cases[n+1].type===DEFAULT&&1===e.cases[n+1].statements.children.length&&e.cases[n+1].statements.children[0].type===SEMICOLON&&null==e.cases[n+1].statements.children[0].expression)t.children.push(_node(e,BREAK)),t._breaks=!0;else if(n===e.cases.length-1)t.children.push(_node(e,BREAK)),t._breaks=!0;else{var r=_identifier(_genId(e));e.cases[n].statements=_switchVarTemplate.generate(e.cases[n],{$v:r});var i=_switchIfTemplate.generate(e.cases[n],{$v:r,$block:t});e.cases[n+1].statements.children.splice(0,0,i)}}break;case TRY:e._breaks=e.tryBlock._breaks&&e.catchClauses[0]&&e.catchClauses[0].block._breaks;break;case BLOCK:case SCRIPT:e.children.forEach(function(n){e._breaks|=n._breaks});break;case RETURN:case THROW:case BREAK:e._breaks=!0}}function _statementify(e){function n(e){e.type===COMMA?e.children.forEach(n):t.children.push(e.type==SEMICOLON?e:_semicolon(e))}if(!e)return e;var t=_node(e,BLOCK,[]);return n(e),t}function _blockify(e){if(!e||e.type==BLOCK)return e;if(e.type==COMMA)return _statementify(e);var n=_node(e,BLOCK,[e]);return n._async=e._async,n}function _canonFlows(e,n){function t(e,n,r){function i(e){e.condition&&e.condition._async&&e.condition.type!==CALL&&(e.condition=_flowsTemplates.CONDITION.generate(e,{$name:"__$"+e._scope.name,$condition:t(e.condition,e,!0)})),e.update&&e.update._async&&(e.update=_flowsTemplates.UPDATE.generate(e,{$name:"__$"+e._scope.name,$update:_statementify(e.update)}))}var a=e._scope;if(e.type==FOR&&"flows"===e._pass&&i(e),!a||!a.isAsync()||!r&&"flows"===e._pass)return _propagate(e,t);switch(e.type){case IF:e.thenPart=_blockify(e.thenPart),e.elsePart=_blockify(e.elsePart);break;case SWITCH:if(e._async){var s=e.cases.filter(function(e){return e.type==DEFAULT})[0];s||(s=_node(e,DEFAULT),s.statements=_node(e,BLOCK,[]),e.cases.push(s)),s._breaks||s.statements.children.push(_node(e,BREAK))}break;case WHILE:e.body=_blockify(e.body),e._async&&(e=_flowsTemplates.WHILE.generate(e,{$condition:e.condition,$body:e.body}));break;case DO:e.body=_blockify(e.body),e._async&&(e=_flowsTemplates.DO.generate(e,{$firstTime:_identifier(_genId(e)),$condition:e.condition,$body:e.body}));break;case FOR:e.condition=e.condition||_number(1),e.body=_blockify(e.body),e._async&&(e.setup?e=_flowsTemplates.FOR.generate(e,{$setup:_statementify(e.setup),$condition:e.condition,$update:e.update,$body:e.body}):"flows"!==e._pass&&(e._pass="flows",i(e)));break;case FOR_IN:if(e.body=_blockify(e.body),e._async){if(e.iterator.type!=IDENTIFIER)throw new Error("unsupported 'for ... in' syntax: type="+_tag(e.iterator));e=_flowsTemplates.FOR_IN.generate(e,{$array:_identifier(_genId(e)),$i:_identifier(_genId(e)),$object:e.object,$iter:e.iterator,$body:e.body})}break;case TRY:e.tryBlock&&e.catchClauses[0]&&e.finallyBlock&&(e=_flowsTemplates.TRY.generate(e,{$try:e.tryBlock,$catch:e.catchClauses[0].block,$ex:e.catchClauses[0].varName,$finally:e.finallyBlock}));break;case AND:case OR:e._async&&(e=_flowsTemplates[_tag(e)].generate(e,{$name:"__$"+e._scope.name,$v:_identifier(_genId(e)),$op1:e.children[0],$op2:e.children[1]}));break;case HOOK:e._async&&(e=_flowsTemplates.HOOK.generate(e,{$name:"__$"+e._scope.name,$v:_identifier(_genId(e)),$condition:e.children[0],$true:e.children[1],$false:e.children[2]}));break;case COMMA:e._async&&(e=_flowsTemplates.COMMA.generate(e,{$name:"__$"+e._scope.name,$body:_node(e,BLOCK,e.children.slice(0,e.children.length-1).map(_semicolon)),$result:e.children[e.children.length-1]}))}return _propagate(e,t)}return _propagate(e,t)}function _split(e,n){var t=e[n];if(!t||!t._async)return e;var r=_genId(e),i=_identifier(r,t);return e[n]=_identifier(r),_node(e,BLOCK,[_node(e,VAR,[i]),e])}function _disassemble(e,n){function t(e,i,a){if(!e._async)return _propagate(e,r);if(e=_propagate(e,t),e.type===CALL){if(e.children[0].type===IDENTIFIER&&0==e.children[0].value.indexOf("__wrap"))return e._isWrapper=!0,e;var s=e.children[1];if(s.children.some(function(e){return e.type===IDENTIFIER&&e.value===n.callback||e._isWrapper})){if(a)return void e._scope.disassembly.push(_statementify(e));if(i.type==IDENTIFIER&&0===i.value.indexOf("__"))return e._skipDisassembly=!0,e;var o=_genId(e),c=_identifier(o,e);return e=_node(e,VAR,[c]),e._scope.disassembly.push(e),_identifier(o)}}return e}function r(e,n){var i=e._scope;if(!i||!i.isAsync()||!e._async)return _propagate(e,r);switch(e.type){case IF:e=_split(e,"condition");break;case SWITCH:e=_split(e,"discriminant");break;case FOR:break;case RETURN:e=_split(e,"value");break;case THROW:e=_split(e,"exception");break;case VAR:_assert(1===e.children.length);var a=e.children[0];return i.disassembly=[],a.initializer=t(a.initializer,a),e._async=a.initializer._skipDisassembly,i.disassembly.push(e),_node(n,BLOCK,i.disassembly);case SEMICOLON:return i.disassembly=[],e.expression=t(e.expression,e,!0),e.expression&&(e._async=!1,i.disassembly.push(e)),_node(n,BLOCK,i.disassembly)}return _propagate(e,r)}return _propagate(e,r)}function _callbackify(e,n){function t(e,r){if(e=_flatten(e),!e._scope||!e._scope.isAsync()||"cb"===e._pass)return _propagate(e,t);switch(e.type){case SCRIPT:if("cb"!==r._pass){for(var a,s=0;s<e.children.length;s++){var o=e.children[s];if(o.type===STRING&&"BEGIN_BODY"===o.value){a=e.children.splice(0,s),e.children.splice(0,1);break}}var c=r._noFuture||"flows"===r._pass?_cbTemplates.FUNCTION_INTERNAL:_cbTemplates.FUNCTION;e=c.generate(e,{$fn:r.name,$name:"__$"+e._scope.name,$fname:_string(r.name),$line:_number(originalLine(n,e._scope.line)),$index:_number(e._scope.cbIndex),$decls:_node(e,BLOCK,a||[]),$body:e})}e.type=SCRIPT;case BLOCK:for(var u=0;u<e.children.length;u++)e.children[u]=i(e,u);return e}return _propagate(e,t)}function r(e,n){return _node(e,BLOCK,e.children.splice(n+1,e.children.length-n-1))}function i(e,i){function s(e,r,i){function a(e){return e.children.reduce(function(e,t,r){return t.type==IDENTIFIER&&t.value===n.callback||t._isWrapper?r:e},-1)}var s=e.children[1],o=a(s);_assert(o>=0);var c=s.children[o]._returnArray;s.children[o]._isWrapper&&(s=s.children[o].children[1],o=a(s));for(var u=e.children[0];u.type==DOT;)u=u.children[1];var l=n.source.lastIndexOf("\n",u.start)+1,p=u.start-l;s.children[o]=(i?0===i.indexOf("__")?_cbTemplates.CALL_TMP:_cbTemplates.CALL_RESULT:_cbTemplates.CALL_VOID).generate(e,{
$v:_genId(e),$frameName:_string(e._scope.name),$offset:_number(originalLine(n,u.lineno,p)-originalLine(n,e._scope.line)),$col:_number(originalCol(n,u.lineno,p)),$name:"__$"+e._scope.name,$returnArray:c,$result:i,$tail:r}),e=_propagate(e,t);var f=_node(e,RETURN,[]);return f.value=e,f._pass="cb",f}var o=e.children[i];if("cb"===o._pass)return _propagate(o,t);switch(o.type){case RETURN:r(e,i);var c=o.value?_cbTemplates.RETURN:_cbTemplates.RETURN_UNDEFINED;o=c.generate(o,{$value:o.value});break;case THROW:r(e,i),o=_cbTemplates.THROW.generate(o,{$exception:o.exception});break;case BREAK:if(o.target&&!o.target._async)break;r(e,i),o=o.label?_cbTemplates.LABELLED_BREAK.generate(o,{$break:_safeName(n.precious,"__break__"+o.label)}):_cbTemplates.BREAK.generate(o,{});break;case CONTINUE:if(o.target&&!o.target._async)break;r(e,i),o=o.label?_cbTemplates.LABELLED_CONTINUE.generate(o,{$loop:_safeName(n.precious,"__loop__"+o.label),$more:_safeName(n.precious,"__more__"+o.label)}):_cbTemplates.CONTINUE.generate(o,{});break;case TRY:var u=r(e,i);o=o.catchClauses[0]?_cbTemplates.CATCH.generate(o,{$name:"__$"+o._scope.name,$try:o.tryBlock,$catch:o.catchClauses[0].block,$ex:o.catchClauses[0].varName,$tail:u}):_cbTemplates.FINALLY.generate(o,{$name:"__$"+o._scope.name,$try:o.tryBlock,$finally:o.finallyBlock,$tail:u});break;default:if(o._async){var u=r(e,i);switch(o.type){case IF:o=_cbTemplates.IF.generate(o,{$name:"__$"+o._scope.name,$condition:o.condition,$then:o.thenPart,$else:o.elsePart||_node(o,BLOCK,[]),$tail:u});break;case SWITCH:o._pass="cb",o=_cbTemplates.SWITCH.generate(o,{$name:"__$"+o._scope.name,$statement:o,$tail:u});break;case LABEL:var l=a;return a=o.label,o=_cbTemplates.LABEL.generate(o,{$name:"__$"+o._scope.name,$statement:o.statement,$tail:u}),o=t(o,e),a=l,o;case FOR:var p=_identifier(_genId(o)),f=_cbTemplates.LOOP1.generate(o,{$v:p,$body:o.body}),d=o.update,_=d&&_identifier(_genId(o)),h=(d?_cbTemplates.LOOP2_UPDATE:_cbTemplates.LOOP2).generate(o,{$v:p,$condition:o.condition,$beenHere:_,$update:_statementify(d),$loop1:f});o=(d?a?_cbTemplates.LABELLED_FOR_UPDATE:_cbTemplates.FOR_UPDATE:a?_cbTemplates.LABELLED_FOR:_cbTemplates.FOR).generate(o,{$name:"__$"+o._scope.name,$loop:_identifier(_safeName(n.precious,"__loop__"+a)),$break:_identifier(_safeName(n.precious,"__break__"+a)),$more:_identifier(_safeName(n.precious,"__more__"+a)),$beenHere:_,$loop2:h,$tail:u});break;case VAR:_assert(1==o.children.length);var m=o.children[0];_assert(m.type===IDENTIFIER);var E=m.initializer;return delete m.initializer,_assert(E&&E.type===CALL),s(E,u,m.value);case SEMICOLON:var E=o.expression;return _assert(E.type===CALL),s(E,u);default:throw new Error("internal error: bad node type: "+_tag(o)+": "+pp(o))}}}return t(o,e)}var a;return _propagate(e,t)}function _checkUsed(e,n){"string"==typeof e&&"__"===e.substring(0,2)&&(n[e]=!0)}function _simplify(e,n,t){function r(e,n,t,i){var a=["parenthesized","lineno","start","end","tokenizer","hasReturnWithValue"];if(0==e.indexOf("_")||a.indexOf(e)>=0)return!0;if(n==t)return!0;if(null==n||null==t)return!("children"!=e||!n||0!==n.length);if(Array.isArray(n)){if(n.length!=t.length)return!1;for(var s=0;s<n.length;s++)if(!r(e,n[s],t[s],i))return!1;return!0}if(n.type===IDENTIFIER&&"$"===n.value[0]&&t.type===NUMBER)return i[n.value]=t.value,!0;if("string"==typeof n&&"$"==n[0]&&"string"==typeof t)return i[n]=t,!0;if(n.type){var o;if(n.type==SCRIPT&&n.children[0]&&(o=n.children[0].expression)&&"string"==typeof o.value&&"$"==o.value[0])return i[o.value]=t,!0;if(n.type!=t.type)return!1;if(n.type==IDENTIFIER&&"$"==n.value)return i[n.value]=t.value,!0;for(var e in n)if(n.hasOwnProperty(e)&&e.indexOf("Decls")<0&&"target"!=e&&!r(e,n[e],t[e],i))return!1;return!0}return!1}if(e._simplified)return e;e._simplified=!0,_propagate(e,function(e){return _simplify(e,n,t)}),_checkUsed(e.value,t);var i={};return r("",_optims.function__0$fn,e,i)?_identifier(i.$fn):!r("",_optims.function$return,e,i)||"___"!==i.$fn1&&0!==i.$fn1.indexOf("__$")||"__break"!==i.$fn2?r("",_optims.function__0$arg1return_null$arg2,e,i)&&i.$arg1==i.$arg2?_identifier("_"):n.optimize&&r("",_optims.__cb__,e,i)?_identifier("_"):n.optimize&&r("",_optims.__cbt__,e,i)?_identifier("_"):!r("",_optims.function$fn,e,i)||"___"!==i.$fn1&&0!==i.$fn1.indexOf("__$")||"__then"!==i.$fn2&&"__loop"!==i.$fn2?(r("",_optims.closure,e,i)&&(e.children[1]=_identifier("_")),!r("",_optims.safeParam,e,i)||"__then"!==i.$param&&"__break"!==i.$param||(e.children[1]=_identifier("_")),_flatten(e),e):_identifier(i.$fn2):_identifier(i.$fn2)}function _extend(e,n){for(var t in n)e[t]=n[t];return e}function _cl(e){return _extend({},e)}function _trim(e){return e.toString().replace(/\s+/g," ")}function include(e,n){var t=n+"['"+e+"']=(mod={exports:{}});";t+="(function(module, exports){";var r=srequire;return t+=r("fs").readFileSync(__dirname+"/../"+e+".js","utf8").replace(/(\/\/[^"\n]*\n|\/\*[\s\S]*?\*\/|\n)[ \t]*/g,""),t+="})(mod, mod.exports);"}function requireRuntime(e){if(!e.standalone)return"srequire('streamline/lib/callbacks/runtime').runtime(__filename, "+!!e.oldStyleFutures+")";var n=_safeName(e.precious,"__modules"),t="(function(){var "+n+"={},mod;";return t+="function srequire(p){var m="+n+"[p.substring(15)]; return m && m.exports};",t+=include("globals",n),t+=include("util/future",n),t+=include("callbacks/runtime",n),["funnel","forEach_","map_","filter_","every_","some_","reduce_","reduceRight_","sort_","apply_"].some(function(n){return e.precious[n]})&&(t+=include("callbacks/builtins",n)),t+="return "+n+"['callbacks/runtime'].exports.runtime('"+e.sourceName+"', "+!!e.oldStyleFutures+");",t+="})()"}exports.version=srequire("streamline/lib/version").version+" (callbacks)";var parse=Narcissus.parser.parse,pp=Narcissus.decompiler.pp,definitions=Narcissus.definitions;eval(definitions.consts.replace(/const /g,"var "));var _rootTemplate=new Template("root","(function main(_){ $script }).call(this, __trap);"),_assignTemplate=new Template("canon","$lhs = $rhs;"),_switchVarTemplate=new Template("canon","{ var $v = true; }"),_switchIfTemplate=new Template("canon","if ($v) { $block; }"),_flowsTemplates={WHILE:new Template("flows","{	for (; $condition;) {		$body;	}}"),DO:new Template("flows","{	var $firstTime = true;	for (; $firstTime || $condition;) {		$firstTime = false;		$body;	}}"),FOR:new Template("flows","{	$setup;	for (; $condition; $update) {		$body;	}}"),FOR_IN:new Template("flows","{	var $array = __forIn($object);	var $i = 0;	for (; $i < $array.length;) {		$iter = $array[$i++];		$body;	}}"),TRY:new Template("flows","try {	try { $try; }	catch ($ex) { $catch; }}finally { $finally; }"),AND:new Template("flows","return (function $name(_){	var $v = $op1;	if (!$v) {		return $v;	}	return $op2;})(_)",!0,!0),OR:new Template("flows","return (function $name(_){	var $v = $op1;	if ($v) {		return $v;	}	return $op2;})(_)",!0,!0),HOOK:new Template("flows","return (function $name(_){	var $v = $condition;	if ($v) {		return $true;	}	return $false;})(_);",!0,!0),COMMA:new Template("flows","return (function $name(_){	$body;	return $result;})(_);",!0,!0),CONDITION:new Template("flows","return (function $name(_){	return $condition;})(_);",!0,!0),UPDATE:new Template("flows","return (function $name(_){	$update;})(_);",!0,!0)},_cbTemplates={FUNCTION:new Template("cb","{	$decls;	var __frame = { name: $fname, line: $line };	return __func(_, this, arguments, $fn, $index, __frame, function $name(){		$body;		_();	});}"),FUNCTION_INTERNAL:new Template("cb","{ $decls; $body; _(); }"),RETURN:new Template("cb","return _(null, $value);"),RETURN_UNDEFINED:new Template("cb","return _(null);"),THROW:new Template("cb","return _($exception);"),IF:new Template("cb","return (function $name(__then){	if ($condition) { $then; __then(); }	else { $else; __then(); }})(function $name(){ $tail; });"),SWITCH:new Template("cb","return (function $name(__break){	$statement;})(function $name(){ $tail; });"),LABEL:new Template("cb","$statement;$tail;"),BREAK:new Template("cb","return __break();"),LABELLED_BREAK:new Template("cb","return $break();"),CONTINUE:new Template("cb","while (__more) { __loop(); } __more = true;return;"),LABELLED_CONTINUE:new Template("cb","while ($more.get()) { $loop(); } $more.set(true);return;"),LOOP1:new Template("cb","if ($v) {	$body;	while (__more) { __loop(); } __more = true;}else { __break(); }"),LOOP2:new Template("temp","var $v = $condition; $loop1;"),LOOP2_UPDATE:new Template("temp","if ($beenHere) { $update; } else { $beenHere = true; }var $v = $condition; $loop1;"),FOR:new Template("cb","return (function ___(__break){	var __more;	var __loop = __cb(_, __frame, 0, 0, function $name(){		__more = false;		$loop2	});	do { __loop(); } while (__more); __more = true;})(function $name(){ $tail;});"),LABELLED_FOR:new Template("cb","return (function ___(__break){	var __more, $more = { get: function() { return __more; }, set: function(v) { __more = v; }};	var __loop = __cb(_, __frame, 0, 0, function $name(){		var $break = __break, $loop = __loop;		__more = false;		$loop2	});	do { __loop(); } while (__more); __more = true;})(function $name(){ $tail;});"),FOR_UPDATE:new Template("cb","var $beenHere = false;return (function ___(__break){	var __more;	var __loop = __cb(_, __frame, 0, 0, function $name(){		__more = false;		$loop2	});	do { __loop(); } while (__more); __more = true;})(function $name(){ $tail; });"),LABELLED_FOR_UPDATE:new Template("cb","var $beenHere = false;return (function ___(__break){	var __more, $more = { get: function() { return __more; }, set: function(v) { __more = v; }};	var __loop = __cb(_, __frame, 0, 0, function $name(){		var $break = __break, $loop = __loop;		__more = false;		$loop2	});	do { __loop(); } while (__more); __more = true;})(function $name(){ $tail; });"),CATCH:new Template("cb","return (function ___(__then){	(function ___(_){		__tryCatch(_, function $name(){ $try; __then(); });	})(function ___($ex, __result){		__catch(function $name(){			if ($ex) { $catch; __then(); }			else { _(null, __result); }		});	});})(function ___(){	__tryCatch(_, function $name(){ $tail; });});"),FINALLY:new Template("cb","return (function ___(__then){	(function ___(_){		__tryCatch(_, function $name(){ $try; _(null, null, true); });	})(function ___(__e, __r, __cont){		(function ___(__then){			__tryCatch(_, function $name(){ $finally; __then(); });		})(function ___(){			__tryCatch(_, function ___(){				if (__cont) __then(); else _(__e, __r);			});		})	});})(function ___(){	__tryCatch(_, function $name(){ $tail; });});"),CALL_VOID:new Template("cb","return __cb(_, __frame, $offset, $col, function $name(){ $tail; }, true, $returnArray)",!0),CALL_TMP:new Template("cb","return __cb(_, __frame, $offset, $col, function ___(__0, $result){ $tail }, true, $returnArray)",!0),CALL_RESULT:new Template("cb","return __cb(_, __frame, $offset, $col, function $name(__0, $v){	var $result = $v;	$tail}, true, $returnArray)",!0)},_optims={function__0$fn:new Template("simplify","return function ___(__0) { $fn(); }",!0).root,function$return:new Template("simplify","return function $fn1() { return $fn2(); }",!0).root,function__0$arg1return_null$arg2:new Template("simplify","return function ___(__0, $arg1) { return _(null, $arg2); }",!0).root,__cb__:new Template("simplify","return __cb(_, $frameVar, $line, $col, _)",!0).root,__cbt__:new Template("simplify","return __cb(_, $frameVar, $line, $col, _, true)",!0).root,function$fn:new Template("simplify","return function $fn1() { $fn2(); }",!0).root,closure:new Template("simplify","return (function ___closure(_){ $body; })(__cb(_,$frameVar,$line,$col,function $fnName(){_();},true))",!0).root,safeParam:new Template("simplify","return (function $fnName($param){ $body; })(function $fnName(){_();})",!0).root};exports.transform=function(e,n){try{e=e.replace(/\r\n/g,"\n"),n=n?_extend({},n):{};var t=/streamline\.options\s*=\s*(\{.*\})/.exec(e);t&&_extend(n,JSON.parse(t[1])),n.source=e,n.callback=n.callback||"_",n.lines=n.lines||"preserve",n.precious={};var r=parse(e+"\n",n.sourceName),i=r.children[0]&&r.children[0].expression&&"use strict"==r.children[0].expression.value;if(i&&r.children.splice(0,1),_markSource(r,n),r=_canonTopLevelScript(r,n),r=_canonScopes(r,n),!n.needsTransform)return e;r=_canonFlows(r,n),r=_disassemble(r,n),r=_callbackify(r,n);var a={};r=_simplify(r,n,a);var s=format(r,n.lines);if(!n.noHelpers){var o=exports.helpersSource(n,a,i);"sourcemap"==n.lines?s.prepend(o):s=o+s}return s}catch(c){var u="error streamlining "+(n.sourceName||"source")+": "+c.message;if(c.source&&c.cursor){for(var l=1,p=0;p<c.cursor;p++)"\n"===c.source[p]&&(l+=1);u+=" on line "+l}else c.stack&&(u+="\nSTACK:\n"+c.stack);throw new Error(u)}},exports.transform.version=exports.version,exports.helpersSource=function(e,n,t){var r=""+e.sourceName,i=r.indexOf("node_modules/");-1==i&&"object"==typeof process&&"function"==typeof process.cwd&&(i=process.cwd().length),r=i>=0?r.substring(i+13):r;var a="preserve"==e.lines?" ":"\n";t=t?'"use strict";'+a:"";var s=a+t,o=["__g","__func","__cb","__future","__propagate","__trap","__catch","__tryCatch","__forIn","__apply","__construct","__setEF"],c=_safeName(e.precious,"__rt");return s+="var "+c+"="+requireRuntime(e),o.forEach(function(t){var r=_safeName(e.precious,t);n[r]&&(s+=","+r+"="+c+"."+t)}),s+=";"+a}}("undefined"!=typeof exports?exports:window.Streamline=window.Streamline||{}),function(e){e.future=function(e,n,t){var r,i,a,s=[],o=this;return n=Array.prototype.slice.call(n),n[t]=function(e,n){r=e,i=n,a=!0,s&&s.forEach(function(t){t.call(o,e,n)}),s=null},e.apply(this,n),function c(e){if("function"!=typeof e){if(e!==!1&&!srequire("streamline/lib/globals").oldStyleFutures)throw new Error("no callback given (argument #0). If you're a Streamline user, more info: https://github.com/Sage/streamlinejs/blob/master/FAQ.md#no-callback-given-error");return c}a?e.call(o,r,i):s.push(e)}},e.streamlinify=function(n,t){return function(){return arguments[t]?n.apply(this,arguments):e.future.call(this,n,arguments,t)}}}("undefined"!=typeof exports?exports:Streamline.future=Streamline.future||{}),function(e){function n(e,n,r,i,a,s,o){n.offset=r,n.col=i;var c=l.context;return function p(r,i){o&&(i=Array.prototype.slice.call(arguments,1)),o=!1;var f=l.frame;l.frame=n,l.context=c,0===l.depth&&l.emitter&&l.emitter.emit("resume"),l.depth++;try{if(!(s&&n.active&&l.trampoline))return p.dispatched=!0,r?(u(r,n),e(r)):(n.active=!0,a(null,i));l.trampoline.queue(function(){return p(r,i)})}catch(d){return t(e,d)}finally{n.active=!1,l.frame=f,0===--l.depth&&l.trampoline&&l.trampoline.flush(),0===l.depth&&l.emitter&&l.emitter.emit("yield")}}}function t(e,n){try{e(n)}catch(t){r(t)}}function r(e){e&&(l.context&&l.context.errorHandler?l.context.errorHandler(e):process.nextTick(function(){throw e}))}function i(e,n){try{n()}catch(t){try{e(t)}catch(i){r(i)}}}function a(e){var n=l.frame,t=l.context;l.trampoline.queue(function(){var r=l.frame,i=l.context;l.frame=n,l.context=t;try{e()}finally{l.frame=r,l.context=i}})}function s(e){var n=[];for(var t in e)n.push(t);return n}function o(e,n,t,r,i){return null==e?p.future(o,arguments,0):(r=Array.prototype.slice.call(r,0),r[null!=i?i:r.length]=e,n.apply(t,r))}function c(e,n){var t="__async"+n;return e[t]||(e[t]=function(){function t(){var t=this,i=r[n];return r[n]=function(e,n){i(e,t)},e.apply(t,r)}var r=arguments;return t.prototype=e.prototype,new t})}function u(n,t){function r(e,n){var t="object"==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1;t&&(n="Error: "+e.message+"\n"+n);var r,i,a=n;if(a){var s=a.split("\n");a=s[0]+"\n    <<< async stack >>>\n"+s.slice(1).map(function(e){var n="object"==typeof navigator&&"function"==typeof srequire&&srequire.async?11:0,t=/([^@]*)\@(.*?)\:(\d+)(?:\:(\d+))?$/.exec(e);e=t?"    at "+t[1]+" ("+t[2]+":"+(parseInt(t[3])-n)+":"+(t[4]||"0")+")":e;var r=e.indexOf("__$");return r>=0&&!i?(i=!0,e.substring(0,r)+e.substring(r+3)):i?"":e}).filter(function(e){return e}).join("\n");for(var r=e.__frame;r;r=r.prev)r.offset>=0&&(a+="\n    at "+r.name+" ("+r.file+":"+(r.line+r.offset)+":"+(r.col+1)+")")}var o=n.indexOf("\n");return a+="\n    <<< raw stack >>>"+(o>=0?n.substring(o):n)}if(n.__frame=n.__frame||t,e.stackTraceEnabled&&n.__lookupGetter__&&null==n.__lookupGetter__("rawStack")){var i=n.__lookupGetter__("stack");if(!i){var a=n.stack||"raw stack unavailable";i=function(){return a}}n.__defineGetter__("rawStack",i),n.__defineGetter__("stack",function(){return r(n,i())})}}var l=srequire("streamline/lib/globals");l.runtime="callbacks";var p=srequire("streamline/lib/util/future");l.context=l.context||{},l.depth=l.depth||0,l.trampoline=function(){var e=[];return{queue:function(n){e.push(n)},flush:function(){l.depth++;try{for(var n;n=e.shift();)n()}finally{l.depth--}}}}(),e.runtime=function(e,f){function d(n,r,i,a,s,o,c){if("function"!=typeof n){if(n!==!1&&!l.oldStyleFutures)throw new Error("no callback given (argument #"+s+"). If you're a Streamline user, more info: https://github.com/Sage/streamlinejs/blob/master/FAQ.md#no-callback-given-error");return p.future.call(r,a,i,s)}o.file=e,o.prev=l.frame,l.frame=o,0===l.depth&&l.emitter&&l.emitter.emit("resume"),l.depth++;try{o.active=!0,c()}catch(u){t(n,u)}finally{o.active=!1,l.frame=o.prev,0===--l.depth&&l.trampoline&&l.trampoline.flush(),0===l.depth&&l.emitter&&l.emitter.emit("yield")}}return l.oldStyleFutures=f,{__g:l,__func:d,__cb:n,__future:p.future,__propagate:t,__trap:r,__tryCatch:i,__catch:a,__forIn:s,__apply:o,__construct:c,__setEF:u,streamlinify:p.streamlinify}},e.stackTraceEnabled=!0}("undefined"!=typeof exports?exports:Streamline.runtime=Streamline.runtime||{}),srequire&&srequire("streamline/lib/callbacks/builtins");var __rt=srequire("streamline/lib/callbacks/runtime").runtime(__filename,!1),__func=__rt.__func,__cb=__rt.__cb;!function(e){"use strict";function n(e){return"number"==typeof e?e:"number"==typeof e.parallel?e.parallel:e.parallel?-1:1}var t=3,r=function(e,n,t){var r,i,a,s=[],o=this;return n=Array.prototype.slice.call(n),n[t]=function(e,n){r=e,i=n,a=!0,s&&s.forEach(function(t){t.call(o,e,n)}),s=null},e.apply(this,n),function c(e){return e?void(a?e.call(o,r,i):s.push(e)):c}};e.funnel=function(e){if(e=null==e?-1:e,0===e&&(e=i.defaultSize),"number"!=typeof e)throw new Error("bad max number: "+e);var n=[],t=0,a=!1,s=function(i,o){function c(){var r=n.splice(0,1)[0];return r.cb?(t++,void r.fn(function(i,s){if(t--,!a)for(r.cb(i,s);e>t&&n.length>0;)c()})):r.fn()}if(null==i)return r(s,arguments,0);if(0>e||e==1/0)return o(i);for(n.push({fn:o,cb:i});e>t&&n.length>0;)c()},o=__rt.streamlinify(s,0);return o.close=function(){n=[],a=!0},o};var i=e.funnel;if(i.defaultSize=4,!(Array.prototype.forEach_&&Array.prototype.forEach_.version_>=t)){try{Object.defineProperty({},"x",{})}catch(a){return}var s=Object.prototype.hasOwnProperty;delete Array.prototype.forEach_,Object.defineProperty(Array.prototype,"forEach_",{configurable:!0,writable:!0,enumerable:!1,value:function o(e,t,r,i){var a,c,u,l=this,p={name:"value__1",line:124};return __func(e,this,arguments,o,0,p,function(){return"function"==typeof t&&(i=r,r=t,t=1),a=n(t),i=void 0!==i?i:l,c=l.length,function(n){if(1===a||1>=c){u=0;var t=!1;return function(n){var a,o=__cb(e,p,0,0,function(){a=!1,t?u++:t=!0;var f=c>u;return f?function(n){return s.call(l,u)?r.call(i,__cb(e,p,7,31,n,!0),l[u],u):void n()}(function(){for(;a;)o();a=!0}):void n()});do o();while(a);a=!0}(n)}return l.map_(__cb(e,p,10,9,n,!0),a,r,i)}(function(){return e(null,l)})})}}),Array.prototype.forEach_.version_=t,delete Array.prototype.map_,Object.defineProperty(Array.prototype,"map_",{configurable:!0,writable:!0,enumerable:!1,value:function c(e,t,r,a){var o,u,l,p,f,d=this,_={name:"value__2",line:147};return __func(e,this,arguments,c,0,_,function(){return"function"==typeof t&&(a=r,r=t,t=1),o=n(t),a=void 0!==a?a:d,u=d.length,function(n){if(1===o||1>=u){l=new Array(u),p=0;var t=!1;return function(n){var i,o=__cb(e,_,0,0,function(){i=!1,t?p++:t=!0;var c=u>p;return c?function(n){return s.call(d,p)?r.call(a,__cb(e,_,9,43,function(e,t){l[p]=t,n()},!0),d[p],p):void n()}(function(){for(;i;)o();i=!0}):void n()});do o();while(i);i=!0}(n)}f=i(o),l=d.map(function(e,n){return f(!1,function t(i){var s={name:"__1",line:161};return __func(i,this,arguments,t,0,s,function(){return r.call(a,__cb(i,s,1,16,i,!0),e,n)})})}),p=0;var c=!1;return function(n){var t,r=__cb(e,_,0,0,function(){t=!1,c?p++:c=!0;var i=u>p;return i?function(n){return s.call(d,p)?l[p](__cb(e,_,19,40,function(e,t){l[p]=t,n()},!0)):void n()}(function(){for(;t;)r();t=!0}):void n()});do r();while(t);t=!0}(n)}(function(){return e(null,l)})})}}),delete Array.prototype.filter_,Object.defineProperty(Array.prototype,"filter_",{configurable:!0,writable:!0,enumerable:!1,value:function u(e,t,r,i){var a,o,c,l,p,f=this,d={name:"value__3",line:179};return __func(e,this,arguments,u,0,d,function(){return"function"==typeof t&&(i=r,r=t,t=1),a=n(t),i=void 0!==i?i:f,o=[],c=f.length,function(n){if(1===a||1>=c){l=0;var t=!1;return function(n){var a,u=__cb(e,d,0,0,function(){a=!1,t?l++:t=!0;var _=c>l;return _?function(n){return s.call(f,l)?(p=f[l],r.call(i,__cb(e,d,10,13,function(e,t){return function(e){t?(o.push(p),e()):e()}(n)},!0),p)):void n()}(function(){for(;a;)u();a=!0}):void n()});do u();while(a);a=!0}(n)}return f.map_(__cb(e,d,14,9,n,!0),a,function u(e,n){var t={name:"__1",line:193};return __func(e,this,arguments,u,0,t,function(){return r.call(i,__cb(e,t,1,12,function(t,r){return function(e){r?(o.push(n),e()):e()}(e)},!0),n)})},i)}(function(){return e(null,o)})})}}),delete Array.prototype.every_,Object.defineProperty(Array.prototype,"every_",{configurable:!0,writable:!0,enumerable:!1,value:function l(e,t,r,a){var o,c,u,p,f,d=this,_={name:"value__4",line:207};return __func(e,this,arguments,l,0,_,function(){return"function"==typeof t&&(a=r,r=t,t=1),o=n(t),a=void 0!==a?a:d,c=d.length,function(n){if(1===o||1>=c){u=0;var t=!1;return function(n){var i,o=__cb(e,_,0,0,function(){i=!1,t?u++:t=!0;var l=c>u;return l?function(e){var n=s.call(d,u);return n?r.call(a,__cb(e,_,8,34,function(n,t){var r=!t;return e(null,r)},!0),d[u]):e(null,n)}(__cb(e,_,-206,17,function(n,t){return function(n){return t?e(null,!1):void n()}(function(){for(;i;)o();i=!0})},!0)):void n()});do o();while(i);i=!0}(n)}p=i(o),f=d.map(function(e){return p(!1,function n(t){var i={name:"__1",line:220};return __func(t,this,arguments,n,0,i,function(){return r.call(a,__cb(t,i,1,16,t,!0),e)})})}),u=0;var l=!1;return function(n){var t,r=__cb(e,_,0,0,function(){t=!1,l?u++:l=!0;var i=c>u;return i?function(e){var n=s.call(d,u);return n?f[u](__cb(e,_,18,31,function(n,t){var r=!t;return e(null,r)},!0)):e(null,n)}(__cb(e,_,-206,17,function(n,i){return function(n){return i?(p.close(),e(null,!1)):void n()}(function(){for(;t;)r();t=!0})},!0)):void n()});do r();while(t);t=!0}(n)}(function(){return e(null,!0)})})}}),delete Array.prototype.some_,Object.defineProperty(Array.prototype,"some_",{configurable:!0,writable:!0,enumerable:!1,value:function p(e,t,r,a){var o,c,u,l,f,d=this,_={name:"value__5",line:241};return __func(e,this,arguments,p,0,_,function(){return"function"==typeof t&&(a=r,r=t,t=1),o=n(t),a=void 0!==a?a:d,c=d.length,function(n){if(1===o||1>=c){u=0;var t=!1;return function(n){var i,o=__cb(e,_,0,0,function(){i=!1,t?u++:t=!0;var l=c>u;return l?function(e){var n=s.call(d,u);return n?r.call(a,__cb(e,_,7,33,e,!0),d[u]):e(null,n)}(__cb(e,_,-240,17,function(n,t){return function(n){return t?e(null,!0):void n()}(function(){for(;i;)o();i=!0})},!0)):void n()});do o();while(i);i=!0}(n)}l=i(o),f=d.map(function(e){return l(!1,function n(t){var i={name:"__1",line:253};return __func(t,this,arguments,n,0,i,function(){return r.call(a,__cb(t,i,1,16,t,!0),e)})})}),u=0;var p=!1;return function(n){var t,r=__cb(e,_,0,0,function(){t=!1,p?u++:p=!0;var i=c>u;return i?function(e){var n=s.call(d,u);return n?f[u](__cb(e,_,17,30,e,!0)):e(null,n)}(__cb(e,_,-240,17,function(n,i){return function(n){return i?(l.close(),e(null,!0)):void n()}(function(){for(;t;)r();t=!0})},!0)):void n()});do r();while(t);t=!0}(n)}(function(){return e(null,!1)})})}}),delete Array.prototype.reduce_,Object.defineProperty(Array.prototype,"reduce_",{configurable:!0,writable:!0,enumerable:!1,value:function f(e,n,t,r){var i,a,o=this,c={name:"value__6",line:274};return __func(e,this,arguments,f,0,c,function(){r=void 0!==r?r:o,i=o.length,a=0;var u=!1;return function(l){var p,f=__cb(e,c,0,0,function(){p=!1,u?a++:u=!0;var d=i>a;return d?function(i){return s.call(o,a)?n.call(r,__cb(e,c,4,34,function(e,n){t=n,i()},!0),t,o[a],a,o):void i()}(function(){for(;p;)f();p=!0}):void l()});do f();while(p);p=!0}(function(){return e(null,t)})})}}),delete Array.prototype.reduceRight_,Object.defineProperty(Array.prototype,"reduceRight_",{configurable:!0,writable:!0,enumerable:!1,value:function d(e,n,t,r){var i,a,o=this,c={name:"value__7",line:290};return __func(e,this,arguments,d,0,c,function(){r=void 0!==r?r:o,i=o.length,a=i-1;var u=!1;return function(i){var l,p=__cb(e,c,0,0,function(){l=!1,u?a--:u=!0;var f=a>=0;return f?function(i){return s.call(o,a)?n.call(r,__cb(e,c,4,34,function(e,n){t=n,i()},!0),t,o[a],a,o):void i()}(function(){for(;l;)p();l=!0}):void i()});do p();while(l);l=!0}(function(){return e(null,t)})})}}),delete Array.prototype.sort_,Object.defineProperty(Array.prototype,"sort_",{configurable:!0,writable:!0,enumerable:!1,value:function _(e,n,t,r){function i(e,t,r){var s,o,c,u,l,p={name:"_qsort",line:313};return __func(e,this,arguments,i,0,p,function(){return t>=r?e(null):function(i){return r==t+1?n(__cb(e,p,4,9,function(n,i){var o=i>0;return function(e){o?(s=a[t],a[t]=a[r],a[r]=s,e()):e()}(function(){return e(null)})},!0),a[t],a[r]):void i()}(function(){return o=Math.floor((t+r)/2),c=a[o],u=t,l=r,function(i){var o,f=__cb(e,p,0,0,function(){o=!1;var d=l>=u;return d?function(t){var i,s=__cb(e,p,0,0,function(){return i=!1,function(e){return function(e){var t=r>u;return t?n(__cb(e,p,18,26,function(n,t){var r=0>t;return e(null,r)},!0),a[u],c):e(null,t)}(__cb(e,p,-312,17,e,!0))}(__cb(e,p,-312,17,function(e,n){if(n){for(u++;i;)s();i=!0}else t()},!0))});do s();while(i);i=!0}(function(){return function(r){var i,s=__cb(e,p,0,0,function(){return i=!1,function(e){return function(e){var r=l>t;return r?n(__cb(e,p,19,26,function(n,t){var r=0>t;return e(null,r)},!0),c,a[l]):e(null,r)}(__cb(e,p,-312,17,e,!0))}(__cb(e,p,-312,17,function(e,n){if(n){for(l--;i;)s();i=!0}else r()},!0))});do s();while(i);i=!0}(function(){for(l>=u&&(s=a[u],a[u]=a[l],a[l]=s,u++,l--);o;)f();o=!0})}):void i()});do f();while(o);o=!0}(function(){return function(n){return r>u?i(__cb(e,p,30,20,n,!0),u,r):void n()}(function(){return function(n){return l>t?i(__cb(e,p,31,20,n,!0),t,l):void n()}(e)})})})})}var a,s=this,o={name:"value__8",line:308};return __func(e,this,arguments,_,0,o,function(){return a=s,t=t||0,r=null==r?a.length-1:r,i(__cb(e,o,38,3,function(){return e(null,a)},!0),t,r)})}}),delete Function.prototype.apply_,Object.defineProperty(Function.prototype,"apply_",{configurable:!0,writable:!0,enumerable:!1,value:function(e,n,t,r){return t=Array.prototype.slice.call(t,0),t.splice(null!=r&&r>=0?r:t.length,0,e),this.apply(n,t)}})}}("undefined"!=typeof exports?exports:Streamline.builtins=Streamline.builtins||{});
function array_to_hash(n){var t,e;for(t=Object.create(null),e=0;e<len(n);e++)t[n[e]]=!0;return t}function slice(n,t){return Array.prototype.slice.call(n,t||0)}function characters(n){return n.split("")}function member(n,t){var e;for(e=t.length-1;e>-1;e-=1)if(t[e]===n)return!0;return!1}function find_if(n,t){var e;for(e=0;e<len(t);e++)if(n(t[e]))return t[e]}function repeat_string(n,t){var e;return 0>=t?"":1===t?n:(e=repeat_string(n,t>>1),e+=e,1&t&&(e+=n),e)}function DefaultsError(n,t){this.msg=n,this.defs=t}function defaults(n,t,e){var r,i;if(n===!0&&(n={}),r=n||{},e)for(i in r)if(r.hasOwnProperty(i)&&!t.hasOwnProperty(i))throw new DefaultsError("`"+i+"` is not a supported option",t);for(i in t)t.hasOwnProperty(i)&&(r[i]=n&&n.hasOwnProperty(i)?n[i]:t[i]);return r}function merge(n,t){var e;for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function noop(){}function push_uniq(n,t){n.indexOf(t)<0&&n.push(t)}function string_template(n,t){return n.replace(/\{(.+?)\}/g,function(n,e){return t[e]})}function remove(n,t){var e;for(e=n.length-1;e>-1;e-=1)n[e]===t&&n.splice(e,1)}function mergeSort(n,t){function e(n,e){var r,i,s,u;for(r=[],i=0,s=0,u=0;i<n.length&&s<e.length;)t(n[i],e[s])<=0?(r[u]=n[i],i+=1):(r[u]=e[s],s+=1),u+=1;return i<n.length&&r.push.apply(r,n.slice(i)),s<e.length&&r.push.apply(r,e.slice(s)),r}function r(n){var t,i,s;return n.length<=1?n:(t=Math.floor(n.length/2),i=n.slice(0,t),s=n.slice(t),i=r(i),s=r(s),e(i,s))}return n.length<2?n.slice():r(n)}function set_difference(n,t){return n.filter(function(n){return t.indexOf(n)<0})}function set_intersection(n,t){return n.filter(function(n){return t.indexOf(n)>=0})}function makePredicate(n){function t(n){var t;if(1===n.length)return o+="return str === "+JSON.stringify(n[0])+";";for(o+="switch(str){",t=0;t<len(n);t++)o+="case "+JSON.stringify(n[t])+":";o+="return true}return false;"}var e,r,i,s,u,o;for(n instanceof Array||(n=n.split(" ")),o="",e=[],u=0;u<len(n);u++){for(r=!1,i=0;i<len(e);i++)if(e[i][0].length===n[u].length){e[i].push(n[u]),r=!0;break}r||e.push([n[u]])}if(e.length>3){for(e.sort(function(n,t){return t.length-n.length}),o+="switch(str.length){",u=0;u<len(e);u++)s=e[u],o+="case "+s[0].length+":",t(s);o+="}"}else t(n);return new Function("str",o)}function Dictionary(){this._values=Object.create(null),this._size=0}var MAP;MAP=function(){function n(n,s,u){function o(){var o,h;return h=s(n[c],c),o=h instanceof r,o&&(h=h.v),h instanceof t?(h=h.v,h instanceof e?a.push.apply(a,u?h.v.slice().reverse():h.v):a.push(h)):h!==i&&(h instanceof e?f.push.apply(f,u?h.v.slice().reverse():h.v):f.push(h)),o}var f,a,c;if(f=[],a=[],n instanceof Array)if(u){for(c=n.length-1;c>-1&&!o();c-=1);f.reverse(),a.reverse()}else for(c=0;c<len(n)&&!o();c++);else for(c in n)if(n.hasOwnProperty(c)&&o())break;return a.concat(f)}function t(n){this.v=n}function e(n){this.v=n}function r(n){this.v=n}var i;return n.at_top=function(n){return new t(n)},n.splice=function(n){return new e(n)},n.last=function(n){return new r(n)},i=n.skip={},n}.call(this),Dictionary.prototype={set:function(n,t){return this.has(n)||(this._size+=1),this._values["$"+n]=t,this},add:function(n,t){return this.has(n)?this.get(n).push(t):this.set(n,[t]),this},get:function(n){return this._values["$"+n]},del_:function(n){return this.has(n)&&(this._size-=1,delete this._values["$"+n]),this},has:function(n){return _$rapyd$_in("$"+n,this._values)},each:function(n){var t;for(t in this._values)n(this._values[t],t.substr(1))},size:function(){return this._size},map:function(n){var t,e;t=[];for(e in this._values)t.push(n(this._values[e],e.substr(1)));return t}};
function DEFNODE(t,e,n,o){var i,a,r,s,l;for(arguments.length<4&&(o=AST_Node),e=e?e.split(/\s+/):[],i=e,o&&o.PROPS&&(e=e.concat(o.PROPS)),r="return function AST_"+t+"(props){ if (props) { ",l=e.length-1;l>-1;l-=1)r+="this."+e[l]+" = props."+e[l]+";";if(a=o&&new o,(a&&a.initialize||n&&n.initialize)&&(r+="this.initialize();"),r+="}}",s=new Function(r)(),a&&(s.prototype=a,s.BASE=o),o&&o.SUBCLASSES.push(s),s.prototype.CTOR=s,s.PROPS=e||null,s.SELF_PROPS=i,s.SUBCLASSES=[],t&&(s.prototype.TYPE=s.TYPE=t),n)for(l in n)n.hasOwnProperty(l)&&(/^\$/.test(l)?s[l.substr(1)]=n[l]:s.prototype[l]=n[l]);return s.DEFMETHOD=function(t,e){this.prototype[t]=e},s}function walk_body(t,e){t.body instanceof AST_Statement?t.body._walk(e):t.body.forEach(function(t){t._walk(e)})}function TreeWalker(t){this.visit=t,this.stack=[]}var AST_Token,AST_Node,AST_Statement,AST_Debugger,AST_Directive,AST_SimpleStatement,AST_Block,AST_BlockStatement,AST_EmptyStatement,AST_StatementWithBody,AST_LabeledStatement,AST_DWLoop,AST_Do,AST_While,AST_ForIn,AST_ListComprehension,AST_With,AST_Scope,AST_Toplevel,AST_Import,AST_Decorator,AST_Lambda,AST_Accessor,AST_Function,AST_Class,AST_Module,AST_Method,AST_Jump,AST_Exit,AST_Return,AST_Throw,AST_LoopControl,AST_Break,AST_Continue,AST_If,AST_Switch,AST_SwitchBranch,AST_Default,AST_Case,AST_Try,AST_Catch,AST_Except,AST_Finally,AST_Definitions,AST_Var,AST_Const,AST_VarDef,AST_BaseCall,AST_Call,AST_ClassCall,AST_New,AST_Seq,AST_PropAccess,AST_Dot,AST_Sub,AST_Unary,AST_UnaryPrefix,AST_UnaryPostfix,AST_Binary,AST_Conditional,AST_Assign,AST_Array,AST_TupleUnpack,AST_Object,AST_ObjectProperty,AST_ObjectKeyVal,AST_ObjectSetter,AST_ObjectGetter,AST_Symbol,AST_SymbolAccessor,AST_SymbolDeclaration,AST_SymbolVar,AST_SymbolConst,AST_SymbolFunarg,AST_SymbolDefun,AST_SymbolLambda,AST_SymbolCatch,AST_Label,AST_SymbolRef,AST_LabelRef,AST_This,AST_Constant,AST_String,AST_Verbatim,AST_Number,AST_RegExp,AST_Atom,AST_Null,AST_NaN,AST_Undefined,AST_Hole,AST_Infinity,AST_Boolean,AST_False,AST_True;AST_Token=DEFNODE("Token","type value line col pos endpos nlb comments_before file",{},null),AST_Node=DEFNODE("Node","start end",{clone:function(){return new this.CTOR(this)},$documentation:"Base class of all AST nodes",$propdoc:{start:"[AST_Token] The first token of this node",end:"[AST_Token] The last token of this node"},_walk:function(t){return t._visit(this)},walk:function(t){return this._walk(t)}},null),AST_Node.warn_function=null,AST_Node.warn=function(t,e){AST_Node.warn_function&&AST_Node.warn_function(string_template(t,e))},AST_Statement=DEFNODE("Statement",null,{$documentation:"Base class of all statements"}),AST_Debugger=DEFNODE("Debugger",null,{$documentation:"Represents a debugger statement"},AST_Statement),AST_Directive=DEFNODE("Directive","value scope",{$documentation:'Represents a directive, like "use strict";',$propdoc:{value:"[string] The value of this directive as a plain string (it's not an AST_String!)",scope:"[AST_Scope/S] The scope that this directive affects"}},AST_Statement),AST_SimpleStatement=DEFNODE("SimpleStatement","body",{$documentation:"A statement consisting of an expression, i.e. a = 1 + 2",$propdoc:{body:"[AST_Node] an expression node (should not be instanceof AST_Statement)"},_walk:function(t){return t._visit(this,function(){this.body._walk(t)})}},AST_Statement),AST_Block=DEFNODE("Block","body",{$documentation:"A body of statements (usually bracketed)",$propdoc:{body:"[AST_Statement*] an array of statements"},_walk:function(t){return t._visit(this,function(){walk_body(this,t)})}},AST_Statement),AST_BlockStatement=DEFNODE("BlockStatement",null,{$documentation:"A block statement"},AST_Block),AST_EmptyStatement=DEFNODE("EmptyStatement",null,{$documentation:"The empty statement (empty block or simply a semicolon)",_walk:function(t){return t._visit(this)}},AST_Statement),AST_StatementWithBody=DEFNODE("StatementWithBody","body",{$documentation:"Base class for all statements that contain one nested body: `For`, `ForIn`, `Do`, `While`, `With`",$propdoc:{body:"[AST_Statement] the body; this should always be present, even if it's an AST_EmptyStatement"},_walk:function(t){return t._visit(this,function(){this.body._walk(t)})}},AST_Statement),AST_LabeledStatement=DEFNODE("LabeledStatement","label",{$documentation:"Statement with a label",$propdoc:{label:"[AST_Label] a label definition"},_walk:function(t){return t._visit(this,function(){this.label._walk(t),this.body._walk(t)})}},AST_StatementWithBody),AST_DWLoop=DEFNODE("DWLoop","condition",{$documentation:"Base class for do/while statements",$propdoc:{condition:"[AST_Node] the loop condition.  Should not be instanceof AST_Statement"},_walk:function(t){return t._visit(this,function(){this.condition._walk(t),this.body._walk(t)})}},AST_StatementWithBody),AST_Do=DEFNODE("Do",null,{$documentation:"A `do` statement"},AST_DWLoop),AST_While=DEFNODE("While",null,{$documentation:"A `while` statement"},AST_DWLoop),AST_ForIn=DEFNODE("ForIn","init name object",{$documentation:"A `for ... in` statement",$propdoc:{init:"[AST_Node] the `for/in` initialization code",name:"[AST_SymbolRef?] the loop variable, only if `init` is AST_Var",object:"[AST_Node] the object that we're looping through"},_walk:function(t){return t._visit(this,function(){this.init._walk(t),this.object._walk(t),this.body._walk(t)})}},AST_StatementWithBody),AST_ListComprehension=DEFNODE("ListComprehension","condition statement",{$documentation:"A list comprehension expression",$propdoc:{condition:"[AST_Node] the `if` condition",statement:"[AST_Node] statement to perform on each element before returning it"}},AST_ForIn),AST_With=DEFNODE("With","expression",{$documentation:"A `with` statement",$propdoc:{expression:"[AST_Node] the `with` expression"},_walk:function(t){return t._visit(this,function(){this.expression._walk(t),this.body._walk(t)})}},AST_StatementWithBody),AST_Scope=DEFNODE("Scope","directives variables localvars functions uses_with uses_eval parent_scope enclosed cname",{$documentation:"Base class for all statements introducing a lexical scope",$propdoc:{directives:"[string*/S] an array of directives declared in this scope",variables:"[Object/S] a map of name -> SymbolDef for all variables/functions defined in this scope",localvars:"[SymbolDef*] list of variables local to this scope",functions:"[Object/S] like `variables`, but only lists function declarations",uses_with:"[boolean/S] tells whether this scope uses the `with` statement",uses_eval:"[boolean/S] tells whether this scope contains a direct call to the global `eval`",parent_scope:"[AST_Scope?/S] link to the parent scope",enclosed:"[SymbolDef*/S] a list of all symbol definitions that are accessed from this scope or any subscopes",cname:"[integer/S] current index for mangling variables (used internally by the mangler)"}},AST_Block),AST_Toplevel=DEFNODE("Toplevel","globals baselib imports strict shebang",{$documentation:"The toplevel scope",$propdoc:{globals:"[Object/S] a map of name -> SymbolDef for all undeclared names",baselib:"[Object/s] a collection of used parts of baselib",imports:"[AST_Import*] a collection of all imported modules",strict:"[boolean/S] true if strict directive is in scope",shebang:"[string] If #! line is present, it will be stored here"},wrap_enclose:function(t){var e,n,o,i;return e=this,n=[],o=[],t.forEach(function(t){var e;e=t.split(":"),n.push(e[0]),o.push(e[1])}),i="(function("+o.join(",")+"){ '$ORIG'; })("+n.join(",")+")",i=parse(i),i=i.transform(new TreeTransformer(function(t){return t instanceof AST_Directive&&"$ORIG"===t.value?MAP.splice(e.body):void 0}))},wrap_commonjs:function(t,e){var n,o,i;return n=this,o=[],e&&(n.figure_out_scope(),n.walk(new TreeWalker(function(t){t instanceof AST_SymbolDeclaration&&t.definition().global&&(find_if(function(e){return e.name===t.name},o)||o.push(t))}))),i="(function(exports, global){ global['"+t+"'] = exports; '$ORIG'; '$EXPORTS'; }({}, (function(){return this}())))",i=parse(i),i=i.transform(new TreeTransformer(function(t){var e,i;if(t instanceof AST_SimpleStatement&&(t=t.body,t instanceof AST_String)){if(e=t.getValue(),"$ORIG"===e)return MAP.splice(n.body);if("$EXPORTS"===e)return i=[],o.forEach(function(t){i.push(new AST_SimpleStatement({body:new AST_Assign({left:new AST_Sub({expression:new AST_SymbolRef({name:"exports"}),property:new AST_String({value:t.name})}),operator:"=",right:new AST_SymbolRef(t)})}))}),MAP.splice(i)}}))}},AST_Scope),AST_Import=DEFNODE("Import","module argnames variables body",{$documentation:"Container for imported files",$propdoc:{module:"[AST_SymbolVar] name of the module we're importing",argnames:"[AST_SymbolVar*] names of objects to be imported",variables:"[Object/S] a map of name -> SymbolDef for all variables/functions defined in this scope",body:"[AST_TopLevel] contents of the imported file"}},AST_Statement),AST_Decorator=DEFNODE("Decorator","name",{$documentation:"Class for function decorators",$propdoc:{name:"[string] decorator name"}}),AST_Lambda=DEFNODE("Lambda","name argnames uses_arguments decorators",{$documentation:"Base class for functions",$propdoc:{name:"[AST_SymbolDeclaration?] the name of this function",argnames:"[AST_SymbolFunarg*] array of function arguments",uses_arguments:"[boolean/S] tells whether this function accesses the arguments array",decorators:"[AST_Decorator*] function decorators, if any"},_walk:function(t){return t._visit(this,function(){this.name&&this.name._walk(t),this.argnames.forEach(function(e){e._walk(t)}),walk_body(this,t)})}},AST_Scope),AST_Accessor=DEFNODE("Accessor",null,{$documentation:"A setter/getter function"},AST_Lambda),AST_Function=DEFNODE("Function",null,{$documentation:"A function expression"},AST_Lambda),AST_Class=DEFNODE("Class","init name parent static external bound decorators modules",{$documentation:"A class declaration",$propdoc:{name:"[AST_SymbolDeclaration?] the name of this class",init:"[AST_Function] constructor for the class",parent:"[AST_Class?] parent class this class inherits from","static":"[string*] list of static methods",external:"[boolean] true if class is declared elsewhere, but will be within current scope at runtime",bound:"[string*] list of methods that need to be bound to behave correctly (function pointers)",decorators:"[AST_Decorator*] function decorators, if any",modules:"[string*] module stack that this class resides inside of, if any"},_walk:function(t){return t._visit(this,function(){this.name._walk(t),walk_body(this,t),this.parent._walk(t)})}},AST_Scope),AST_Module=DEFNODE("Module","name external decorators",{$documentation:"A module definition, meant to abstract a group of related classes and/or functions",$propdoc:{name:"[AST_SymbolDeclaration?] the name of this class",external:"[boolean] true if module is declared elsewhere, but will be within current scope at runtime",decorators:"[AST_Decorator*] module decorators, if any"}},AST_Scope),AST_Method=DEFNODE("Defun","static",{$documentation:"A class method definition",$propdoc:{"static":"[boolean] true if method is static"}},AST_Lambda),AST_Jump=DEFNODE("Jump",null,{$documentation:"Base class for jumps (for now that's `return`, `throw`, `break` and `continue`)"},AST_Statement),AST_Exit=DEFNODE("Exit","value",{$documentation:"Base class for exits (`return` and `throw`)",$propdoc:{value:"[AST_Node?] the value returned or thrown by this statement; could be null for AST_Return"},_walk:function(t){return t._visit(this,this.value&&function(){this.value._walk(t)})}},AST_Jump),AST_Return=DEFNODE("Return",null,{$documentation:"A `return` statement"},AST_Exit),AST_Throw=DEFNODE("Throw",null,{$documentation:"A `throw` statement"},AST_Exit),AST_LoopControl=DEFNODE("LoopControl","label",{$documentation:"Base class for loop control statements (`break` and `continue`)",$propdoc:{label:"[AST_LabelRef?] the label, or null if none"},_walk:function(t){return t._visit(this,this.label&&function(){this.label._walk(t)})}},AST_Jump),AST_Break=DEFNODE("Break",null,{$documentation:"A `break` statement"},AST_LoopControl),AST_Continue=DEFNODE("Continue",null,{$documentation:"A `continue` statement"},AST_LoopControl),AST_If=DEFNODE("If","condition alternative",{$documentation:"A `if` statement",$propdoc:{condition:"[AST_Node] the `if` condition",alternative:"[AST_Statement?] the `else` part, or null if not present"},_walk:function(t){return t._visit(this,function(){this.condition._walk(t),this.body._walk(t),this.alternative&&this.alternative._walk(t)})}},AST_StatementWithBody),AST_Switch=DEFNODE("Switch","expression",{$documentation:"A `switch` statement",$propdoc:{expression:"[AST_Node] the `switch` discriminant"},_walk:function(t){return t._visit(this,function(){this.expression._walk(t),walk_body(this,t)})}},AST_Block),AST_SwitchBranch=DEFNODE("SwitchBranch",null,{$documentation:"Base class for `switch` branches"},AST_Block),AST_Default=DEFNODE("Default",null,{$documentation:"A `default` switch branch"},AST_SwitchBranch),AST_Case=DEFNODE("Case","expression",{$documentation:"A `case` switch branch",$propdoc:{expression:"[AST_Node] the `case` expression"},_walk:function(t){return t._visit(this,function(){this.expression._walk(t),walk_body(this,t)})}},AST_SwitchBranch),AST_Try=DEFNODE("Try","bcatch bfinally",{$documentation:"A `try` statement",$propdoc:{bcatch:"[AST_Catch?] the catch block, or null if not present",bfinally:"[AST_Finally?] the finally block, or null if not present"},_walk:function(t){return t._visit(this,function(){walk_body(this,t),this.bcatch&&this.bcatch._walk(t),this.bfinally&&this.bfinally._walk(t)})}},AST_Block),AST_Catch=DEFNODE("Catch",null,{$documentation:"A `catch` node; only makes sense as part of a `try` statement",$propdoc:{},_walk:function(t){return t._visit(this,function(){this.argname._walk(t),walk_body(this,t)})}},AST_Block),AST_Except=DEFNODE("Except","argname errors",{$documentation:"An `except` node for RapydScript, which resides inside the catch block",$propdoc:{argname:"[AST_SymbolCatch] symbol for the exception",errors:"[AST_SymbolVar*] error classes to catch in this block"}},AST_Block),AST_Finally=DEFNODE("Finally",null,{$documentation:"A `finally` node; only makes sense as part of a `try` statement"},AST_Block),AST_Definitions=DEFNODE("Definitions","definitions",{$documentation:"Base class for `var` or `const` nodes (variable declarations/initializations)",$propdoc:{definitions:"[AST_VarDef*] array of variable definitions"},_walk:function(t){return t._visit(this,function(){this.definitions.forEach(function(e){e._walk(t)})})}},AST_Statement),AST_Var=DEFNODE("Var",null,{$documentation:"A `var` statement"},AST_Definitions),AST_Const=DEFNODE("Const",null,{$documentation:"A `const` statement"},AST_Definitions),AST_VarDef=DEFNODE("VarDef","name value",{$documentation:"A variable declaration; only appears in a AST_Definitions node",$propdoc:{name:"[AST_SymbolVar|AST_SymbolConst] name of the variable",value:"[AST_Node?] initializer, or null if there's no initializer"},_walk:function(t){return t._visit(this,function(){this.name._walk(t),this.value&&this.value._walk(t)})}}),AST_BaseCall=DEFNODE("BaseCall","args",{$documentation:"A base class for function calls",$propdoc:{args:"[AST_Node*] array of arguments"}}),AST_Call=DEFNODE("Call","expression",{$documentation:"A function call expression",$propdoc:{expression:"[AST_Node] expression to invoke as function"},_walk:function(t){return t._visit(this,function(){this.expression._walk(t),this.args.forEach(function(e){e._walk(t)})})}},AST_BaseCall),AST_ClassCall=DEFNODE("ClassCall","class method static",{$documentation:"A function call expression",$propdoc:{"class":"[string] name of the class method belongs to",method:"[string] class method being called","static":"[boolean] defines whether the method is static"},_walk:function(t){return t._visit(this,function(){this.expression._walk(t),this.args.forEach(function(e){e._walk(t)})})}},AST_BaseCall),AST_New=DEFNODE("New",null,{$documentation:"An object instantiation. Derives from a function call since it has exactly the same properties"},AST_Call),AST_Seq=DEFNODE("Seq","car cdr",{$documentation:"A sequence expression (two comma-separated expressions)",$propdoc:{car:"[AST_Node] first element in sequence",cdr:"[AST_Node] second element in sequence"},$cons:function(t,e){var n;return n=new AST_Seq(t),n.car=t,n.cdr=e,n},$from_array:function(t){var e,n,o;if(0===t.length)return null;if(1===t.length)return t[0].clone();for(e=null,n=t.length-1;n>-1;n-=1)e=AST_Seq.cons(t[n],e);for(o=e;o;){if(o.cdr&&!o.cdr.cdr){o.cdr=o.cdr.car;break}o=o.cdr}return e},to_array:function(){var t,e;for(e=this,t=[];e;){if(t.push(e.car),e.cdr&&!(e.cdr instanceof AST_Seq)){t.push(e.cdr);break}e=e.cdr}return t},add:function(t){var e,n;for(n=this;n;){if(!(n.cdr instanceof AST_Seq))return e=AST_Seq.cons(n.cdr,t),n.cdr=e;n=n.cdr}},_walk:function(t){return t._visit(this,function(){this.car._walk(t),this.cdr&&this.cdr._walk(t)})}}),AST_PropAccess=DEFNODE("PropAccess","expression property",{$documentation:'Base class for property access expressions, i.e. `a.foo` or `a["foo"]`',$propdoc:{expression:"[AST_Node] the container expression",property:"[AST_Node|string] the property to access.  For AST_Dot this is always a plain string, while for AST_Sub it's an arbitrary AST_Node"}}),AST_Dot=DEFNODE("Dot",null,{$documentation:"A dotted property access expression",_walk:function(t){return t._visit(this,function(){this.expression._walk(t)})}},AST_PropAccess),AST_Sub=DEFNODE("Sub",null,{$documentation:'Index-style property access, i.e. `a["foo"]`',_walk:function(t){return t._visit(this,function(){this.expression._walk(t),this.property._walk(t)})}},AST_PropAccess),AST_Unary=DEFNODE("Unary","operator expression",{$documentation:"Base class for unary expressions",$propdoc:{operator:"[string] the operator",expression:"[AST_Node] expression that this unary operator applies to"},_walk:function(t){return t._visit(this,function(){this.expression._walk(t)})}}),AST_UnaryPrefix=DEFNODE("UnaryPrefix",null,{$documentation:"Unary prefix expression, i.e. `typeof i` or `++i`"},AST_Unary),AST_UnaryPostfix=DEFNODE("UnaryPostfix",null,{$documentation:"Unary postfix expression, i.e. `i++`"},AST_Unary),AST_Binary=DEFNODE("Binary","left operator right",{$documentation:"Binary expression, i.e. `a + b`",$propdoc:{left:"[AST_Node] left-hand side expression",operator:"[string] the operator",right:"[AST_Node] right-hand side expression"},_walk:function(t){return t._visit(this,function(){this.left._walk(t),this.right._walk(t)})}}),AST_Conditional=DEFNODE("Conditional","condition consequent alternative",{$documentation:"Conditional expression using the ternary operator, i.e. `a ? b : c`",$propdoc:{condition:"[AST_Node]",consequent:"[AST_Node]",alternative:"[AST_Node]"},_walk:function(t){return t._visit(this,function(){this.condition._walk(t),this.consequent._walk(t),this.alternative._walk(t)})}}),AST_Assign=DEFNODE("Assign",null,{$documentation:"An assignment expression  `a = b + 5`"},AST_Binary),AST_Array=DEFNODE("Array","elements",{$documentation:"An array literal",$propdoc:{elements:"[AST_Node*] array of elements"},_walk:function(t){return t._visit(this,function(){this.elements.forEach(function(e){e._walk(t)})})}}),AST_TupleUnpack=DEFNODE("TupleUnpack","elements right",{$documentation:"An object used to represent tuple unpacking",$propdoc:{elements:"[AST_Node*] array of elements being assigned to",right:"[AST_Node] right-hand side expression"},_walk:function(t){return t._visit(this,function(){this.elements.forEach(function(e){e._walk(t)}),this.right._walk(t)})}}),AST_Object=DEFNODE("Object","properties",{$documentation:"An object literal",$propdoc:{properties:"[AST_ObjectProperty*] array of properties"},_walk:function(t){return t._visit(this,function(){this.properties.forEach(function(e){e._walk(t)})})}}),AST_ObjectProperty=DEFNODE("ObjectProperty","key value quoted",{$documentation:"Base class for literal object properties",$propdoc:{key:"[string] the property name; it's always a plain string in our AST, no matter if it was a string, number or identifier in original code",value:"[AST_Node] property value.  For setters and getters this is an AST_Function.",quoted:"[true/false] keeps track whether the property was quoted in original code."},_walk:function(t){return t._visit(this,function(){this.value._walk(t)})}}),AST_ObjectKeyVal=DEFNODE("ObjectKeyVal",null,{$documentation:"A key: value object property"},AST_ObjectProperty),AST_ObjectSetter=DEFNODE("ObjectSetter",null,{$documentation:"An object setter property"},AST_ObjectProperty),AST_ObjectGetter=DEFNODE("ObjectGetter",null,{$documentation:"An object getter property"},AST_ObjectProperty),AST_Symbol=DEFNODE("Symbol","scope name thedef",{$propdoc:{name:"[string] name of this symbol",scope:"[AST_Scope/S] the current scope (not necessarily the definition scope)",thedef:"[SymbolDef/S] the definition of this symbol"},$documentation:"Base class for all symbols"}),AST_SymbolAccessor=DEFNODE("SymbolAccessor",null,{$documentation:"The name of a property accessor (setter/getter function)"},AST_Symbol),AST_SymbolDeclaration=DEFNODE("SymbolDeclaration","init",{$documentation:"A declaration symbol (symbol in var/const, function name or argument, symbol in catch)",$propdoc:{init:"[AST_Node*/S] array of initializers for this declaration."}},AST_Symbol),AST_SymbolVar=DEFNODE("SymbolVar",null,{$documentation:"Symbol defining a variable"},AST_SymbolDeclaration),AST_SymbolConst=DEFNODE("SymbolConst",null,{$documentation:"A constant declaration"},AST_SymbolDeclaration),AST_SymbolFunarg=DEFNODE("SymbolFunarg",null,{$documentation:"Symbol naming a function argument"},AST_SymbolVar),AST_SymbolDefun=DEFNODE("SymbolDefun",null,{$documentation:"Symbol defining a function"},AST_SymbolDeclaration),AST_SymbolLambda=DEFNODE("SymbolLambda",null,{$documentation:"Symbol naming a function expression"},AST_SymbolDeclaration),AST_SymbolCatch=DEFNODE("SymbolCatch",null,{$documentation:"Symbol naming the exception in catch"},AST_SymbolDeclaration),AST_Label=DEFNODE("Label","references",{$documentation:"Symbol naming a label (declaration)",$propdoc:{references:"[AST_LabelRef*] a list of nodes referring to this label"}},AST_Symbol),AST_SymbolRef=DEFNODE("SymbolRef",null,{$documentation:"Reference to some symbol (not definition/declaration)"},AST_Symbol),AST_LabelRef=DEFNODE("LabelRef",null,{$documentation:"Reference to a label symbol"},AST_Symbol),AST_This=DEFNODE("This",null,{$documentation:"The `this` symbol"},AST_Symbol),AST_Constant=DEFNODE("Constant",null,{$documentation:"Base class for all constants",getValue:function(){return this.value}}),AST_String=DEFNODE("String","value",{$documentation:"A string literal",$propdoc:{value:"[string] the contents of this string"}},AST_Constant),AST_Verbatim=DEFNODE("Verbatim","value",{$documentation:"Raw JavaScript code",$propdoc:{value:"[string] A string of raw JS code"}},AST_Constant),AST_Number=DEFNODE("Number","value",{$documentation:"A number literal",$propdoc:{value:"[number] the numeric value"}},AST_Constant),AST_RegExp=DEFNODE("RegExp","value",{$documentation:"A regexp literal",$propdoc:{value:"[RegExp] the actual regexp"}},AST_Constant),AST_Atom=DEFNODE("Atom",null,{$documentation:"Base class for atoms"},AST_Constant),AST_Null=DEFNODE("Null",null,{$documentation:"The `null` atom",value:null},AST_Atom),AST_NaN=DEFNODE("NaN",null,{$documentation:"The impossible value",value:NaN},AST_Atom),AST_Undefined=DEFNODE("Undefined",null,{$documentation:"The `undefined` value",value:function(){}.call(this)},AST_Atom),AST_Hole=DEFNODE("Hole",null,{$documentation:"A hole in an array",value:function(){}.call(this)},AST_Atom),AST_Infinity=DEFNODE("Infinity",null,{$documentation:"The `Infinity` value",value:1/0},AST_Atom),AST_Boolean=DEFNODE("Boolean",null,{$documentation:"Base class for booleans"},AST_Atom),AST_False=DEFNODE("False",null,{$documentation:"The `false` atom",value:!1},AST_Boolean),AST_True=DEFNODE("True",null,{$documentation:"The `true` atom",value:!0},AST_Boolean),TreeWalker.prototype={_visit:function(t,e){var n;return this.stack.push(t),n=this.visit(t,e?function(){e.call(t)}:noop),!n&&e&&e.call(t),this.stack.pop(),n},parent:function(t){return this.stack[this.stack.length-2-(t||0)]},push:function(t){this.stack.push(t)},pop:function(){return this.stack.pop()},self:function(){return this.stack[this.stack.length-1]},find_parent:function(t){var e,n,o;for(e=this.stack,o=e.length-1;o>-1;o-=1)if(n=e[o],n instanceof t)return n},in_boolean_context:function(){var t,e,n,o;for(t=this.stack,e=t.length,o=t[e-=1];e>0;){if(n=t[e-=1],n instanceof AST_If&&n.condition===o||n instanceof AST_Conditional&&n.condition===o||n instanceof AST_DWLoop&&n.condition===o||n instanceof AST_UnaryPrefix&&"!"===n.operator&&n.expression===o)return!0;if(!(n instanceof AST_Binary)||"&&"!==n.operator&&"||"!==n.operator)return!1;o=n}},loopcontrol_target:function(t){var e,n,o;if(e=this.stack,t){for(o=e.length-1;o>-1;o-=1)if(n=e[o],n instanceof AST_LabeledStatement&&n.label.name===t.name)return n.body}else for(o=e.length-1;o>-1;o-=1)if(n=e[o],n instanceof AST_Switch||n instanceof AST_ForIn||n instanceof AST_DWLoop)return n}};
"\n**********************************************************************\n\n  A RapydScript to JavaScript compiler.\n  https://github.com/atsepkov/RapydScript2\n\n  -------------------------------- (C) ---------------------------------\n\n                       Author: Alexander Tsepkov\n                         <atsepkov@pyjeon.com>\n                         http://www.pyjeon.com\n\n  Distributed under Apache 2.0 license:\n    Copyright 2013 (c) Alexander Tsepkov <atsepkov@pyjeon.com>\n\n  RapydScript source code is originally based on UglifyJS2 (covered\n  by BSD license). UglifyJS2 was written by Mihai Bazon\n  <mihai.bazon@gmail.com>, who is its respective copyright holder.\n\n    Redistribution and use in source and binary forms, with or without\n    modification, are permitted provided that the following conditions\n    are met:\n\n        * Redistributions of source code must retain the above\n          copyright notice, this list of conditions and the following\n          disclaimer.\n\n        * Redistributions in binary form must reproduce the above\n          copyright notice, this list of conditions and the following\n          disclaimer in the documentation and/or other materials\n          provided with the distribution.\n\n    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER AS IS AND ANY\n    EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n    PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE\n    LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,\n    OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n    PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR\n    TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF\n    THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n    SUCH DAMAGE.\n\n **********************************************************************\n";"use strict";function OutputStream(n){function t(n,t){return n.replace(/[\u0080-\uffff]/g,function(n){var i;if(i=n.charCodeAt(0).toString(16),i.length<=2&&!t){for(;i.length<2;)i="0"+i;return"\\x"+i}for(;i.length<4;)i="0"+i;return"\\u"+i})}function i(i){var e,r;return e=0,r=0,i=i.replace(/[\\\b\f\n\r\t\x22\x27\u2028\u2029\0]/g,function(n){var t,i,e;return t=n,"\\"===t?"\\\\":"\b"===t?"\\b":"\f"===t?"\\f":"\n"===t?"\\n":"	"===t?"\\t":"\r"===t?"\\r":"\u2028"===t?"\\u2028":"\u2029"===t?"\\u2029":'"'===t?(i+=1,'"'):"'"===t?(e+=1,"'"):"\x00"===t?"\\0":n}),n.ascii_only&&(i=t(i)),e>r?"'"+i.replace(/\x27/g,"\\'")+"'":'"'+i.replace(/\x22/g,'\\"')+'"'}function e(t){var e;return e=i(t),n.inline_script&&(e=e.replace(/<\x2fscript([>\/\t\n\f\r ])/gi,"<\\/script$1")),e}function r(i){return i=i.toString(),n.ascii_only&&(i=t(i,!0)),i}function o(t){return repeat_string(" ",n.indent_start+g-t*n.indent_level)}function a(){return I.charAt(I.length-1)}function c(){n.max_line_len&&y>n.max_line_len&&s("\n")}function s(t){var i,e,r,o,s;if(t=String(t),i=t.charAt(0),x&&(i&&!(";}".indexOf(i)<0)||/[;]$/.test(I)||(n.semicolons||O(i)?(v+=";",y+=1,w+=1):(v+="\n",w+=1,b+=1,y=0),n.beautify||($=!1)),x=!1,c()),!n.beautify&&n.preserve_line&&F[F.length-1])for(e=F[F.length-1].start.line;e>b;)v+="\n",w+=1,b+=1,y=0,$=!1;$&&(r=a(),(is_identifier_char(r)&&(is_identifier_char(i)||"\\"===i)||/^[\+\-\/]$/.test(i)&&i===r)&&(v+=" ",y+=1,w+=1),$=!1),o=t.split(/\r?\n/),s=o.length-1,b+=s,0===s?y+=o[s].length:y=o[s].length,w+=t.length,I=t,v+=t}function p(){x=!1,s(";")}function f(){return g+n.indent_level}function u(n){var t;return t=null,s("{"),C(),N(f(),function(){t=n()}),k(),s("}"),t}function l(n){var t;return s("("),t=n(),s(")"),t}function _(n){var t;return s("["),t=n(),s("]"),t}function d(){s(","),D()}function h(){s(":"),n.space_colon&&D()}function m(t){var i,e,r,o;i=function(n,t){t&&!n.call&&D(),"string"==typeof n?s(n):n.parens?l(function(){n.parens.forEach(i)}):n.call?l(function(){n.call.forEach(i)}):n.square?_(function(){n.square.forEach(i)}):n.block?u(function(){n.block.forEach(e)}):n.sequence&&n.sequence.forEach(function(n,t){t&&d(),s(n)})},e=function(n,t){k(),n.forEach(i),n.slice(-1)[0].block&&"="!==n[0]&&"return"!==n[0]||R(),C()},r=function(n,t){k(),s("function "+n),l(function(){t.args.forEach(function(n,t){t&&d(),s(n)})}),D(),u(function(){t.body.forEach(e)}),C()},o={abs:function(){return r("abs",{args:["n"],body:[["return","Math.abs",{call:[{sequence:["n"]}]}]]})},bind:function(){return r("_$rapyd$_bind",{args:["fn","thisArg"],body:[["if",{parens:["fn._orig"]},"fn","=","fn._orig"],["if",{parens:["thisArg","===","false"]},"return","fn"],["var","ret","=","fn.bind",{call:[{sequence:["thisArg"]}]}],["ret._orig","=","fn"],["return","ret"]]})},rebind_all:function(){return r("_$rapyd$_rebindAll",{args:["thisArg","rebind"],body:[["if",{parens:["typeof","rebind","===",'"undefined"']},"rebind","=","true"],["for",{parens:["var","p","in","thisArg"]},{block:[["if",{parens:["thisArg[p]","&&","thisArg[p]._orig"]},{block:[["if",{parens:["rebind"]},"thisArg[p]","=","_$rapyd$_bind",{call:[{sequence:["thisArg[p]","thisArg"]}]}],["else","thisArg[p]","=","thisArg[p]._orig"]]}]]}]]})},dir:function(){return r("dir",{args:["item"],body:[["var","arr","=","[]"],["for",{parens:["var","i","in","item"]},{block:[["arr.push",{call:["i"]}]]}],["return","arr"]]})},enumerate:function(){return r("enumerate",{args:["item"],body:[["var","arr","=","[]"],["for",{parens:["var","i","=","0;","i","<","item.length;","i++"]},{block:[["arr[arr.length]","=",{square:[{sequence:["i","item[i]"]}]}]]}],["return","arr"]]})},"extends":function(){var t;return n.screw_old_browsers?r("_$rapyd$_extends",{args:["child","parent"],body:[["child.prototype","=","Object.create",{call:["parent.prototype"]}],["child.prototype.constructor","=","child"]]}):(t=[["child.prototype","=","new","parent"],["child.prototype.constructor","=","child"]],n.auto_bind&&t.push(["_$rapyd$_rebindAll",{call:["child.prototype"]}]),r("_$rapyd$_extends",{args:["child","parent"],body:t}))},"in":function(){return r("_$rapyd$_in",{args:["val","arr"],body:[["if",{parens:["arr","instanceof","Array","||","typeof","arr","===",'"string"']},"return","arr.indexOf(val)","!=","-1"],["else",{block:[["if",{parens:["arr.hasOwnProperty(val)"]},"return","true"],["return","false"]]}]]})},len:function(){return r("len",{args:["obj"],body:[["if",{parens:["obj","instanceof","Array","||","typeof","obj","===",'"string"']},"return","obj.length"],["else",{block:[["var","count","=","0"],["for",{parens:["var","i","in","obj"]},{block:[["if",{parens:["obj.hasOwnProperty(i)"]},"count++"]]}],["return","count"]]}]]})},mixin:function(){return r("_$rapyd$_mixin",{args:["target","source","overwrite"],body:[["for",{parens:["var","i","in","source"]},{block:[["if",{parens:["source.hasOwnProperty(i)","&&",{parens:["overwrite","||","typeof","target[i]","===",'"undefined"']}]},"target[i]","=","source[i]"]]}]]})},print:function(){return r("_$rapyd$_print",{args:[],body:[["var",{sequence:["args","output"]}],["args","=","[].slice.call",{call:[{sequence:["arguments","0"]}]}],["output","=","JSON.stringify(args)"],["if",{parens:['"console"',"in","window"]},"console.log",{call:["output.substr",{call:[{sequence:["1","output.length-2"]}]}]}]]})},range:function(){return r("range",{args:["start","stop","step"],body:[["if",{parens:["arguments.length","<=","1"]},{block:[["stop","=","start","||","0"],["start","=","0"]]}],["step","=","arguments[2]","||","1"],["var","length","=","Math.max",{parens:["Math.ceil",{parens:[{parens:["stop","-","start"]},"/","step"]},",","0"]}],["var","idx","=","0"],["var","range","=","new","Array(length)"],["while",{parens:["idx","<","length"]},{block:[["range[idx++]","=","start"],["start","+=","step"]]}],["return","range"]]})},reversed:function(){return r("reversed",{args:["arr"],body:[["var","tmp","=","[]"],["for",{parens:["var","i","=","arr.length","-","1;","i",">=","0;","i--"]},{block:[["tmp.push",{call:["arr[i]"]}]]}],["return","tmp"]]})},getattr:function(){return r("getattr",{args:["obj","name"],body:[["return","obj[name]"]]})},setattr:function(){return r("setattr",{args:["obj","name","value"],body:[["obj[name]","=","value"]]})},hasattr:function(){return r("hasattr",{args:["obj","name"],body:[["return","name","in","obj"]]})}},o[t]()}function S(t){var i;if(!n.omit_baselib)for(i in t.baselib)m(i)}function A(){return v}function T(n){"string"==typeof n?s(n):n.print(this),D(),s("="),D()}var g,y,b,w,v,E,$,x,I,O,D,k,N,C,R,B,F;return n=defaults(n,{indent_start:0,indent_level:4,quote_keys:!1,space_colon:!0,ascii_only:!1,inline_script:!1,width:80,max_line_len:32e3,ie_proof:!0,beautify:!1,source_map:null,bracketize:!1,semicolons:!0,comments:!1,preserve_line:!1,namespace_imports:!1,omit_baselib:!1,private_scope:!0,screw_old_browsers:!1,auto_bind:!1},!0),g=0,y=0,b=1,w=0,v="",E={},$=!1,x=!1,I=null,O=makePredicate("( [ + * / - , ."),D=n.beautify?function(){s(" ")}:function(){$=!0},k=n.beautify?function(t){n.beautify&&s(o(t?.5:0))}:noop,N=n.beautify?function(n,t){var i,e;return n===!0&&(n=f()),i=g,g=n,e=t(),g=i,e}:function(n,t){return t()},C=n.beautify?function(){s("\n")}:noop,R=n.beautify?function(){s(";")}:function(){x=!0},B=n.source_map?function(t,i){try{t&&n.source_map.add(t.file||"?",b,y,t.line,t.col,i||"name"!==t.type?i:t.value)}catch(e){AST_Node.warn("Couldn't figure out mapping for {file}:{line},{col}  {cline},{ccol} [{name}]",{file:t.file,line:t.line,col:t.col,cline:b,ccol:y,name:i||""})}}:noop,F=[],{get:A,toString:A,indent:k,indentation:function(){return g},current_width:function(){return y-g},should_break:function(){return n.width&&this.current_width()>=n.width},newline:C,print:s,space:D,comma:d,colon:h,last:function(){return I},semicolon:R,force_semicolon:p,to_ascii:t,print_name:function(n){s(r(n))},print_string:function(n){s(e(n))},next_indent:f,with_indent:N,with_block:u,with_parens:l,with_square:_,add_mapping:B,assign:T,prologue:S,"import":function(n){var t,i;for(t="";n instanceof AST_Dot;)t="."+n.property+t,n=n.expression;return t=n.name+t,i=!E[t],E[t]=!0,i},is_main:function(){return 0===v.length},option:function(t){return n[t]},line:function(){return b},col:function(){return y},pos:function(){return w},push_node:function(n){F.push(n)},pop_node:function(){return F.pop()},stack:function(){return F},parent:function(n){return F[F.length-2-(n||0)]}}}!function(){function n(n,t){n.DEFMETHOD("_codegen",t)}function t(n,t){n.DEFMETHOD("needs_parens",t)}function i(n){var t;return t=n.parent(),t instanceof AST_Unary?!0:t instanceof AST_Binary&&!(t instanceof AST_Assign)?!0:t instanceof AST_BaseCall&&t.expression===this?!0:t instanceof AST_Conditional&&t.condition===this?!0:t instanceof AST_PropAccess&&t.expression===this?!0:void 0}function e(n,t,i){var e;e=n.length-1,n.forEach(function(n,r){n instanceof AST_EmptyStatement||n instanceof AST_Definitions||(i.indent(),n.print(i),r===e&&t||i.newline())})}function r(n,t){var i;for(i in n)t.indent(),t.print("this."),t.assign(i),t.print("_$rapyd$_bind"),t.with_parens(function(){t.print("this."),t.print(i),t.comma(),t.print("this")}),t.semicolon(),t.newline()}function o(n,t,i){var o,c;if(o=0,n instanceof AST_Method&&!n["static"]&&(i.indent(),i.print("var"),i.space(),i.assign(n.argnames[0]),i.print("this"),i.semicolon(),i.newline(),o+=1),n instanceof AST_Scope){if(n.argnames){n.argnames.starargs&&(n.argnames.forEach(function(n,t){t>=o&&(i.indent(),i.print("var"),i.space(),i.assign(n),i.print("arguments"),i.with_square(function(){i.print(t-o)}),i.semicolon(),i.newline())}),i.indent(),i.print("var"),i.space(),i.assign(n.argnames.starargs),i.print("[].slice.call"),i.with_parens(function(){i.print("arguments"),i.comma(),i.print(n.argnames.length-o)}),i.semicolon(),i.newline());for(c in n.argnames.defaults)i.indent(),i.print("if"),i.space(),i.with_parens(function(){i.print("typeof "+c),i.space(),i.print("==="),i.space(),i.print('"undefined"')}),i.space(),i.assign(c),h(n.argnames.defaults[c],i),i.semicolon(),i.newline()}i.option("auto_bind")&&n.name&&"__init__"===n.name.name&&(i.indent(),i.print("_$rapyd$_rebindAll"),i.with_parens(function(){i.print("this"),i.comma(),i.print("true")}),i.semicolon(),i.newline(),r(n.bound,i)),a(n.localvars,i)}else n instanceof AST_Except&&n.argname&&(i.indent(),i.print("var"),i.space(),i.assign(n.argname),i.print("_$rapyd$_Exception"),i.semicolon(),i.newline());e(n.body,t,i)}function a(n,t){n.length&&(t.indent(),t.print("var"),t.space(),n.forEach(function(n,i){i&&t.comma(),n.print(t)}),t.semicolon(),t.newline())}function c(n,t,i){n.elements.forEach(function(e,r){t.indent(),t.assign(e),t.print("_$rapyd$_Unpack"),t.with_square(function(){t.print(r)}),(!i||r<n.elements.length-1)&&(t.semicolon(),t.newline())})}function s(n,t,i){function e(n){"string"==typeof n?i.print(n):n.print(i)}i.with_parens(function(){i.print("function()"),i.with_block(function(){o(n,!1,i),i.indent(),i.print("return"),i.space(),i.with_block(function(){n.variables.forEach(function(t,r){i.indent(),e(t),i.print(":"),i.space(),e(t),r<n.variables.length-1&&i.comma(),i.newline()})}),i.semicolon(),i.newline()})}),i.print("()")}function p(n,t,i){n.body.length>0?t.with_block(function(){i?o(n,!1,t):e(n.body,!1,t)}):t.print("{}")}function f(n){return n.object instanceof AST_BaseCall&&n.object.expression instanceof AST_SymbolRef&&"dir"===n.object.expression.name&&1===n.object.args.length}function u(n){return n.object instanceof AST_BaseCall&&n.object.expression instanceof AST_SymbolRef&&"range"===n.object.expression.name&&!(n.init instanceof AST_Array)&&(n.object.args.length<3||n.object.args.slice(-1)[0]instanceof AST_Number||n.object.args.slice(-1)[0]instanceof AST_Unary&&"-"===n.object.args.slice(-1)[0].operator&&n.object.args.slice(-1)[0].expression instanceof AST_Number)}function l(n,t,i){var e;(e=function(n){n.length?(t.print(n.slice(0)[0].name),t.with_parens(function(){e(n.slice(1))})):i()})(n.decorators)}function _(n,t){var i;if(t.option("bracketize"))return void g(n.body,t);if(!n.body)return t.force_semicolon();if(n.body instanceof AST_Do&&t.option("ie_proof"))return void g(n.body,t);for(i=n.body;;)if(i instanceof AST_If){if(!i.alternative)return void g(n.body,t);i=i.alternative}else{if(!(i instanceof AST_StatementWithBody))break;i=i.body}h(n.body,t)}function d(n,t,i){if(i)try{n.walk(new TreeWalker(function(n){if(n instanceof AST_Binary&&"in"===n.operator)throw t})),n.print(t)}catch(e){var r=e;if(r!==t)throw r;n.print(t,!0)}else n.print(t)}function h(n,t){t.option("bracketize")?!n||n instanceof AST_EmptyStatement?t.print("{}"):n instanceof AST_BlockStatement?n.print(t):t.with_block(function(){t.indent(),n.print(t),t.newline()}):!n||n instanceof AST_EmptyStatement?t.force_semicolon():n.print(t)}function m(n){var t,i,e,r;for(t=n.stack(),i=t.length,e=t[i-=1],r=t[i-=1];i>0;){if(r instanceof AST_Statement&&r.body===e)return!0;if(!(r instanceof AST_Seq&&r.car===e||r instanceof AST_BaseCall&&r.expression===e||r instanceof AST_Dot&&r.expression===e||r instanceof AST_Sub&&r.expression===e||r instanceof AST_Conditional&&r.condition===e||r instanceof AST_Binary&&r.left===e||r instanceof AST_UnaryPostfix&&r.expression===e))return!1;e=r,r=t[i-=1]}}function S(n,t){return 0===n.args.length&&!t.option("beautify")}function A(n){var t,i,e;for(t=n[0],i=t.length,e=1;e<n.length;e++)n[e].length<i&&(t=n[e],i=t.length);return t}function T(n){var t,i,e;return t=n.toString(10),i=[t.replace(/^0\./,".").replace("e+","e")],e=null,Math.floor(n)===n?(n>=0?i.push("0x"+n.toString(16).toLowerCase(),"0"+n.toString(8)):i.push("-0x"+(-n).toString(16).toLowerCase(),"-0"+(-n).toString(8)),(e=/^(.*?)(0+)$/.exec(n))&&i.push(e[1]+"e"+e[2].length)):(e=/^0?\.(0+)(.*)$/.exec(n))&&i.push(e[2]+"e-"+(e[1].length+e[2].length),t.substr(t.indexOf("."))),A(i)}function g(n,t){return n instanceof AST_BlockStatement?void n.print(t):void t.with_block(function(){t.indent(),n.print(t),t.newline()})}function y(n,t){n.DEFMETHOD("add_source_map",function(n){t(this,n)})}function b(n,t){t.add_mapping(n.start)}var w,v;w={bind:"_$rapyd$_bind",rebind_all:"_$rapyd$_rebindAll",bool:"!!","float":"parseFloat","int":"parseInt",mixin:"_$rapyd$_mixin",print:"_$rapyd$_print"},v=0,AST_Node.DEFMETHOD("print",function(n,t){var i,e;i=this,e=i._codegen,n.push_node(i),t||i.needs_parens(n)?n.with_parens(function(){i.add_comments(n),i.add_source_map(n),e(i,n)}):(i.add_comments(n),i.add_source_map(n),e(i,n)),n.pop_node()}),AST_Node.DEFMETHOD("print_to_string",function(n){var t;return t=OutputStream(n),this.print(t),t.get()}),AST_Node.DEFMETHOD("add_comments",function(n){var t,i,e,r;t=n.option("comments"),i=this,t&&(e=i.start,e&&!e._comments_dumped&&(e._comments_dumped=!0,r=e.comments_before,i instanceof AST_Exit&&i.value&&i.value.start.comments_before.length>0&&(r=(r||[]).concat(i.value.start.comments_before),i.value.start.comments_before=[]),t.test?r=r.filter(function(n){return t.test(n.value)}):"function"==typeof t&&(r=r.filter(function(n){return t(i,n)})),r.forEach(function(t){"comment1"===t.type?(n.print("//"+t.value+"\n"),n.indent()):"comment2"===t.type&&(n.print("/*"+t.value+"*/"),e.nlb?(n.print("\n"),n.indent()):n.space())})))}),t(AST_Node,function(){return!1}),t(AST_Function,function(n){return m(n)}),t(AST_Object,function(n){return m(n)}),t(AST_Unary,function(n){var t;return t=n.parent(),t instanceof AST_PropAccess&&t.expression===this}),t(AST_Seq,function(n){var t;return t=n.parent(),t instanceof AST_Unary||t instanceof AST_VarDef||t instanceof AST_Dot||t instanceof AST_ObjectProperty||t instanceof AST_Conditional}),t(AST_Binary,function(n){var t,i,e,r,o;return t=n.parent(),t instanceof AST_BaseCall&&t.expression===this?!0:t instanceof AST_Unary?!0:t instanceof AST_PropAccess&&t.expression===this?!0:t instanceof AST_Binary&&(i=t.operator,e=PRECEDENCE[i],r=this.operator,o=PRECEDENCE[r],e>o||e===o&&this===t.right&&(r!==i||"*"!==r&&"&&"!==r&&"||"!==r))?!0:void 0}),t(AST_PropAccess,function(n){var t;if(t=n.parent(),t instanceof AST_New&&t.expression===this)try{this.walk(new TreeWalker(function(n){if(n instanceof AST_BaseCall)throw t}))}catch(i){var e=i;if(e!==t)throw e;return!0}}),t(AST_BaseCall,function(n){var t;return t=n.parent(),t instanceof AST_New&&t.expression===this}),t(AST_New,function(n){var t;return t=n.parent(),S(this,n)&&(t instanceof AST_PropAccess||t instanceof AST_BaseCall&&t.expression===this)?!0:void 0}),t(AST_Number,function(n){var t;return t=n.parent(),this.getValue()<0&&t instanceof AST_PropAccess&&t.expression===this?!0:void 0}),t(AST_NaN,function(n){var t;return t=n.parent(),t instanceof AST_PropAccess&&t.expression===this?!0:void 0}),t(AST_Assign,i),t(AST_Conditional,i),n(AST_Directive,function(n,t){t.print_string(n.value),t.semicolon()}),n(AST_Debugger,function(n,t){t.print("debugger"),t.semicolon()}),AST_StatementWithBody.DEFMETHOD("_do_print_body",function(n){h(this.body,n)}),n(AST_Statement,function(n,t){n.body.print(t),t.semicolon()}),n(AST_Toplevel,function(n,t){var i;i=t.is_main(),i&&n.shebang&&(t.print(n.shebang),t.newline()),t.option("private_scope")&&i?(t.with_parens(function(){t.print("function()"),t.with_block(function(){t.prologue(n),o(n,!0,t),t.newline()})}),t.print("();"),t.print("")):(i&&t.prologue(n),n.strict&&a(n.localvars,t),e(n.body,!0,t))}),n(AST_Import,function(n,t){t["import"](n.module)&&(t.option("namespace_imports")?(t.print("var"),t.space(),t.assign(n.module),s(n.body,n.variables,t),t.semicolon(),t.newline()):n.body.print(t)),t.option("namespace_imports")&&n.argnames&&n.variables.forEach(function(i){t.print("var"),t.space(),t.assign(i),n.module.print(t),t.print("."),i.print(t),t.semicolon(),t.newline()})}),n(AST_LabeledStatement,function(n,t){n.label.print(t),t.colon(),n.body.print(t)}),n(AST_SimpleStatement,function(n,t){n.body instanceof AST_EmptyStatement||(n.body.print(t),t.semicolon())}),n(AST_BlockStatement,function(n,t){p(n,t)}),n(AST_EmptyStatement,function(n,t){}),n(AST_Do,function(n,t){t.print("do"),t.space(),n._do_print_body(t),t.space(),t.print("while"),t.space(),t.with_parens(function(){n.condition.print(t)}),t.semicolon()}),n(AST_While,function(n,t){t.print("while"),t.space(),t.with_parens(function(){n.condition.print(t)}),t.space(),n._do_print_body(t)}),AST_ForIn.DEFMETHOD("_do_print_body",function(n){var t;t=this,n.with_block(function(){u(t)||f(t)||(n.indent(),t.init instanceof AST_Array?(n.assign("_$rapyd$_Unpack"),n.print("_$rapyd$_Iter"+v+"[_$rapyd$_Index"+v+"];"),n.newline(),c(t.init,n)):(n.assign(t.init),n.print("_$rapyd$_Iter"+v+"[_$rapyd$_Index"+v+"];"),n.newline()),v+=1),t.body.body.forEach(function(t,i){n.indent(),t.print(n),n.newline()})})}),n(AST_ForIn,function(n,t){var i,e,r,o,a;u(n)?(a=null,i=n.object.args,e=i.length,1===e?(r=0,o=i[0]):2===e?(r=i[0],o=i[1]):3===e&&(r=i[0],o=i[1],a=i[2]),t.print("for"),t.space(),t.with_parens(function(){t.assign(n.init),r.print?r.print(t):t.print(r),t.semicolon(),t.space(),n.init.print(t),t.space(),a instanceof AST_Unary?t.print(">"):t.print("<"),t.space(),o.print(t),t.semicolon(),t.space(),n.init.print(t),!a||a instanceof AST_Unary&&"1"===a.expression.value?a instanceof AST_Unary?t.print("--"):t.print("++"):a instanceof AST_Unary?(t.print("-="),a.expression.print(t)):(t.print("+="),a.print(t))})):f(n)?(t.print("for"),t.space(),t.with_parens(function(){n.init.print(t),t.space(),t.print("in"),t.space(),n.object.args[0].print(t)})):(t.assign("var _$rapyd$_Iter"+v),n.object.print(t),t.semicolon(),t.newline(),t.indent(),t.print("for"),t.space(),t.with_parens(function(){t.print("var"),t.space(),t.assign("_$rapyd$_Index"+v),t.print("0"),t.semicolon(),t.space(),t.print("_$rapyd$_Index"+v),t.space(),t.print("<"),t.space(),t.print("_$rapyd$_Iter"+v+".length"),t.semicolon(),t.space(),t.print("_$rapyd$_Index"+v+"++")})),t.space(),n._do_print_body(t)}),n(AST_ListComprehension,function(n,t){t.with_parens(function(){t.print("function"),t.print("()"),t.space(),t.with_block(function(){t.indent(),t.assign("var _$rapyd$_Iter"),n.object.print(t),t.comma(),t.assign("_$rapyd$_Result"),t.print("[]"),n.init instanceof AST_Array?n.init.elements.forEach(function(n){t.comma(),n.print(t)}):(t.comma(),n.init.print(t)),t.semicolon(),t.newline(),t.indent(),t.print("for"),t.space(),t.with_parens(function(){t.print("var"),t.space(),t.assign("_$rapyd$_Index"),t.print("0"),t.semicolon(),t.space(),t.print("_$rapyd$_Index"),t.space(),t.print("<"),t.space(),t.print("_$rapyd$_Iter.length"),t.semicolon(),t.space(),t.print("_$rapyd$_Index++")}),t.space(),t.with_block(function(){var i;t.indent(),n.init instanceof AST_Array?(t.assign("_$rapyd$_Unpack"),t.print("_$rapyd$_Iter[_$rapyd$_Index];"),t.newline(),c(n.init,t)):(t.assign(n.init),t.print("_$rapyd$_Iter[_$rapyd$_Index];"),t.newline()),i=function(){t.indent(),t.print("_$rapyd$_Result.push"),t.with_parens(function(){n.statement.print(t)}),t.semicolon(),t.newline()},n.condition?(t.indent(),t.print("if"),t.space(),t.with_parens(function(){n.condition.print(t)}),t.space(),t.with_block(function(){i()}),t.newline()):i()}),t.newline(),t.indent(),t.print("return _$rapyd$_Result"),t.semicolon(),t.newline()})}),t.print("()")}),n(AST_With,function(n,t){t.print("with"),t.space(),t.with_parens(function(){n.expression.print(t)}),t.space(),n._do_print_body(t)}),AST_Lambda.DEFMETHOD("_do_print",function(n,t){function i(){t||n.print("function"),e.name&&(n.space(),e.name.print(n)),n.with_parens(function(){e.argnames.starargs||e.argnames.forEach(function(t,i){i&&n.comma(),t.print(n)})}),n.space(),p(e,n,!0)}var e;e=this,e.decorators&&e.decorators.length?(n.assign(e.name.name),l(e,n,i),n.semicolon()):i()}),n(AST_Lambda,function(n,t){n._do_print(t)}),AST_Class.DEFMETHOD("_do_print",function(n){function t(){i.init||i.parent?(n.print("function"),n.space(),i.name.print(n),n.print("()"),n.space(),n.with_block(function(){r(i.bound,n),n.indent(),i.init?n.print("this"):(i.parent.print(n),n.print(".prototype")),n.print(".__init__.apply"),n.with_parens(function(){n.print("this"),n.comma(),n.print("arguments")}),n.semicolon(),n.newline()})):(n.print("function"),n.space(),i.name.print(n),n.print("()"),n.space(),n.with_block(function(){r(i.bound,n)}))}var i,e,o;i=this,i.external||(e=function(t){n.indent(),i.name.print(n),t&&-1!==i["static"].indexOf(t)?n.assign("."+t):n.assign(".prototype"+(t?"."+t:""))},o=function(t){function r(){n.print("function"),n.space(),n.print(o),n.with_parens(function(){t.argnames.starargs||t.argnames.forEach(function(t,e){-1!==i["static"].indexOf(o)&&(e+=1),e>1&&n.comma(),e&&t.print(n)})}),p(t,n,!0)}var o;o=t.name.name,e(o),t.decorators&&t.decorators.length?l(t,n,r):r(),n.semicolon(),n.newline()},i.decorators&&i.decorators.length?(n.print("var "),n.assign(i.name),l(i,n,t),n.semicolon()):t(),n.newline(),i.parent&&(n.indent(),n.print("_$rapyd$_extends"),n.with_parens(function(){i.name.print(n),n.comma(),i.parent.print(n)}),n.semicolon(),n.newline()),i.body.forEach(function(n,t){n instanceof AST_Method?o(n):n instanceof AST_Class&&console.error("Nested classes aren't supported yet")}))}),n(AST_Class,function(n,t){n._do_print(t)}),AST_Module.DEFMETHOD("_do_print",function(n){function t(){s(i,i.variables,n)}var i;i=this,i.external||(n.print("var"),n.space(),n.assign(i.name),l(i,n,t),n.semicolon(),n.newline())}),n(AST_Module,function(n,t){n._do_print(t)}),AST_Exit.DEFMETHOD("_do_print",function(n,t){var i;i=this,n.print(t),i.value&&(n.space(),i.value.print(n)),n.semicolon()}),n(AST_Return,function(n,t){n._do_print(t,"return")}),n(AST_Throw,function(n,t){n._do_print(t,"throw")}),AST_LoopControl.DEFMETHOD("_do_print",function(n,t){n.print(t),this.label&&(n.space(),this.label.print(n)),n.semicolon()}),n(AST_Break,function(n,t){n._do_print(t,"break")}),n(AST_Continue,function(n,t){n._do_print(t,"continue")}),n(AST_If,function(n,t){t.print("if"),t.space(),t.with_parens(function(){n.condition.print(t)}),t.space(),n.alternative?(_(n,t),t.space(),t.print("else"),t.space(),h(n.alternative,t)):n._do_print_body(t)}),n(AST_Switch,function(n,t){t.print("switch"),t.space(),t.with_parens(function(){n.expression.print(t)}),t.space(),n.body.length>0?t.with_block(function(){n.body.forEach(function(n,i){i&&t.newline(),t.indent(!0),n.print(t)})}):t.print("{}")}),AST_SwitchBranch.DEFMETHOD("_do_print_body",function(n){this.body.length>0&&(n.newline(),this.body.forEach(function(t){n.indent(),t.print(n),n.newline()}))}),n(AST_Default,function(n,t){t.print("default:"),n._do_print_body(t)}),n(AST_Case,function(n,t){t.print("case"),t.space(),n.expression.print(t),t.print(":"),n._do_print_body(t)}),n(AST_Try,function(n,t){t.print("try"),t.space(),p(n,t),n.bcatch&&(t.space(),n.bcatch.print(t)),n.bfinally&&(t.space(),n.bfinally.print(t))}),n(AST_Catch,function(n,t){t.print("catch"),t.space(),t.with_parens(function(){t.print("_$rapyd$_Exception")}),t.space(),n.body.length>1||n.body[0].errors.length?t.with_block(function(){var i;t.indent(),i=!0,n.body.forEach(function(n,i){var e;i&&t.print("else "),n.errors.length?(t.print("if"),t.space(),t.with_parens(function(){n.errors.forEach(function(n,i){i&&(t.newline(),t.indent(),t.print("||"),t.space()),t.print("_$rapyd$_Exception"),t.space(),t.print("instanceof"),t.space(),n.print(t)})}),t.space()):e=!1,p(n,t,!0),t.space()}),i&&(t.print("else"),t.space(),t.with_block(function(){t.indent(),t.print("throw"),t.space(),t.print("_$rapyd$_Exception"),t.semicolon(),t.newline()})),t.newline()}):p(n.body[0],t,!0)}),n(AST_Finally,function(n,t){t.print("finally"),t.space(),p(n,t)}),AST_Definitions.DEFMETHOD("_do_print",function(n,t){var i,e,r;n.print(t),n.space(),this.definitions.forEach(function(t,i){i&&n.comma(),t.print(n)}),i=n.parent(),e=i instanceof AST_ForIn,r=e&&i.init===this,r||n.semicolon()}),n(AST_Var,function(n,t){n._do_print(t,"var")}),n(AST_Const,function(n,t){n._do_print(t,"const")}),n(AST_VarDef,function(n,t){var i,e;n.name.print(t),n.value&&(t.assign(""),i=t.parent(1),e=i instanceof AST_ForIn,d(n.value,t,e))}),n(AST_BaseCall,function(n,t){var i,e,r,o;n instanceof AST_ClassCall?n["static"]?(n["class"].print(t),t.print("."),t.print(n.method)):(n["class"].print(t),t.print(".prototype."),t.print(n.method),t.print(".call")):(i=w.hasOwnProperty(n.expression.name)?w[n.expression.name]:void 0,i?t.print(i):n.expression.print(t)),n instanceof AST_New&&S(n,t)||(e=function(){n.args.kwargs&&n.args.kwargs.length&&(n.args.length&&t.comma(),t.print("{"),n.args.kwargs.forEach(function(n,i){i&&t.comma(),n[0].print(t),t.print(":"),t.space(),n[1].print(t)}),t.print("}"))},n.args.starargs?(r=n.expression.expression?n.expression.expression.name:"this",o=n.args.length-1,t.print(".apply"),t.with_parens(function(){t.print(r),t.comma(),t.with_square(function(){n.args.forEach(function(n,i){i!==o&&(i&&t.comma(),n.print(t))}),e()}),t.print(".concat"),t.with_parens(function(){n.args[o].print(t)})})):t.with_parens(function(){n.args.forEach(function(n,i){i&&t.comma(),n.print(t)}),e()}))}),n(AST_New,function(n,t){t.print("new"),t.space(),AST_BaseCall.prototype._codegen(n,t)}),AST_Seq.DEFMETHOD("_do_print",function(n){var t,i,e;t=this,i=n.parent(),e=function(){t.car.print(n),t.cdr&&(n.comma(),n.should_break()&&(n.newline(),n.indent()),t.cdr.print(n))},i instanceof AST_Binary||i instanceof AST_Return||i instanceof AST_Array||i instanceof AST_BaseCall||i instanceof AST_SimpleStatement?n.with_square(e):e()}),n(AST_Seq,function(n,t){n._do_print(t)}),n(AST_Dot,function(n,t){var i;i=n.expression,i.print(t),i instanceof AST_Number&&i.getValue()>=0&&(/[xa-f.]/i.test(t.last())||t.print(".")),t.print("."),t.add_mapping(n.end),t.print_name(n.property)}),n(AST_Sub,function(n,t){n.expression.print(t),t.print("["),n.property instanceof AST_Unary&&"-"===n.property.operator&&n.property.expression instanceof AST_Number&&(n.expression.print(t),t.print(".length")),n.property.print(t),t.print("]")}),n(AST_UnaryPrefix,function(n,t){var i;i=n.operator,t.print(i),/^[a-z]/i.test(i)&&t.space(),n.expression.print(t)}),n(AST_UnaryPostfix,function(n,t){n.expression.print(t),t.print(n.operator)}),n(AST_Binary,function(n,t){var i,e,r;i={"<":!0,">":!0,"<=":!0,">=":!0,"==":!0,"!=":!0},e={"in":"_$rapyd$_in","**":"Math.pow"},_$rapyd$_in(n.operator,e)?(t.print(e[n.operator]),t.with_parens(function(){n.left.print(t),t.comma(),n.right.print(t)})):i[n.operator]&&n.left instanceof AST_Binary&&i[n.left.operator]?(n.left.right instanceof AST_Symbol?(n.left.print(t),r=n.left.right.name):(n.left.left.print(t),t.space(),t.print(n.left.operator),t.space(),t.with_parens(function(){t.assign("_$rapyd$_Temp"),n.left.right.print(t),r="_$rapyd$_Temp"})),t.space(),t.print("&&"),t.space(),t.print(r),t.space(),t.print(n.operator),t.space(),n.right.print(t)):(n.left.print(t),t.space(),t.print(n.operator),t.space(),n.right.print(t))}),n(AST_Assign,function(n,t){n.left instanceof AST_Array?t.print("_$rapyd$_Unpack"):n.left.print(t),t.space(),t.print(n.operator),t.space(),n.right.print(t),n.left instanceof AST_Array&&(t.semicolon(),t.newline(),c(n.left,t,!0))}),n(AST_Conditional,function(n,t){n.condition.print(t),t.space(),t.print("?"),t.space(),n.consequent.print(t),t.space(),t.colon(),n.alternative.print(t)}),n(AST_Array,function(n,t){t.with_square(function(){var i,e;i=n.elements,e=i.length,e>0&&t.space(),i.forEach(function(n,i){i&&t.comma(),n.print(t)}),e>0&&t.space()})}),n(AST_Object,function(n,t){n.properties.length>0?t.with_block(function(){n.properties.forEach(function(n,i){i&&(t.print(","),t.newline()),t.indent(),n.print(t)}),t.newline()}):t.print("{}")}),n(AST_ObjectKeyVal,function(n,t){var i;i=n.key,n.quoted?t.print_string(i+""):("number"==typeof i||!t.option("beautify")&&+i+""===i)&&parseFloat(i)>=0?t.print(T(i)):is_identifier(i)?t.print_name(i):t.print_string(i),t.colon(),n.value.print(t)}),n(AST_ObjectSetter,function(n,t){t.print("set"),n.value._do_print(t,!0)}),n(AST_ObjectGetter,function(n,t){t.print("get"),n.value._do_print(t,!0)}),AST_Symbol.DEFMETHOD("definition",function(){return this.thedef}),n(AST_Symbol,function(n,t){var i;i=n.definition(),t.print_name(i?i.mangled_name||i.name:n.name);
}),n(AST_Undefined,function(n,t){t.print("void 0")}),n(AST_Hole,noop),n(AST_Infinity,function(n,t){t.print("1/0")}),n(AST_NaN,function(n,t){t.print("0/0")}),n(AST_This,function(n,t){t.print("this")}),n(AST_Constant,function(n,t){t.print(n.getValue())}),n(AST_String,function(n,t){t.print_string(n.getValue())}),n(AST_Verbatim,function(n,t){t.print(n.getValue())}),n(AST_Number,function(n,t){t.print(T(n.getValue()))}),n(AST_RegExp,function(n,t){var i,e;i=n.getValue().toString(),t.option("ascii_only")&&(i=t.to_ascii(i)),t.print(i),e=t.parent(),e instanceof AST_Binary&&/^in/.test(e.operator)&&e.left===n&&t.print(" ")}),y(AST_Node,noop),y(AST_Directive,b),y(AST_Debugger,b),y(AST_Symbol,b),y(AST_Jump,b),y(AST_StatementWithBody,b),y(AST_LabeledStatement,noop),y(AST_Lambda,b),y(AST_Switch,b),y(AST_SwitchBranch,b),y(AST_BlockStatement,b),y(AST_Toplevel,noop),y(AST_New,b),y(AST_Try,b),y(AST_Catch,b),y(AST_Finally,b),y(AST_Definitions,b),y(AST_Constant,b),y(AST_ObjectProperty,function(n,t){t.add_mapping(n.start,n.key)})}();
function is_letter(u){return u>=97&&122>=u||u>=65&&90>=u||u>=170&&UNICODE.letter.test(String.fromCharCode(u))}function is_digit(u){return u>=48&&57>=u}function is_alphanumeric_char(u){return is_digit(u)||is_letter(u)}function is_unicode_combining_mark(u){return UNICODE.non_spacing_mark.test(u)||UNICODE.space_combining_mark.test(u)}function is_unicode_connector_punctuation(u){return UNICODE.connector_punctuation.test(u)}function is_identifier(u){return!RESERVED_WORDS(u)&&/^[a-z_$][a-z0-9_$]*$/i.test(u)}function is_identifier_start(u){return 36===u||95===u||is_letter(u)}function is_identifier_char(u){var e;return e=u.charCodeAt(0),is_identifier_start(e)||is_digit(e)||8204===e||8205===e||is_unicode_combining_mark(u)||is_unicode_connector_punctuation(u)}function parse_js_number(u){return RE_HEX_NUMBER.test(u)?parseInt(u.substr(2),16):RE_OCT_NUMBER.test(u)?parseInt(u.substr(1),8):RE_DEC_NUMBER.test(u)?parseFloat(u):void 0}function JS_Parse_Error(u,e,n,t){this.message=u,this.line=e,this.col=n,this.pos=t,this.stack=(new Error).stack}function js_error(u,e,n,t,r){throw AST_Node.warn("ERROR: {message} [{file}:{line},{col}]",{message:u,file:e,line:n,col:t}),new JS_Parse_Error(u,n,t,r)}function is_token(u,e,n){return u.type===e&&(null===n||void 0===n||u.value===n)}function tokenizer(u,e){function n(){return h.text.charAt(h.pos)}function t(){return h.text.charAt(h.tokpos-1)}function r(u,e){var n;if(n=h.text.charAt(h.pos),h.pos+=1,u&&!n)throw EX_EOF;return"\n"===n?(h.newline_before=h.newline_before||!e,h.line+=1,h.col=0):h.col+=1,n}function o(u,e){var n;if(n=h.text.indexOf(u,h.pos),e&&-1===n)throw EX_EOF;return n}function i(){h.tokline=h.line,h.tokcol=h.col,h.tokpos=h.pos}function a(u,n,t,r){var i,a;if(h.regex_allowed="operator"===u&&!UNARY_POSTFIX[n]||"keyword"===u&&KEYWORDS_BEFORE_EXPRESSION(n)||"punc"===u&&PUNC_BEFORE_EXPRESSION(n),"operator"===u&&"is"===n&&"not"===h.text.substr(h.pos).trimLeft().substr(0,4).trimRight()&&(F(),n="!=="),"operator"===u&&OP_MAP[n]&&(n=OP_MAP[n]),i={type:u,value:n,line:h.tokline,col:h.tokcol,pos:h.tokpos,endpos:h.pos,nlb:h.newline_before,file:e},!t)for(i.comments_before=h.comments_before,h.comments_before=[],a=0;a<len(i.comments_before);a++)i.nlb=i.nlb||i.comments_before[a].nlb;return r||(h.newline_before=!1),"punc"===u&&(":"!==n||h.index_or_slice.slice(-1)[0]||h.text.substring(h.pos+1,o("\n")).trim()&&h.text.substring(h.pos+1,o("#")).trim()||(h.newblock=!0,h.indentation_matters.push(!0)),"["===n?(h.prev&&"name"===h.prev.type?h.index_or_slice.push(!0):h.index_or_slice.push(!1),h.indentation_matters.push(!1)):"{"===n||"("===n?h.indentation_matters.push(!1):"]"===n?(h.index_or_slice.pop(),h.indentation_matters.pop()):"}"!==n&&")"!==n||h.indentation_matters.pop()),h.prev=new AST_Token(i),h.prev}function s(){var u,e,t;for(t="",u=!1;WHITESPACE_CHARS(n());)u=!0,e=r(),"\n"===e?t="":t+=e;return"#"!==n()&&(u?h.cached_whitespace=t:t=h.cached_whitespace,h.newline_before||h.endblock)?c(t):void 0}function c(u){var e;return e=h.whitespace_before[h.whitespace_before.length-1]||"",h.endblock=!1,h.indentation_matters.slice(-1)[0]&&u!==e?h.newblock&&u&&0===u.indexOf(e)?(h.newblock=!1,h.whitespace_before.push(u),1):e&&0===e.indexOf(u)?(h.endblock=!0,h.whitespace_before.pop(),-1):void A("Inconsistent indentation"):0}function l(u){var e,t;for(t="",e=0;(ch=n())&&u(ch,e);)e+=1,t+=r();return t}function A(u){js_error(u,e,h.tokline,h.tokcol,h.tokpos)}function f(u){var e,n,t,r,o,i;return e=!1,n=!1,t=!1,r="."===u,o=l(function(o,i){var a,s;return a=o.charCodeAt(0),s=a,120===s||88===s?t?!1:t=!0:101===s||69===s?t?!0:e?!1:e=n=!0:45===s?n||0===i&&!u:43===s?n:46===s?(n=!1,r||t||e?!1:r=!0):is_alphanumeric_char(a)}),u&&(o=u+o),i=parse_js_number(o),isNaN(i)?void A("Invalid syntax: "+o):a("num",i)}function _(u,e){var n,t;return e=e||function(u){return r(!0,u)},n=e(u),t=n.charCodeAt(0),110===t?"\n":114===t?"\r":116===t?"	":98===t?"\b":118===t?"\x0B":102===t?"\f":48===t?"\x00":120===t?String.fromCharCode(p(2,e)):117===t?String.fromCharCode(p(4,e)):10===t?"":n}function p(u,e){var n,t,r;for(t=0,r=0;u>r;r++)n=parseInt(e(),16),isNaN(n)&&A("Invalid hex-character pattern in string"),t=t<<4|n;return t}function d(u){"undefined"==typeof u&&(u=!1);var e,n;return u||r(),e=o("\n"),-1===e?(n=h.text.substr(h.pos),h.pos=h.text.length):(n=h.text.substring(h.pos,e),h.pos=e),a(u?"shebang":"comment1",n,!0)}function E(){var u,e,t,o,i;for(t=!1,i="",u=!1;null!==(e=n());)if(t)"u"!==e&&A("Expecting UnicodeEscapeSequence -- uXXXX"),e=_(),is_identifier_char(e)||A("Unicode char: "+e.charCodeAt(0)+" is not valid in identifier"),i+=e,t=!1;else if("\\"===e){if("\n"===h.text.charAt(h.pos+1)){h.pos+=2;continue}u=[t=!0,r()]}else{if(!is_identifier_char(e))break;i+=r()}return KEYWORDS(i)&&u&&(o=i.charCodeAt(0).toString(16).toUpperCase(),i="\\u"+"0000".substr(o.length)+o+i.slice(1)),i}function C(u){function e(u){var t;return n()?(t=u+n(),OPERATORS(t)?(r(),e(t)):u):u}var t;return t=e(u||r()),_$rapyd$_in(t,["++","--","===","!=="])&&A("Invalid operator "+t+""),a("operator",t)}function S(){return r(),h.regex_allowed?v(""):C("/")}function B(){return r(),is_digit(n().charCodeAt(0))?f("."):a("punc",".")}function m(){var u;return u=E(),KEYWORDS_ATOM(u)?a("atom",u):KEYWORDS(u)?OPERATORS(u)&&"."!==t()?a("operator",u):a("keyword",u):a("name",u)}function D(u,e){return function(n){try{return e(n)}catch(t){var r=t;if(r!==EX_EOF)throw t;A(u)}}}function F(u){var e,t,o,c,l;return _$rapyd$_in(u,[null,void 0])?(e=s(),-1===e?a("punc","}",!1,!0):(i(),(t=n())?(o=t.charCodeAt(0),c=o,34===c||39===c?T():35===c?0===h.pos&&"!"===h.text.charAt(1)?d(!0):(l=h.regex_allowed,h.comments_before.push(d()),h.regex_allowed=l,F()):46===c?B():47===c?S():is_digit(o)?f():PUNC_CHARS(t)?a("punc",r()):OPERATOR_CHARS(t)?C():92===o&&"\n"===h.text.charAt(h.pos+1)?(r(),r(),h.newline_before=!1,F()):92===o||is_identifier_start(o)?m():void A("Unexpected character "+t+"")):a("eof"))):v(u)}var h,T,b,v;return h={text:u.replace(/\r\n?|[\n\u2028\u2029]/g,"\n").replace(/\uFEFF/g,""),filename:e,pos:0,tokpos:0,line:1,tokline:0,col:0,tokcol:0,newline_before:!1,regex_allowed:!1,comments_before:[],whitespace_before:[],newblock:!1,endblock:!1,indentation_matters:[!0],cached_whitespace:"",prev:void 0,index_or_slice:[!1]},T=D("Unterminated string constant",function(){var u,e,t,i,s,c,f,p;if(u=r(),p="",n()===u){if(r(!0),n()!==u)return a("string","");if(r(!0),e=o(u+u+u,!0),-1!==e){for(t=h.text.substring(h.pos,e),h.pos=e+3;t.length;)"\\"===t[0]?(t=t.substr(1),p+=_(!0,function(){var u;return u=t[0],t=t.substr(1),u})):(p+=t[0],t=t.substr(1));return i=p.match(/\n/g),i&&(h.line+=i.length),a("string",p)}}for(;;){if(f=r(!0),"\n"===f&&A("End of line while scanning string literal."),"\\"===f)if(s=0,c=null,f=l(function(u){if(u>="0"&&"7">=u){if(!c)return c=u,s+=1;if("3">=c&&2>=s)return s+=1;if(c>="4"&&1>=s)return s+=1}return!1}),s>0)f=String.fromCharCode(parseInt(f,8));else{if("\n"===n()){r(!0);continue}f=_(!0)}else if(f===u)break;p+=f}return a("string",p)}),b=D("Unterminated multiline comment",function(){var u,e,n,t;return r(),u=o("*/",!0),e=h.text.substring(h.pos,u),n=e.split("\n"),t=n.length,h.pos=u+2,h.line+=t-1,t>1?h.col=n[t-1].length:h.col+=n[t-1].length,h.col+=2,h.newline_before=h.newline_before||e.indexOf("\n")>=0,a("comment2",e,!0)}),v=D("Unterminated regular expression",function(u){var e,n,t;for(n=!1,e=!1;ch=r(!0);)if(n)u+="\\"+ch,n=!1;else if("["===ch)e=!0,u+=ch;else if("]"===ch&&e)e=!1,u+=ch;else{if("/"===ch&&!e)break;"\\"===ch?n=!0:u+=ch}return t=E(),a("regexp",new RegExp(u,t))}),F.context=function(u){return u&&(h=u),h},F}function parse(u,e){function n(u,e){return is_token(L.token,u,e)}function t(){return L.peeked||(L.peeked=L.input())}function r(){return L.prev=L.token,L.peeked?(L.token=L.peeked,L.peeked=null):L.token=L.input(),L.in_directives=L.in_directives&&("string"===L.token.type||n("punc",";")),L.token}function o(){return L.prev}function i(u,e,n,t){var r;r=L.input.context(),js_error(u,r.filename,void 0!==e?e:r.tokline,void 0!==n?n:r.tokcol,void 0!==t?t:r.tokpos)}function a(u,e){i(e,u.line,u.col)}function s(u){void 0===u&&(u=L.token),a(u,"Unexpected token: "+u.type+" "+u.value+"")}function c(u,e){return n(u,e)?r():void a(L.token,"Unexpected token "+L.token.type+" "+L.token.value+", expected "+u+" "+e+"")}function l(u){return c("punc",u)}function A(){return!e.strict&&(L.token.nlb||n("eof")||n("punc","}"))}function f(){n("punc",";")&&(r(),L.token.nlb=!0)}function _(){var u;return l("("),u=su(!0),l(")"),u}function p(u){return function(){var e,n,t;return e=L.token,n=u(),t=o(),n.start=e,n.end=t,n}}function d(u){var e;return e={"<":!0,">":!0,"<=":!0,">=":!0,"==":!0,"!=":!0,"===":!0,"!==":!0},!!(u instanceof AST_Binary&&_$rapyd$_in(u.operator,e)&&u.left instanceof AST_Binary&&_$rapyd$_in(u.left.operator,e))}function E(u,e){var n,t;if(t=[],u instanceof Array)for(n in u)u[n]instanceof AST_Scope?e&&u[n].name&&t.push(u[n].name):(["body","alternative"].forEach(function(r){var o;o=u[n][r],o&&(t=t.concat(E(o,e))),o instanceof AST_Assign&&!(o.right instanceof AST_Scope)&&(t=t.concat(E(o.right,e)))}),e||(u[n]instanceof AST_ForIn?u[n].init instanceof AST_Array?(t.push("_$rapyd$_Unpack"),u[n].init.elements.forEach(function(u){-1===t.indexOf(u.name)&&t.push(u.name)})):-1===t.indexOf(u[n].init.name)&&t.push(u[n].init.name):u[n]instanceof AST_DWLoop?t=t.concat(E(u[n],e)):u[n]instanceof AST_If&&d(u[n].condition)?t.push("_$rapyd$_Temp"):u[n]instanceof AST_Exit&&d(u[n].value)&&t.push("_$rapyd$_Temp")));else u.body?(t=t.concat(E(u.body,e)),u.alternative&&(t=t.concat(E(u.alternative,e)))):u instanceof AST_Assign?(u.left instanceof AST_Array?(t.push("_$rapyd$_Unpack"),u.left.elements.forEach(function(u){u instanceof AST_PropAccess||-1!==t.indexOf(u.name)||t.push(u.name)})):u.left.name&&-1===t.indexOf(u.left.name)&&t.push(u.left.name),d(u.right)?t.push("_$rapyd$_Temp"):u.right instanceof AST_Conditional&&d(u.right.condition)&&t.push("_$rapyd$_Temp")):u instanceof AST_Conditional&&d(u.condition)?t.push("_$rapyd$_Temp"):d(u)&&t.push("_$rapyd$_Temp");return t}function C(u){var e,n;if(n=[],u instanceof Array)for(e in u)u[e]instanceof AST_Scope||(u[e]instanceof AST_Definitions&&u[e].definitions.forEach(function(u){n.push(u.name.name)}),["body","alternative"].forEach(function(t){var r;r=u[e][t],r&&(n=n.concat(C(r)))}));else u.body&&(n=n.concat(C(u.body)),u.alternative&&(n=n.concat(C(u.alternative))));return n}function S(u){var e,n,t;e=T(u.body.body);for(n in e)e[n]instanceof j?L.module_tree[n]=e[n]:L.classes[0][n]=e[n];for(t="";u instanceof AST_Dot;)t="."+u.property+t,u=u.expression;return t=u.name+t,IMPORTED[t]=!0,u}function B(){var u,e;return u=P(AST_Label),find_if(function(e){return e.name===u.name},L.labels)&&i("Label "+u.name+" defined twice"),l(":"),L.labels.push(u),e=V(),L.labels.pop(),new AST_LabeledStatement({body:e,label:u})}function m(u){return u=su(!0),f(),new AST_SimpleStatement({body:u})}function D(u){var e;return e=null,A()||(e=P(AST_LabelRef,!0)),null!==e?find_if(function(u){return u.name===e.name},L.labels)||i("Undefined label "+e.name):0===L.in_loop&&i(u.TYPE+" not inside a loop or switch"),f(),new u({label:e})}function F(u){var e,t,o;if(o=null,!n("punc",";")){if(o=su(!0,!0),o instanceof AST_Seq){for(e=[],t=o;t&&t.car;)e.push(t.car),t=t.cdr;e.push(t),o=new AST_Array({start:o.start,elements:e,end:o.end})}if(n("operator","in"))return o instanceof AST_Var&&o.definitions.length>1&&i("Only one variable declaration allowed in for..in loop"),r(),h(o,u)}s()}function h(u,e){var n,t;return n=u instanceof AST_Var?u.definitions[0].name:null,t=su(!0),e?{init:u,name:n,object:t}:new AST_ForIn({init:u,name:n,object:t,body:Y(V)})}function T(u){var e,n,t;e=new j;for(t in u)n=u[t],n instanceof AST_Class?e[n.name.name]={"static":n["static"],bound:n.bound}:n instanceof AST_Module&&(e[n.name.name]=T(n.body));return e}function b(u){var e,n,t,r,o;if(u instanceof AST_SymbolRef){if(NATIVE_CLASSES.hasOwnProperty(u.name))return NATIVE_CLASSES[u.name];for(e=L.classes.length-1;e>-1;e-=1)if(L.classes[e].hasOwnProperty(u.name))return L.classes[e][u.name]}else if(u instanceof AST_Dot){for(n=[];u instanceof AST_Dot;)n.unshift(u.property),u=u.expression;if(u instanceof AST_SymbolRef)for(n.unshift(u.name),t=L.module_stack.slice(),t.unshift("");t.length;){for(o=L.module_tree,t.forEach(function(u){_$rapyd$_in(u,o)&&(o=o[u])}),r=n.slice();r&&o[r[0]];)o=o[r[0]],r.shift();if(!r.length)return o instanceof j?!1:o;t.pop()}}return!1}function v(){var u,e,t;return u=su(!0),e=V(),t=null,(n("keyword","elif")||n("keyword","else"))&&(n("keyword","else")?r():L.token.value="if",t=V()),new AST_If({condition:u,body:e,alternative:t})}function y(){var u;if(l(":"),u=[],L.token.nlb){for(;!n("punc","}");){if(n("eof"))return u;u.push(V())}r()}else for(;!L.token.nlb;)n("eof")&&s(),u.push(V());return u}function w(){var u,e,t;for(l("{"),u=[],e=null,t=null;!n("punc","}");)n("eof")&&s(),n("keyword","case")?(t&&(t.end=o()),e=[],t=new AST_Case({start:tmp=[L.token,r(),tmp],expression:su(!0),body:e}),u.push(t),l(":")):n("keyword","default")?(t&&(t.end=o()),e=[],t=new AST_Default({start:tmp=[L.token,r(),l(":"),tmp],body:e}),u.push(t)):(e||s(),e.push(V()));return t&&(t.end=o()),r(),u}function g(){var u,e,t,a,s,c;for(u=y(),e=[],c=null;n("keyword","except");){if(s=L.token,r(),t=[],!n("punc",":")&&!n("keyword","as"))for(t.push(P(AST_SymbolVar));n("punc",",");)r(),t.push(P(AST_SymbolVar));a=null,n("keyword","as")&&(r(),a=P(AST_SymbolCatch)),e.push(new AST_Except({start:s,argname:a,errors:t,body:y(),end:o()}))}return n("keyword","finally")&&(s=L.token,r(),c=new AST_Finally({start:s,body:y(),end:o()})),e.length||c||i("Missing except/finally blocks"),new AST_Try({body:u,bcatch:e.length?new AST_Catch({body:e}):null,bfinally:c})}function k(u,e){var t;for(t=[];;){if(t.push(new AST_VarDef({start:L.token,name:P(e?AST_SymbolConst:AST_SymbolVar),value:n("operator","=")?(r(),su(!1,u)):null,end:o()})),!n("punc",","))break;r()}return t}function R(){var u,e,n,t;return u=L.token,e=u.type,"name"===e?P(AST_SymbolRef):("num"===e?t=new AST_Number({start:u,end:u,value:u.value}):"string"===e?t=new AST_String({start:u,end:u,value:u.value}):"regexp"===e?t=new AST_RegExp({start:u,end:u,value:u.value}):"atom"===e&&(n=u.value,"False"===n?t=new AST_False({start:u,end:u}):"True"===n?t=new AST_True({start:u,end:u}):"None"===n&&(t=new AST_Null({start:u,end:u}))),r(),t)}function O(u,e,t,i){var s,c,A,f,_,p,d;for(s=!0,d=[],c=!1;!n("punc",u)&&(c&&a(o(),"*args must be the last argument in a function call"),s?s=!1:l(","),!e||!n("punc",u));)n("operator","*")&&i&&(c=!0,r()),n("punc",",")&&t?d.push(new AST_Hole({start:L.token,end:L.token})):d.push(su(!1));if(i){A=[],A.kwargs=[];for(var E=enumerate(d),C=0;C<E.length;C++)f=E[C],_=f[0],p=f[1],p instanceof AST_Assign?A.kwargs.push([p.left,p.right]):A.push(p);d=A}return r(),c&&(d.starargs=!0),d}function x(){return O(")",!1,!1,!0)}function I(){var u,e;return u=L.token,r(),e=u.type,"num"===e||"string"===e||"name"===e||"operator"===e||"keyword"===e||"atom"===e?u:void s()}function N(){var u,e;return u=L.token,r(),e=u.type,"name"===e||"operator"===e||"keyword"===e||"atom"===e?u.value:void s()}function P(u,e){var t,o;return n("name")?(t=L.token.value,o=new("this"===t?AST_This:u)({name:String(L.token.value),start:L.token,end:L.token}),r(),o):(e||i("Name expected"),null)}function U(u,e){var n;return n=new("this"===e?AST_This:u)({name:String(e),start:null,end:null})}function M(u,e){return!(!u["static"]||-1===u["static"].indexOf(e))}function $(u,e,n){return new u({operator:e,expression:n})}function W(u){return ou(ru(!0),0,u)}function X(u){var n;return e.strict?(n=u[0]+"","dot"===n||"sub"===n||"new"===n||"call"===n?!0:"name"===n?"this"!==u[1]:void 0):!0}function Y(u){var e;return L.in_loop+=1,e=u(),L.in_loop-=1,e}var L,V,K,H,j,q,G,z,J,Q,Z,uu,eu,nu,tu,ru,ou,iu,au,su;return e=defaults(e,{strict:!1,filename:null,auto_bind:!1,toplevel:null}),L={input:"string"==typeof u?tokenizer(u,e.filename):u,token:null,prev:null,peeked:null,in_function:0,in_directives:!0,in_loop:0,in_class:[!1],classes:[{}],labels:[],decorators:[],module_tree:{},module_stack:[]},L.token=r(),V=p(function(){var u,a,p,d,E,C,h;if((n("operator","/")||n("operator","/="))&&(L.peeked=null,L.token=L.input(L.token.value.substr(1))),p=L.token.type,"string"===p)return u=L.in_directives,a=m(),u&&a.body instanceof AST_String&&!n("punc",",")?new AST_Directive({value:a.body.value}):a;if("shebang"===p)return p=L.token.value,r(),new AST_Directive({value:p});if("num"===p||"regexp"===p||"operator"===p||"atom"===p)return m();if("punc"===p){if(p=L.token.value,":"===p)return new AST_BlockStatement({start:L.token,body:y(),end:o()});if("{"===p||"["===p||"("===p)return m();if(";"===p)return r(),new AST_EmptyStatement;s()}else{if("name"===p)return is_token(t(),"punc",":")?B():m();if("keyword"===p){if(p=L.token.value,r(),"break"===p)return D(AST_Break);if("continue"===p)return D(AST_Continue);if("debugger"===p)return f(),new AST_Debugger;if("do"===p)return new AST_Do({body:Y(V),condition:function(){var u;return l("."),c("keyword","while"),u=su(!0),f(),u}.call(this)});if("while"===p)return new AST_While({condition:su(!0),body:Y(V)});if("for"===p)return F();if("from"===p)return S(H());if("import"===p)return S(K());if("class"===p)return BASELIB["extends"]=!0,e.auto_bind&&(BASELIB.rebind_all=!0),G();if("module"===p)return q();if("def"===p)return d=o(),E=z(L.in_class.slice(-1)[0]),E.start=d,E.end=o(),C=tu(E,!0),C===E?E:new AST_SimpleStatement({start:d,body:C,end:o()});if("if"===p)return v();if("pass"===p)return f(),new AST_EmptyStatement;if("return"===p)return 0===L.in_function&&i("'return' outside of function"),new AST_Return({value:n("punc",";")?function(){return f(),null}.call(this):A()?null:function(){var u;return u=su(!0),f(),u}.call(this)});if("switch"===p)return new AST_Switch({expression:_(),body:Y(w)});if("raise"===p)return L.token.nlb?new AST_Throw({value:new AST_SymbolCatch({name:"_$rapyd$_Exception"})}):(h=su(!0),f(),new AST_Throw({value:h}));if("try"===p)return g();if("nonlocal"===p)return h=J(),f(),h;if("const"===p)return h=Q(),f(),h;if("with"===p)return new AST_With({expression:_(),body:V()});s()}}}),K=function(){var u,e,n,t;for(e=u=su(!1),n=".pyj";e instanceof AST_Dot;)n="/"+e.property+n,e=e.expression;n=e.name+n,t=null;var r=import_read_file(n);return t=parse(r,{filename:n,toplevel:t}),new AST_Import({module:u,argnames:null,body:t,variables:function(){return E(t,!0).filter(function(u,e,n){return n.lastIndexOf(u)===e})}.call(this)})},H=function(){var u,t,o;for(u=su(!1),t=".pyj";u instanceof AST_Dot;)t="/"+u.property+t,u=u.expression;t=u.name+t,c("keyword","import"),o=null;try{o=parse(e.readfile(e.basedir+"/"+t,"utf-8"),{filename:t,toplevel:o,readfile:e.readfile,basedir:e.basedir,libdir:e.libdir})}catch(i){o=parse(e.readfile(e.libdir+"/"+t,"utf-8"),{filename:t,toplevel:o,readfile:e.readfile,basedir:e.libdir,libdir:e.libdir})}return new AST_Import({module:u,argnames:function(u){for(u.push(P(AST_SymbolVar));n("punc",",");)r(),u.push(P(AST_SymbolVar));return u}.call(this,[]),body:o})},j=function(){},q=function(u){var e,n,t;return e=u?u:P(AST_SymbolDefun),e||s(),n=L.decorators.indexOf("external"),-1!==n&&L.decorators.splice(n,1),t=new AST_Module({name:e,body:function(){var u,n;return u=L.module_tree,L.module_stack.forEach(function(e){u=u[e]}),u[e.name]=new j,L.module_stack.push(e.name),n=y(),L.module_stack.pop(),n}.call(this),external:-1!==n,decorators:function(){var u;return u=[],L.decorators.forEach(function(e){u.push(new AST_Decorator({name:e}))}),L.decorators=[],u}.call(this),variables:[],localvars:[]}),t.variables=E(t.body,!0).filter(function(u,e,n){return n.lastIndexOf(u)===e}),t.localvars=E(t.body,!1).filter(function(u,e,n){return n.lastIndexOf(u)===e}).map(function(u){return U(AST_SymbolVar,u)}),t},G=function(){var u,e,t,o,i,a;u=P(AST_SymbolDefun),u||s(),e=L.decorators.indexOf("external"),-1!==e&&L.decorators.splice(e,1),t={"static":[],bound:{}},o=new AST_Class({name:u,parent:function(){var u;return n("punc","(")?(r(),u=uu(!1),l(")"),u):null}.call(this),modules:L.module_stack.slice(),localvars:[],"static":t["static"],external:-1!==e,bound:t.bound,decorators:function(){var u;return u=[],L.decorators.forEach(function(e){u.push(new AST_Decorator({name:e}))}),L.decorators=[],u}.call(this),body:function(e,n){var r,o;return r=L.module_tree,L.module_stack.forEach(function(u){r=r[u]}),r[u.name]=t,L.in_class.push(u.name),L.classes[L.classes.length-1][u.name]=t,L.classes.push({}),L.in_function+=1,L.in_directives=!0,L.in_loop=0,L.labels=[],o=y(),L.in_function-=1,L.classes.pop(),L.in_class.pop(),L.in_loop=e,L.labels=n,o}.call(this,L.in_loop,L.labels)});for(a in o.body)if(i=o.body[a],i instanceof AST_Method&&"__init__"===i.name.name){o.init=i;break}return o},z=function(u,t){var i,c,A,f,_,p,d,S,B;for(i=t===AST_Accessor,c=n("name")?P(u?AST_SymbolDefun:i?AST_SymbolAccessor:AST_SymbolLambda):i&&(n("string")||n("num"))?R():null,u&&!c&&s(),f=!1,u&&(A=L.decorators.indexOf("staticmethod"),-1!==A?(L.decorators.splice(A,1),L.classes[L.classes.length-2][u]["static"].push(c.name),f=!0):"__init__"!==c.name&&e.auto_bind&&(BASELIB.bind=!0,L.classes[L.classes.length-2][u].bound[c.name]=!0)),l("("),t||(t=u?AST_Method:AST_Function),_=new t({name:c,argnames:function(u){var e,t,i;for(e={},t=!0;!n("punc",")");)t?t=!1:l(","),u.starargs?a(o(),"Can't define multiple *args in function definition"):n("operator","*")?(r(),u.starargs=P(AST_SymbolFunarg)):(u.push(P(AST_SymbolFunarg)),n("operator","=")&&(i=o().value,r(),e[i]=su(!1)));return r(),u.defaults=e,u}.call(this,[]),localvars:[],decorators:function(){var u;return u=[],L.decorators.forEach(function(e){u.push(new AST_Decorator({name:e}))}),L.decorators=[],u}.call(this),body:function(u,e){var n;return L.in_class.push(!1),L.classes.push({}),L.in_function+=1,L.in_directives=!0,L.in_loop=0,L.labels=[],n=y(),L.in_function-=1,L.classes.pop(),L.in_class.pop(),L.in_loop=u,L.labels=e,n}.call(this,L.in_loop,L.labels)}),_ instanceof AST_Method&&(_["static"]=f),p=E(_.body,!1).filter(function(u,e,n){return n.lastIndexOf(u)===e}),S=0;S<p.length;S++)for(d=0;d<_.argnames.length+1;d++)if(d===_.argnames.length)_.localvars.push(U(AST_SymbolVar,p[S]));else if(d<_.argnames.length&&p[S]===_.argnames[d].name)break;return B=C(_.body),B.forEach(function(u){for(var e,n=dir(_.localvars).reverse(),t=0;t<n.length;t++)e=n[t],_.localvars[e].name===u&&_.localvars.splice(e,1)}),_},J=function(u){return new AST_Var({start:o(),definitions:k(u,!1),end:o()})},Q=function(){return new AST_Const({start:o(),definitions:k(!1,!0),end:o()})},Z=function(){var u,e,t;return u=L.token,c("operator","new"),e=uu(!1),n("punc","(")?(r(),t=O(")")):t=[],tu(new AST_New({start:u,expression:e,args:t,end:o()}),!0)},uu=function(u){var e,t,i,a,c;if(n("operator","new"))return Z();if(e=L.token,n("punc")){if(t=e.value,"("===t)return r(),i=su(!0),i.start=e,i.end=L.token,l(")"),tu(i,u);if("["===t)return tu(eu(),u);if("{"===t)return tu(nu(),u);s()}return n("keyword","class")?(r(),a=G(),a.start=e,a.end=o(),tu(a,u)):n("keyword","def")?(r(),c=z(!1),c.start=e,c.end=o(),tu(c,u)):ATOMIC_START_TOKEN[L.token.type]?tu(R(),u):void s()},eu=p(function(){var u,t,i;if(l("["),u=[],!n("punc","]")){if(u.push(su(!1)),n("keyword","for"))return r(),t=F(!0),i=new AST_ListComprehension({statement:u[0],init:t.init,name:t.name,object:t.object,condition:n("punc","]")?null:(c("keyword","if"),su(!0))}),l("]"),i;if(n("operator","til"))return r(),u.push(su(!1)),i=tu(new AST_Call({start:L.token,expression:new AST_SymbolRef({name:"range"}),args:u,end:o()}),!0),l("]"),i;if(n("operator","to"))return r(),u.push(new AST_Binary({left:su(!1),operator:"+",right:new AST_Number({value:1})})),i=tu(new AST_Call({start:L.token,expression:new AST_SymbolRef({name:"range"}),args:u,end:o()}),!0),l("]"),i;n("punc","]")||l(",")}return new AST_Array({elements:u.concat(O("]",!e.strict,!0))})}),nu=p(function(){var u,t,i,a,s,c,A;for(l("{"),t=!0,u=[];!n("punc","}")&&(t?t=!1:l(","),e.strict||!n("punc","}"));){if(i=L.token,a=i.type,s=I(),c=s.value,A="string"===s.type,"name"===a&&!n("punc",":")){if("get"===c){u.push(new AST_ObjectGetter({start:i,key:c,quoted:A,value:z(!1,AST_Accessor),end:o()}));continue}if("set"===c){u.push(new AST_ObjectSetter({start:i,key:c,quoted:A,value:z(!1,AST_Accessor),end:o()}));continue}}l(":"),u.push(new AST_ObjectKeyVal({start:i,key:c,quoted:A,value:su(!1),end:o()}))}return r(),new AST_Object({properties:u})}),tu=function(u,e){var t,i,s,c,A,f,_,p,d;if(t=u.start,n("punc","."))return r(),tu(new AST_Dot({start:t,expression:u,property:N(),end:o()}),e);if(n("punc","[")&&!L.token.nlb)return r(),i=[],s=!1,n("punc",":")?i.push(new AST_Number({value:0})):i.push(su(!1)),n("punc",":")&&(s=!0,r(),n("punc","]")||i.push(su(!1))),l("]"),s?tu(new AST_Call({start:t,expression:new AST_Dot({start:t,expression:u,property:"slice",end:o()}),args:i,end:o()}),e):tu(new AST_Sub({start:t,expression:u,property:i[0],end:o()}),e);if(e&&n("punc","(")&&!L.token.nlb){if(r(),u instanceof AST_SymbolRef&&"JS"===u.name)return c=su(!1),c instanceof AST_String||a(o(),"Compile-time function JS() can't process variables or expressions"),A=new AST_Verbatim({start:t,value:c.value,end:o()}),l(")"),tu(A,!0);if(b(u))return tu(new AST_New({start:t,expression:u,args:x(),end:o()}),!0);if(u instanceof AST_Dot&&(f=b(u.expression)),f)return _=u,"__init__"===_.property&&(_.property="constructor"),tu(new AST_ClassCall({start:t,"class":u.expression,method:_.property,"static":M(f,_.property),args:x(),end:o()}),!0);if(u instanceof AST_SymbolRef)if(p=u.name,"abs"===p||"bind"===p||"rebind_all"===p||"dir"===p||"enumerate"===p||"len"===p||"mixin"===p||"print"===p||"range"===p||"reversed"===p||"getattr"===p||"setattr"===p||"hasattr"===p)BASELIB[u.name]=!0;else{if("type"===p)return new AST_UnaryPrefix({start:t,operator:"typeof",expression:x()[0],end:o()});if("isinstance"===p)return d=x(),new AST_Binary({start:t,operator:"instanceof",left:d[0],right:d[1],end:o()})}return tu(new AST_Call({start:t,expression:u,args:x(),end:o()}),!0)}return u},ru=function(u){var e,i,a;if(e=L.token,n("operator")&&UNARY_PREFIX(e.value)){if(r(),"@"===e.value){if(n("name")&&("@"===t().value||"def"===t().value||"class"===t().value||"module"===t().value))return L.decorators.push(L.token.value),r(),new AST_EmptyStatement;s()}return i=$(AST_UnaryPrefix,e.value,ru(u)),i.start=e,i.end=o(),i}for(a=uu(u);n("operator")&&UNARY_POSTFIX(L.token.value)&&!L.token.nlb;)a=$(AST_UnaryPostfix,L.token.value,a),a.start=e,a.end=L.token,r();return a},ou=function(u,e,o){var i,a,s,c,l;return a=n("operator")?L.token.value:null,i=!1,"!"===a&&"operator"===t().type&&"in"===t().value&&(r(),a="in",i=!0),"in"===a&&(o?a=null:BASELIB[a]=!0),s=null!==a?PRECEDENCE[a]:null,null!==s&&s>e?(r(),c=ou(ru(!0),s,o),l=new AST_Binary({start:u.start,left:u,operator:a,right:c,end:c.end}),i&&(l=new AST_UnaryPrefix({start:u.start,operator:"!",expression:l,end:c.end})),ou(l,e,o)):u},iu=function(u){var e,o,i;return e=L.token,o=W(u),n("operator","?")?(r(),i=su(!1),l(":"),new AST_Conditional({start:e,condition:o,consequent:i,alternative:su(!1,u),end:t()})):o},au=function(u){var e,t,a;if(e=L.token,t=iu(u),a=L.token.value,n("operator")&&ASSIGNMENT(a)){if(X(t))return r(),new AST_Assign({start:e,left:t,operator:a,right:au(u),end:o()});i("Invalid assignment")}return t},su=function(u,e){var o,i,a,s;if(o=L.token,s=au(e),u){for(i=[s],a=[];n("punc",",")&&!t().nlb;){if(r(),s instanceof AST_Assign)return i[i.length-1]=i.slice(-1)[0].left,new AST_Assign({start:o,left:1===i.length?i[0]:new AST_Array({elements:i}),operator:s.operator,right:new AST_Seq({car:s.right,cdr:su(!0,e)}),end:t()});s=au(e),i.push(s)}return i.length>1&&i.slice(-1)[0]instanceof AST_Assign?(i[i.length-1]=i.slice(-1)[0].left,new AST_Assign({start:o,left:new AST_Array({elements:i}),operator:s.operator,right:s.right,end:t()})):function c(u){return 1===u.length?u[0]:new AST_Seq({start:o,car:u.shift(),cdr:c(u),end:t()})}.call(this,i)}return s},function(){var u,t,r,i,a,s,c,l;for(u=L.token,t=[],a=!0;!n("eof");)r=V(),a&&r instanceof AST_Directive&&0===r.value.indexOf("#!")?i=r.value:t.push(r),a=!1;return s=o(),c=e.toplevel,c?(c.body=c.body.concat(t),c.end=s):c=new AST_Toplevel({start:u,body:t,strict:function(){for(var u,e=t,n=0;n<e.length;n++)if(u=e[n],u instanceof AST_Directive&&"use strict"===u.value)return!0;return!1}.call(this),shebang:i,end:s}),l=E(c.body,!1).filter(function(u,e,n){return n.lastIndexOf(u)===e}),c.localvars=[],l.forEach(function(u){c.localvars.push(U(AST_SymbolVar,u))}),c.imports=IMPORTED,c.baselib=BASELIB,c}.call(this)}var KEYWORDS,RESERVED_WORDS,KEYWORDS_BEFORE_EXPRESSION,KEYWORDS_ATOM,NATIVE_CLASSES,OPERATOR_CHARS,RE_HEX_NUMBER,RE_OCT_NUMBER,RE_DEC_NUMBER,OPERATORS,OP_MAP,WHITESPACE_CHARS,PUNC_BEFORE_EXPRESSION,PUNC_CHARS,REGEXP_MODIFIERS,UNICODE,IMPORTED,BASELIB,EX_EOF,UNARY_PREFIX,UNARY_POSTFIX,ASSIGNMENT,PRECEDENCE,STATEMENTS_WITH_LABELS,ATOMIC_START_TOKEN;KEYWORDS="as break case class const continue debugger default def del do elif else except finally for from if import in instanceof is module new nonlocal pass raise return switch til to try typeof var void while with or and not",KEYWORDS_ATOM="False None True",RESERVED_WORDS="abstract boolean byte char double enum export extends final float goto implements int interface long native package private protected public short static super synchronized this throws transient volatile "+KEYWORDS_ATOM+" "+KEYWORDS,KEYWORDS_BEFORE_EXPRESSION="return new del raise elif else if",KEYWORDS=makePredicate(KEYWORDS),RESERVED_WORDS=makePredicate(RESERVED_WORDS),KEYWORDS_BEFORE_EXPRESSION=makePredicate(KEYWORDS_BEFORE_EXPRESSION),KEYWORDS_ATOM=makePredicate(KEYWORDS_ATOM),NATIVE_CLASSES={Image:{},RegExp:{},Error:{},Object:{"static":["getOwnPropertyNames","keys","create"]},String:{"static":["fromCharCode"]},Array:{"static":["isArray","from","of"]},Number:{"static":["isFinite","isNaN"]},Function:{},Date:{"static":["UTC","now","parse"]},Boolean:{},ArrayBuffer:{},DataView:{},Float32Array:{},Float64Array:{},Int16Array:{},Int32Array:{},Int8Array:{},Uint16Array:{},Uint32Array:{},Uint8Array:{},Uint8ClampedArray:{}},OPERATOR_CHARS=makePredicate(characters("+-*&%=<>!?|~^@")),RE_HEX_NUMBER=/^0x[0-9a-f]+$/i,RE_OCT_NUMBER=/^0[0-7]+$/,RE_DEC_NUMBER=/^\d*\.?\d*(?:e[+-]?\d*(?:\d\.?|\.?\d)\d*)?$/i,OPERATORS=makePredicate(["in","instanceof","typeof","new","void","del","++","--","+","-","not","~","&","|","^","**","*","/","%",">>","<<",">>>","<",">","<=",">=","==","===","is","!=","!==","?","=","+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&=","and","or","til","to","@"]),OP_MAP={or:"||",and:"&&",not:"!",del:"delete",None:"null",is:"===","==":"===","!=":"!=="},WHITESPACE_CHARS=makePredicate(characters("  \n\r	\f\x0B")),PUNC_BEFORE_EXPRESSION=makePredicate(characters("[{(,.;:")),PUNC_CHARS=makePredicate(characters("[]{}(),;:")),REGEXP_MODIFIERS=makePredicate(characters("gmsiy")),UNICODE={letter:new RegExp("[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0523\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0621-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971\\u0972\\u097B-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D28\\u0D2A-\\u0D39\\u0D3D\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC\\u0EDD\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8B\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10D0-\\u10FA\\u10FC\\u1100-\\u1159\\u115F-\\u11A2\\u11A8-\\u11F9\\u1200-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u1676\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19A9\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u2094\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2C6F\\u2C71-\\u2C7D\\u2C80-\\u2CE4\\u2D00-\\u2D25\\u2D30-\\u2D65\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31B7\\u31F0-\\u31FF\\u3400\\u4DB5\\u4E00\\u9FC3\\uA000-\\uA48C\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA65F\\uA662-\\uA66E\\uA67F-\\uA697\\uA717-\\uA71F\\uA722-\\uA788\\uA78B\\uA78C\\uA7FB-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA90A-\\uA925\\uA930-\\uA946\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAC00\\uD7A3\\uF900-\\uFA2D\\uFA30-\\uFA6A\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),
non_spacing_mark:new RegExp("[\\u0300-\\u036F\\u0483-\\u0487\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065E\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0900-\\u0902\\u093C\\u0941-\\u0948\\u094D\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09BC\\u09C1-\\u09C4\\u09CD\\u09E2\\u09E3\\u0A01\\u0A02\\u0A3C\\u0A41\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81\\u0A82\\u0ABC\\u0AC1-\\u0AC5\\u0AC7\\u0AC8\\u0ACD\\u0AE2\\u0AE3\\u0B01\\u0B3C\\u0B3F\\u0B41-\\u0B44\\u0B4D\\u0B56\\u0B62\\u0B63\\u0B82\\u0BC0\\u0BCD\\u0C3E-\\u0C40\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0CBC\\u0CBF\\u0CC6\\u0CCC\\u0CCD\\u0CE2\\u0CE3\\u0D41-\\u0D44\\u0D4D\\u0D62\\u0D63\\u0DCA\\u0DD2-\\u0DD4\\u0DD6\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F71-\\u0F7E\\u0F80-\\u0F84\\u0F86\\u0F87\\u0F90-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102D-\\u1030\\u1032-\\u1037\\u1039\\u103A\\u103D\\u103E\\u1058\\u1059\\u105E-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108D\\u109D\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B7-\\u17BD\\u17C6\\u17C9-\\u17D3\\u17DD\\u180B-\\u180D\\u18A9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193B\\u1A17\\u1A18\\u1A56\\u1A58-\\u1A5E\\u1A60\\u1A62\\u1A65-\\u1A6C\\u1A73-\\u1A7C\\u1A7F\\u1B00-\\u1B03\\u1B34\\u1B36-\\u1B3A\\u1B3C\\u1B42\\u1B6B-\\u1B73\\u1B80\\u1B81\\u1BA2-\\u1BA5\\u1BA8\\u1BA9\\u1C2C-\\u1C33\\u1C36\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE0\\u1CE2-\\u1CE8\\u1CED\\u1DC0-\\u1DE6\\u1DFD-\\u1DFF\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2CEF-\\u2CF1\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F\\uA67C\\uA67D\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA825\\uA826\\uA8C4\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA951\\uA980-\\uA982\\uA9B3\\uA9B6-\\uA9B9\\uA9BC\\uAA29-\\uAA2E\\uAA31\\uAA32\\uAA35\\uAA36\\uAA43\\uAA4C\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uABE5\\uABE8\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE26]"),space_combining_mark:new RegExp("[\\u0903\\u093E-\\u0940\\u0949-\\u094C\\u094E\\u0982\\u0983\\u09BE-\\u09C0\\u09C7\\u09C8\\u09CB\\u09CC\\u09D7\\u0A03\\u0A3E-\\u0A40\\u0A83\\u0ABE-\\u0AC0\\u0AC9\\u0ACB\\u0ACC\\u0B02\\u0B03\\u0B3E\\u0B40\\u0B47\\u0B48\\u0B4B\\u0B4C\\u0B57\\u0BBE\\u0BBF\\u0BC1\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCC\\u0BD7\\u0C01-\\u0C03\\u0C41-\\u0C44\\u0C82\\u0C83\\u0CBE\\u0CC0-\\u0CC4\\u0CC7\\u0CC8\\u0CCA\\u0CCB\\u0CD5\\u0CD6\\u0D02\\u0D03\\u0D3E-\\u0D40\\u0D46-\\u0D48\\u0D4A-\\u0D4C\\u0D57\\u0D82\\u0D83\\u0DCF-\\u0DD1\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0F3E\\u0F3F\\u0F7F\\u102B\\u102C\\u1031\\u1038\\u103B\\u103C\\u1056\\u1057\\u1062-\\u1064\\u1067-\\u106D\\u1083\\u1084\\u1087-\\u108C\\u108F\\u109A-\\u109C\\u17B6\\u17BE-\\u17C5\\u17C7\\u17C8\\u1923-\\u1926\\u1929-\\u192B\\u1930\\u1931\\u1933-\\u1938\\u19B0-\\u19C0\\u19C8\\u19C9\\u1A19-\\u1A1B\\u1A55\\u1A57\\u1A61\\u1A63\\u1A64\\u1A6D-\\u1A72\\u1B04\\u1B35\\u1B3B\\u1B3D-\\u1B41\\u1B43\\u1B44\\u1B82\\u1BA1\\u1BA6\\u1BA7\\u1BAA\\u1C24-\\u1C2B\\u1C34\\u1C35\\u1CE1\\u1CF2\\uA823\\uA824\\uA827\\uA880\\uA881\\uA8B4-\\uA8C3\\uA952\\uA953\\uA983\\uA9B4\\uA9B5\\uA9BA\\uA9BB\\uA9BD-\\uA9C0\\uAA2F\\uAA30\\uAA33\\uAA34\\uAA4D\\uAA7B\\uABE3\\uABE4\\uABE6\\uABE7\\uABE9\\uABEA\\uABEC]"),connector_punctuation:new RegExp("[\\u005F\\u203F\\u2040\\u2054\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFF3F]")},IMPORTED={},BASELIB={},JS_Parse_Error.prototype.toString=function(){return this.message+" (line: "+this.line+", col: "+this.col+", pos: "+this.pos+")\n\n"+this.stack},EX_EOF={},UNARY_PREFIX=makePredicate(["typeof","void","delete","--","++","!","~","-","+","@"]),UNARY_POSTFIX=makePredicate(["--","++"]),ASSIGNMENT=makePredicate(["=","+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&="]),PRECEDENCE=function(u,e){var n,t,r;for(r=0;r<u.length;r++)for(n=u[r],t=0;t<n.length;t++)e[n[t]]=r+1;return e}.call(this,[["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%"],["**"]],{}),STATEMENTS_WITH_LABELS=array_to_hash(["for","do","while","switch"]),ATOMIC_START_TOKEN=array_to_hash(["atom","num","string","regexp","name"]);
function _$rapyd$_extends(n,r){n.prototype=new r,n.prototype.constructor=n}function _$rapyd$_in(n,r){return r instanceof Array||"string"==typeof r?-1!=r.indexOf(n):!!r.hasOwnProperty(n)}function abs(n){return Math.abs(n)}function dir(n){var r=[];for(var t in n)r.push(t);return r}function len(n){if(n instanceof Array||"string"==typeof n)return n.length;var r=0;for(var t in n)n.hasOwnProperty(t)&&r++;return r}function range(n,r,t){arguments.length<=1&&(r=n||0,n=0),t=arguments[2]||1;for(var e=Math.max(Math.ceil((r-n)/t),0),o=0,i=new Array(e);e>o;)i[o++]=n,n+=t;return i}function _$rapyd$_mixin(n,r,t){for(var e in r)r.hasOwnProperty(e)&&(t||"undefined"==typeof n[e])&&(n[e]=r[e])}function _$rapyd$_bind(n,r){if(n._orig&&(n=n._orig),r===!1)return n;var t=n.bind(r);return t._orig=n,t}function enumerate(n){for(var r=[],t=0;t<n.length;t++)r[r.length]=[t,n[t]];return r}function _$rapyd$_print(){var n,r;n=[].slice.call(arguments,0),r=JSON.stringify(n),"console"in window&&console.log(r.substr(1,r.length-2))}function reversed(n){for(var r=[],t=n.length-1;t>=0;t--)r.push(n[t]);return r}function getattr(n,r){return n[r]}function setattr(n,r,t){n[r]=t}function hasattr(n,r){return r in n}